<!DOCTYPE html>
<html class="writer-html5" lang="it" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tabs.US_USM &mdash; pyArchInit 4.0 4 documentazione</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="A proposito di questi documenti" href="../../about.html" />
    <link rel="index" title="Indice" href="../../genindex.html" />
    <link rel="search" title="Cerca" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> pyArchInit 4.0
            <img src="../../_static/pyarchinit_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Cerca documenti" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Menu di navigazione">
              <p class="caption" role="heading"><span class="caption-text">Contenuti:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../prerequisities.html">Prerequisiti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../novit%C3%A0.html">Novit√†</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01_installazione.html">1.Installazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../02_il_plugin.html">2 Il Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../03_le_schede.html">3.Le schede</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../04_funzioni.html">4.Funzioni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../05_esempi_di_applicazione.html">5.Esempi di Applicazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../06_moduli.html">pyArchInit Classi e Funzioni</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Menu navigazione dispositivi mobili" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyArchInit 4.0</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Naviga tra le pagine">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Codice del modulo</a> &raquo;</li>
      <li>tabs.US_USM</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Codice sorgente per tabs.US_USM</h1><div class="highlight"><pre>
<span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf 8 -*-</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">range</span>
<span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">str</span>
<span class="kn">import</span> <span class="nn">psycopg2</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>  <span class="k">as</span> <span class="nn">sq</span>
<span class="kn">from</span> <span class="nn">sqlite3</span> <span class="kn">import</span> <span class="n">Error</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pdf2docx</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">as</span> <span class="nn">ET</span>
<span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">from</span> <span class="nn">distutils.dir_util</span> <span class="kn">import</span> <span class="n">copy_tree</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randrange</span> <span class="k">as</span> <span class="n">rand</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">qgis</span> <span class="kn">import</span> <span class="n">processing</span>
<span class="kn">from</span> <span class="nn">qgis.PyQt.QtCore</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qgis.PyQt.QtGui</span> <span class="kn">import</span> <span class="n">QColor</span><span class="p">,</span> <span class="n">QIcon</span>
<span class="kn">from</span> <span class="nn">qgis.PyQt.QtWidgets</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qgis.PyQt.uic</span> <span class="kn">import</span> <span class="n">loadUiType</span>
<span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qgis.gui</span> <span class="kn">import</span> <span class="n">QgsMapCanvas</span><span class="p">,</span> <span class="n">QgsMapToolPan</span>
<span class="kn">from</span> <span class="nn">qgis.PyQt.QtSql</span> <span class="kn">import</span> <span class="n">QSqlDatabase</span><span class="p">,</span> <span class="n">QSqlTableModel</span>
<span class="kn">import</span> <span class="nn">re</span>



<div class="viewcode-block" id="pyarchinit_US"><a class="viewcode-back" href="../../06_moduli.html#tabs.US_USM.pyarchinit_US">[documenti]</a><span class="k">class</span> <span class="nc">pyarchinit_US</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>




    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iface</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iface</span> <span class="o">=</span> <span class="n">iface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span> <span class="o">=</span> <span class="n">Pyarchinit_pyqgis</span><span class="p">(</span><span class="n">iface</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mDockWidget_2</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mDockWidget_export</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mDockWidget_3</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mDockWidget_4</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mDockWidget_h_check</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mQgsFileWidget</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_file_doc</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mDockWidget_5</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_insert_row_rapporti2</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_remove_row_rapporti2</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_update</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progressBar_2</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progressBar_3</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">currentLayerId</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="n">SearchLayers</span><span class="p">(</span><span class="n">iface</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_pushButton_connect_pressed</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Connection System&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="c1"># SIGNALS &amp; SLOTS Functions</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_periodo_iniz_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_periodo_iniz_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_periodo_fin_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_struttura_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_struttura_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_periodo_fin_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_fase_iniz_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_datazione_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_iniz</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_datazione_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometry_unitastratigrafiche</span><span class="p">)</span><span class="c1">### rallenta molto</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometry_unitastratigrafiche</span><span class="p">)</span><span class="c1">### rallenta molto</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_insert_ra</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_insert_ra</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">search_1</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_fin</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_fase_fin_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_pdfpath</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setPathpdf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_input</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setPathdot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_output</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setPathgraphml</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_file_doc</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDoc_ref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pbnOpenpdfDirectory</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openpdfDir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progressBar</span><span class="o">.</span><span class="n">setTextVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sito</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="n">sito</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">customize_GUI</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_sito</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_sito</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listview_us</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">itemSelectionChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">us_t</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">change_label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value_check</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">check_v</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">itemChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">check_listoflist</span><span class="p">)</span>

<div class="viewcode-block" id="pyarchinit_US.on_pushButton_fix_pressed"><a class="viewcode-back" href="../../06_moduli.html#tabs.US_USM.pyarchinit_US.on_pushButton_fix_pressed">[documenti]</a>    <span class="k">def</span> <span class="nf">on_pushButton_fix_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Itera su tutti i record</span>

<span class="sd">        seleziona  una tupla della tableWidget rapporti</span>

<span class="sd">        richiama la funziona check_listoflist()</span>
<span class="sd">        per fissare l&#39;errore</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sito</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span>
        <span class="n">area</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="n">sito</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="n">area</span><span class="p">}</span>
        <span class="n">records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_validation_rapp</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">selectRow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_listoflist</span><span class="p">()</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()))</span><span class="o">*</span><span class="mi">100</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progressBar_3</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">QApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progressBar_3</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">unit_type_select</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dialog</span> <span class="o">=</span> <span class="n">QInputDialog</span><span class="p">()</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="n">items_st</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;US&#39;</span><span class="p">,</span><span class="s1">&#39;USM&#39;</span><span class="p">,</span><span class="s1">&#39;USVA&#39;&#39;USVB&#39;</span><span class="p">,</span><span class="s1">&#39;USVC&#39;</span><span class="p">,</span><span class="s1">&#39;USVD&#39;</span><span class="p">,</span><span class="s1">&#39;CON&#39;</span><span class="p">,</span><span class="s1">&#39;SF&#39;</span><span class="p">,</span><span class="s1">&#39;SUS&#39;</span><span class="p">,</span><span class="s1">&#39;Combonar&#39;</span><span class="p">,</span><span class="s1">&#39;Extractor&#39;</span><span class="p">,</span><span class="s1">&#39;property&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">items_st</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;SU&#39;</span><span class="p">,</span><span class="s1">&#39;WSU&#39;</span><span class="p">,</span><span class="s1">&#39;USVA&#39;&#39;USVB&#39;</span><span class="p">,</span><span class="s1">&#39;USVC&#39;</span><span class="p">,</span><span class="s1">&#39;USVD&#39;</span><span class="p">,</span><span class="s1">&#39;CON&#39;</span><span class="p">,</span><span class="s1">&#39;SF&#39;</span><span class="p">,</span><span class="s1">&#39;SUS&#39;</span><span class="p">,</span><span class="s1">&#39;Combonar&#39;</span><span class="p">,</span><span class="s1">&#39;Extractor&#39;</span><span class="p">,</span><span class="s1">&#39;property&#39;</span><span class="p">)</span>
            <span class="n">ID_U</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Type Unit&#39;</span><span class="p">,</span> <span class="s2">&quot;Insert Unit Type&quot;</span><span class="p">,</span><span class="n">items_st</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">Unit</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ID_U</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">Unit</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

<div class="viewcode-block" id="pyarchinit_US.search_rapp"><a class="viewcode-back" href="../../06_moduli.html#tabs.US_USM.pyarchinit_US.search_rapp">[documenti]</a>    <span class="k">def</span> <span class="nf">search_rapp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;search rapp&quot;&quot;&quot;</span>

        <span class="c1"># Clear current selection.</span>
        <span class="c1">#self.tableWidget_rapporti.setCurrentItem(None)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>
            <span class="c1"># Empty string, don&#39;t search.</span>
            <span class="k">return</span>

        <span class="n">matching_items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">findItems</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="n">MatchContains</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">matching_items</span><span class="p">:</span>
            <span class="c1"># We have found something.</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">matching_items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Take the first.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setCurrentItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">check_listoflist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_validation_rapp</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>


                <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;self.tableWidget_rapporti&quot;</span>
                <span class="n">rowSelected_cmd</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.selectedItems()&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
                <span class="n">rowSelected</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">rowSelected_cmd</span><span class="p">)</span>
                <span class="n">rowIndex</span> <span class="o">=</span> <span class="p">(</span><span class="n">rowSelected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">row</span><span class="p">())</span>
                <span class="n">sito</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
                <span class="n">area</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
                <span class="n">us_current</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">us_current</span><span class="p">)</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
                <span class="n">us_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">us</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">us_item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="c1">#print(us)</span>
                <span class="n">rapp_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">rapp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rapp_item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>


                <span class="bp">self</span><span class="o">.</span><span class="n">save_rapp</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Riempito da&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Riempie&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Tagliato da&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Taglia&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Coperto da&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Copre&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Si appoggia a&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Gli si appoggia&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Riempie&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Riempito da&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Taglia&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Tagliato da&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Copre&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Coperto da&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Gli si appoggia&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Si appoggia a&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Filled by&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Fills&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Cutted by&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Cuts&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Covered by&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Covers&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Abuts&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Supports&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Fills&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Filled by&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Cuts&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Cutted by&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Covers&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Covered by&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;Supports&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;Abuts&#39;</span>

                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;&lt;&lt;&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;&lt;&lt;&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;&gt;&gt;&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;&lt;&#39;</span>
                <span class="k">elif</span> <span class="n">rapp</span> <span class="o">==</span><span class="s1">&#39;&lt;&#39;</span><span class="p">:</span>
                    <span class="n">rapp</span><span class="o">=</span><span class="s1">&#39;&gt;&#39;</span>
                <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                               <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                               <span class="s1">&#39;us&#39;</span><span class="p">:</span> <span class="n">us</span><span class="p">}</span>
                <span class="n">u</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">()</span>
                <span class="n">search_dict</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">remove_empty_items_fr_dict</span><span class="p">(</span><span class="n">search_dict</span><span class="p">)</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>


                <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
                    <span class="c1">#self.tableWidget_rapporti.setCurrentItem(None)</span>
                    <span class="c1">#items = self.tableWidget_rapporti.findItems(us, Qt.MatchCase)</span>
                    <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">findItems</span><span class="p">(</span><span class="n">us</span><span class="p">,</span><span class="n">Qt</span><span class="o">.</span><span class="n">MatchExactly</span><span class="p">)</span>
                    <span class="c1">#QMessageBox.warning(self,&#39;&#39;,str(len(items)))</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">on_pushButton_go_to_us_pressed</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_validation_rapp</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">items2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">findItems</span><span class="p">(</span><span class="n">us_current</span><span class="p">,</span><span class="n">Qt</span><span class="o">.</span><span class="n">MatchExactly</span><span class="p">)</span>
                    <span class="c1">#QMessageBox.warning(self,&#39;&#39;,str(len(items2)))</span>

                    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">))</span><span class="o">==</span><span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items2</span><span class="p">))</span><span class="o">==</span><span class="s1">&#39;1&#39;</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">item</span><span class="o">=</span><span class="n">items2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setCurrentItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="k">pass</span>
                        <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">currentRow</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">rapp</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">us_current</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">save_rapp</span><span class="p">()</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">selectRow</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">on_pushButton_go_to_us_pressed</span><span class="p">()</span>
                        <span class="c1">#self.checkBox_validation_rapp.setChecked(False)</span>

                    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">))</span><span class="o">==</span><span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items2</span><span class="p">))</span><span class="o">==</span><span class="s1">&#39;0&#39;</span><span class="p">:</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">on_pushButton_insert_row_rapporti_pressed</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">currentRow</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">rapp</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">us_current</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">save_rapp</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">selectRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">on_pushButton_go_to_us_pressed</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;controlla hai US duplicata&#39;</span><span class="p">)</span>

                <span class="k">elif</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>

                    <span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_type_select</span><span class="p">()</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">insert_number_of_us_records</span><span class="p">(</span><span class="n">sito</span><span class="p">,</span><span class="n">area</span><span class="p">,</span><span class="n">us</span><span class="p">,</span><span class="n">tf</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">on_pushButton_go_to_us_pressed</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">on_pushButton_insert_row_rapporti_pressed</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">currentRow</span><span class="p">()</span>

                    <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">rapp</span><span class="p">))</span>
                    <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">us_current</span><span class="p">))</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">save_rapp</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">selectRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">on_pushButton_go_to_us_pressed</span><span class="p">()</span>

            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">check_v</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_validate</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_validate</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">change_label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;DOC&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_5</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Riferimento documentazione&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_intepret</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mQgsFileWidget</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">486</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">334</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mQgsFileWidget</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_file_doc</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mQgsFileWidget</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_file_doc</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_intepret</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;property&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_5</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Descrizione della propriet√†&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;USV&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_5</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Descrizione della Unit√† Str. Virtuale&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;CON&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_5</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Riferimento alla Unit√† Continuativa&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;CON&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_5</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Riferimento alla Unit√† Continuativa&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;Combinar&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_5</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Descrizione connettore&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;Extractor&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_5</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Descrizione estrattore&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;SUS&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_5</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Descrizione&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;SF&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_5</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Descrizione&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">us_t</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="k">def</span> <span class="nf">charge_insert_ra</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="n">us</span> <span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>

            <span class="n">search_dict_inv</span> <span class="o">=</span> <span class="p">{</span>

                <span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;self.DATA_LIST[int(self.REC_CORR)].area&quot;</span><span class="p">))</span><span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="s1">&#39;us&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;self.DATA_LIST[int(self.REC_CORR)].us&quot;</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span>
            <span class="p">}</span>

            <span class="n">inv_vl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict_inv</span><span class="p">,</span><span class="s1">&#39;INVENTARIO_MATERIALI&#39;</span><span class="p">)</span>
            <span class="n">inv_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inv_vl</span><span class="p">)):</span>
                <span class="n">inv_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">inv_vl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_reperto</span><span class="p">))</span>
                <span class="n">inv_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">inv_vl</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">:</span>
                <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_ref_ra</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_ref_ra</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">remove_dup_from_list</span><span class="p">(</span><span class="n">inv_list</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Trova&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Finden&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Find&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_ref_ra</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Usa&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Aktuell &quot;</span> <span class="ow">or</span> <span class="s2">&quot;Current&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_ref_ra</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">ref_ra</span><span class="p">)</span>
                    <span class="k">except</span> <span class="p">:</span>
                        <span class="k">pass</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">listview_us</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">()</span>
            <span class="n">conn_str</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">conn_str</span><span class="p">()</span>
            <span class="n">conn_sqlite</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">databasename</span><span class="p">()</span>
            <span class="n">conn_user</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">datauser</span><span class="p">()</span>
            <span class="n">conn_host</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">datahost</span><span class="p">()</span>
            <span class="n">conn_port</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">dataport</span><span class="p">()</span>
            <span class="n">port_int</span>  <span class="o">=</span> <span class="n">conn_port</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]</span>
            <span class="n">port_int</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">conn_password</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">datapassword</span><span class="p">()</span>
            <span class="n">sito_set</span><span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">sito_set</span><span class="p">()</span>
            <span class="n">sito_set_str</span> <span class="o">=</span> <span class="n">sito_set</span><span class="p">[</span><span class="s1">&#39;sito_set&#39;</span><span class="p">]</span>
            <span class="n">test_conn</span> <span class="o">=</span> <span class="n">conn_str</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;sqlite&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">test_conn</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">sqlite_DB_path</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HOME</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span>
                                           <span class="s2">&quot;pyarchinit_DB_folder&quot;</span><span class="p">)</span>

                <span class="n">db</span> <span class="o">=</span> <span class="n">QSqlDatabase</span><span class="p">(</span><span class="s2">&quot;QSQLITE&quot;</span><span class="p">)</span>
                <span class="n">db</span><span class="o">.</span><span class="n">setDatabaseName</span><span class="p">(</span><span class="n">sqlite_DB_path</span> <span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span> <span class="n">conn_sqlite</span><span class="p">[</span><span class="s2">&quot;db_name&quot;</span><span class="p">])</span>
                <span class="n">db</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span> <span class="o">=</span> <span class="n">QSqlTableModel</span><span class="p">(</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">setTable</span><span class="p">(</span><span class="s2">&quot;us_table&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">setEditStrategy</span><span class="p">(</span><span class="n">QSqlTableModel</span><span class="o">.</span><span class="n">OnManualSubmit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_submit</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">submit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_revert</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">revertAll</span><span class="p">)</span>
                <span class="n">column_titles</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;sito&quot;</span><span class="p">:</span> <span class="s2">&quot;SITO&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="s2">&quot;Area&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;us&quot;</span><span class="p">:</span> <span class="s2">&quot;US&quot;</span><span class="p">}</span>
                <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">column_titles</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">fieldIndex</span><span class="p">(</span> <span class="n">n</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">setHeaderData</span><span class="p">(</span> <span class="n">idx</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">bool</span> <span class="p">(</span><span class="n">sito_set_str</span><span class="p">):</span>
                    <span class="n">filter_str</span> <span class="o">=</span> <span class="s2">&quot;sito = &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">setFilter</span><span class="p">(</span><span class="n">filter_str</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>

                <span class="n">uri</span> <span class="o">=</span> <span class="n">QgsDataSourceUri</span><span class="p">()</span>
                <span class="n">uri</span><span class="o">.</span><span class="n">setDatabase</span><span class="p">(</span><span class="n">sqlite_DB_path</span> <span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span> <span class="n">conn_sqlite</span><span class="p">[</span><span class="s2">&quot;db_name&quot;</span><span class="p">])</span>
                <span class="n">schema</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">table</span> <span class="o">=</span> <span class="s1">&#39;us_table&#39;</span>
                <span class="n">geom_column</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">uri</span><span class="o">.</span><span class="n">setDataSource</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span><span class="n">geom_column</span><span class="p">)</span>
                <span class="n">vlayer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">uri</span><span class="o">.</span><span class="n">uri</span><span class="p">(),</span> <span class="n">table</span><span class="p">,</span> <span class="s1">&#39;spatialite&#39;</span><span class="p">)</span>
                <span class="n">pr</span> <span class="o">=</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span>
                <span class="n">fi</span><span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">fields</span><span class="p">()</span><span class="o">.</span><span class="n">names</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">fi</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">search_1</span><span class="o">.</span><span class="n">clearEditText</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">search_1</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">value_check</span><span class="p">()</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>


                <span class="n">db</span> <span class="o">=</span> <span class="n">QSqlDatabase</span><span class="o">.</span><span class="n">addDatabase</span><span class="p">(</span><span class="s2">&quot;QPSQL&quot;</span><span class="p">)</span>
                <span class="n">db</span><span class="o">.</span><span class="n">setHostName</span><span class="p">(</span><span class="n">conn_host</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">])</span>
                <span class="n">db</span><span class="o">.</span><span class="n">setDatabaseName</span><span class="p">(</span><span class="n">conn_sqlite</span><span class="p">[</span><span class="s2">&quot;db_name&quot;</span><span class="p">])</span>
                <span class="n">db</span><span class="o">.</span><span class="n">setPort</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">port_int</span><span class="p">))</span>
                <span class="n">db</span><span class="o">.</span><span class="n">setUserName</span><span class="p">(</span><span class="n">conn_user</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">])</span>
                <span class="n">db</span><span class="o">.</span><span class="n">setPassword</span><span class="p">(</span><span class="n">conn_password</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">])</span>
                <span class="n">db</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span> <span class="o">=</span> <span class="n">QSqlTableModel</span><span class="p">(</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">setTable</span><span class="p">(</span><span class="s2">&quot;us_table&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">setEditStrategy</span><span class="p">(</span><span class="n">QSqlTableModel</span><span class="o">.</span><span class="n">OnManualSubmit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_submit</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">submit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_revert</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">revertAll</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">bool</span> <span class="p">(</span><span class="n">sito_set_str</span><span class="p">):</span>
                    <span class="n">filter_str</span> <span class="o">=</span> <span class="s2">&quot;sito = &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">setFilter</span><span class="p">(</span><span class="n">filter_str</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>

                <span class="n">uri</span> <span class="o">=</span> <span class="n">QgsDataSourceUri</span><span class="p">()</span>
                <span class="n">uri</span><span class="o">.</span><span class="n">setConnection</span><span class="p">(</span><span class="n">conn_host</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">],</span> <span class="n">conn_port</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span> <span class="n">conn_sqlite</span><span class="p">[</span><span class="s2">&quot;db_name&quot;</span><span class="p">],</span> <span class="n">conn_user</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">],</span> <span class="n">conn_password</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">])</span>
                <span class="n">schema</span> <span class="o">=</span> <span class="s1">&#39;public&#39;</span>
                <span class="n">table</span> <span class="o">=</span> <span class="s1">&#39;us_table&#39;</span>
                <span class="n">geom_column</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">uri</span><span class="o">.</span><span class="n">setDataSource</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span><span class="n">geom_column</span><span class="p">)</span>
                <span class="n">vlayer</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">uri</span><span class="o">.</span><span class="n">uri</span><span class="p">(),</span> <span class="n">table</span><span class="p">,</span> <span class="s1">&#39;postgres&#39;</span><span class="p">)</span>
                <span class="n">pr</span> <span class="o">=</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span>
                <span class="n">fi</span><span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">fields</span><span class="p">()</span><span class="o">.</span><span class="n">names</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">pr</span> <span class="o">=</span> <span class="n">vlayer</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span>
                <span class="n">fi</span><span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">fields</span><span class="p">()</span><span class="o">.</span><span class="n">names</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">fi</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">search_1</span><span class="o">.</span><span class="n">clearEditText</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">search_1</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">value_check</span><span class="p">()</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">transaction</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">submitAll</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Record&quot;</span><span class="p">,</span>  <span class="s2">&quot;record salvato&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Datensatz&quot;</span><span class="p">,</span>  <span class="s2">&quot;Datensatz gespeichert&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Record&quot;</span><span class="p">,</span>  <span class="s2">&quot;record saved&quot;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Cached Table&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Il db ha segnalato un errore: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">lastError</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Cached Table&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Die Datenbank meldete einen Fehler: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">lastError</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Cached Table&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;The database reported an error: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">lastError</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">value_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="p">:</span>
                <span class="n">sito_vl2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">tup_2_list_III</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s1">&#39;us_table&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">currentText</span><span class="p">(),</span><span class="s1">&#39;US&#39;</span><span class="p">))</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">sito_vl2</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">search_1</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">sito_vl2</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">search_1</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">sito_vl2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">search_1</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">except</span> <span class="p">:</span>
            <span class="k">pass</span><span class="c1">#QMessageBox.warning(self, &quot;Attenzione&quot;, str(e), QMessageBox.Ok)</span>
    <span class="k">def</span> <span class="nf">update_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">()</span>
            <span class="n">conn_str</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">conn_str</span><span class="p">()</span>
            <span class="n">sito_set</span><span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">sito_set</span><span class="p">()</span>
            <span class="n">sito_set_str</span> <span class="o">=</span> <span class="n">sito_set</span><span class="p">[</span><span class="s1">&#39;sito_set&#39;</span><span class="p">]</span>
            <span class="n">test_conn</span> <span class="o">=</span> <span class="n">conn_str</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;sqlite&#39;</span><span class="p">)</span>
            <span class="n">s_field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[\w_][\W_] +&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">test_conn</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>


                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">sito_set_str</span><span class="p">):</span>
                        <span class="n">filter_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> LIKE &#39;%</span><span class="si">{}</span><span class="s2">%&#39; and sito = &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s_field</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()))</span>
                        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">filter_str</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">setFilter</span><span class="p">(</span><span class="n">filter_str</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">pass</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">filter_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> LIKE &#39;%</span><span class="si">{}</span><span class="s2">%&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s_field</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">filter_str</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">setFilter</span><span class="p">(</span><span class="n">filter_str</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">pass</span>
                <span class="k">except</span> <span class="p">:</span>
                    <span class="k">pass</span><span class="c1">#QMessageBox.warning(self, &quot;Warning&quot;, str(e), QMessageBox.Ok)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">sito_set_str</span><span class="p">):</span>
                        <span class="n">filter_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> LIKE &#39;%</span><span class="si">{}</span><span class="s2">%&#39; and sito = &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s_field</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()))</span>
                        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">filter_str</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">setFilter</span><span class="p">(</span><span class="n">filter_str</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">pass</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">filter_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> LIKE &#39;%</span><span class="si">{}</span><span class="s2">%&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s_field</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">filter_str</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">setFilter</span><span class="p">(</span><span class="n">filter_str</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">pass</span>
                <span class="k">except</span> <span class="p">:</span>
                    <span class="k">pass</span><span class="c1">#QMessageBox.warning(self, &quot;Warning&quot;, str(e), QMessageBox.Ok)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_globalsearch_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">showSearchDialog</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">charge_struttura_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">sito</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">sito</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">struttura_vl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;STRUTTURA&#39;</span><span class="p">)</span>
        <span class="n">struttura_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">struttura_vl</span><span class="p">)):</span>
            <span class="n">struttura_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">struttura_vl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_struttura</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">struttura_vl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">numero_struttura</span><span class="p">)))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">struttura_vl</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_struttura</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_struttura</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">remove_dup_from_list</span><span class="p">(</span><span class="n">struttura_list</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Trova&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Finden&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Find&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_struttura</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Usa&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Aktuell &quot;</span> <span class="ow">or</span> <span class="s2">&quot;Current&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_struttura</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_struttura</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">numero_struttura</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>  <span class="c1"># non vi sono periodi per questo scavo</span>
    <span class="k">def</span> <span class="nf">geometry_unitastratigrafiche</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sito</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="n">area</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="n">us</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>

            <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;scavo_s&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="s1">&#39;area_s&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;self.DATA_LIST[int(self.REC_CORR)].area&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="s1">&#39;us_s&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;self.DATA_LIST[int(self.REC_CORR)].us&quot;</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span>

            <span class="p">}</span>

            <span class="n">geometry_vl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span><span class="s1">&#39;PYUS&#39;</span><span class="p">)</span>
            <span class="n">geometry_list</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">geometry_vl</span><span class="p">)):</span>
                <span class="n">geometry_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">geometry_vl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">geometry_vl</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posizione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posizione</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">remove_dup_from_list</span><span class="p">(</span><span class="n">geometry_list</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Trova&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Finden&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Find&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posizione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Usa&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Aktuell &quot;</span> <span class="ow">or</span> <span class="s2">&quot;Current&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posizione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">posizione</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posizione</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>  <span class="c1"># non vi sono periodi per questo scavo</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">charge_periodo_iniz_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="n">sito</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="n">area</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">sito</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="c1">#&#39;area&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)].area&quot;)) + &quot;&#39;&quot;,</span>
            <span class="p">}</span>
            <span class="n">periodo_vl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PERIODIZZAZIONE&#39;</span><span class="p">)</span>
            <span class="n">periodo_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">periodo_vl</span><span class="p">)):</span>
                <span class="n">periodo_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">periodo_vl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">periodo</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">periodo_vl</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="c1">#</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">remove_dup_from_list</span><span class="p">(</span><span class="n">periodo_list</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Trova&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Finden&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Find&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Usa&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Aktuell &quot;</span> <span class="ow">or</span> <span class="s2">&quot;Current&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">periodo_iniziale</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>  <span class="c1"># non vi sono periodi per questo scavo</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">charge_periodo_fin_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="n">sito</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="n">area</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">sito</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="c1">#&#39;area&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)].area&quot;)) + &quot;&#39;&quot;,</span>
            <span class="p">}</span>
            <span class="n">periodo_vl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PERIODIZZAZIONE&#39;</span><span class="p">)</span>
            <span class="n">periodo_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">periodo_vl</span><span class="p">)):</span>
                <span class="n">periodo_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">periodo_vl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">periodo</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">periodo_vl</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_fin</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_fin</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">remove_dup_from_list</span><span class="p">(</span><span class="n">periodo_list</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Trova&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Finden&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Find&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_fin</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Usa&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Aktuell &quot;</span> <span class="ow">or</span> <span class="s2">&quot;Current&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_fin</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">periodo_iniziale</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>  <span class="c1"># non vi sono periodi per questo scavo</span>
    <span class="k">def</span> <span class="nf">charge_fase_iniz_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#if self.comboBox_fas_iniz.activated:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="s1">&#39;periodo&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">fase_list_vl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PERIODIZZAZIONE&#39;</span><span class="p">)</span>
            <span class="n">fase_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fase_list_vl</span><span class="p">)):</span>
                <span class="n">fase_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_list_vl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fase</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fase_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_iniz</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">fase_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_iniz</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">remove_dup_from_list</span><span class="p">(</span><span class="n">fase_list</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Trova&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Finden&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Find&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_iniz</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_iniz</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">fase_iniziale</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">charge_fase_fin_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#if self.comboBox_fas_fin.activated:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="s1">&#39;periodo&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_fin</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="p">}</span>
            <span class="n">fase_list_vl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PERIODIZZAZIONE&#39;</span><span class="p">)</span>
            <span class="n">fase_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fase_list_vl</span><span class="p">)):</span>
                <span class="n">fase_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_list_vl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fase</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fase_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_fin</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">fase_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_fin</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">remove_dup_from_list</span><span class="p">(</span><span class="n">fase_list</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Trova&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Finden&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Find&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_fin</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_fin</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">fase_finale</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">charge_datazione_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#if self.comboBox_datazione.activated:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="s1">&#39;periodo&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_iniz</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="p">}</span>
            <span class="n">datazione_list_vl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PERIODIZZAZIONE&#39;</span><span class="p">)</span>
            <span class="n">datazione_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datazione_list_vl</span><span class="p">)):</span>
                <span class="n">datazione_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">datazione_list_vl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">datazione_estesa</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">datazione_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_datazione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">datazione_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_datazione</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">remove_dup_from_list</span><span class="p">(</span><span class="n">datazione_list</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Trova&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Finden&quot;</span> <span class="ow">or</span> <span class="s2">&quot;Find&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_datazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_datazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">datazione_estesa</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">on_pushButton_draw_doc_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sito</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="n">area</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="n">us</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;self.tableWidget_documentazione&quot;</span>
        <span class="n">rowSelected_cmd</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.selectedIndexes()&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
        <span class="n">rowSelected</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">rowSelected_cmd</span><span class="p">)</span>
        <span class="n">rowIndex</span> <span class="o">=</span> <span class="p">(</span><span class="n">rowSelected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">row</span><span class="p">())</span>
        <span class="n">tipo_doc_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_documentazione</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">nome_doc_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_documentazione</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tipo_doc</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tipo_doc_item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">nome_doc</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">nome_doc_item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">lista_draw_doc</span> <span class="o">=</span> <span class="p">[</span><span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">us</span><span class="p">,</span> <span class="n">tipo_doc</span><span class="p">,</span> <span class="n">nome_doc</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_vector_layers_doc_from_scheda_US</span><span class="p">(</span><span class="n">lista_draw_doc</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">save_us</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_error_check</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">records_equal_check</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_if</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Attenzione&#39;</span><span class="p">,</span>
                                                           <span class="s2">&quot;Il record e&#39; stato modificato. Vuoi salvare le modifiche? </span><span class="se">\n</span><span class="s2"> Clicca OK per salvare o Annulla per abortire.</span><span class="se">\n</span><span class="s2"> Poi riselezione l&#39;US su cui vuoi andare&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_if</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span>
                                                           <span class="s2">&quot;Der Record wurde ge√§ndert. M√∂chtest du die √Ñnderungen speichern?&quot;</span><span class="p">,</span>
                                                           <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">))</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_if</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span>
                                                           <span class="s2">&quot;The record has been changed. Do you want to save the changes?&quot;</span><span class="p">,</span>
                                                           <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">enable_button</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_error_check</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">test_insert</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_rec</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">test_insert</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">charge_list</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_sito</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">charge_records</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">enable_button</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>




    <span class="k">def</span> <span class="nf">selectRows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># seleziona tutte le row della tablewidget dei rapporti</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()):</span>
            <span class="n">table_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">row_data</span> <span class="o">=</span> <span class="n">table_item</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span><span class="p">)</span>
            <span class="n">row_id</span> <span class="o">=</span> <span class="n">row_data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">selectRow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_pushButton_update_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sito</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span>
        <span class="n">area</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="n">sito</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="n">area</span><span class="p">}</span>
        <span class="n">records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>  <span class="c1"># carica tutti i dati di uno scavo ordinati per numero di US</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectRows</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selectRows</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_pushButton_next_rec_pressed</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">us_t</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">save_rapp</span><span class="p">()</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)))</span><span class="o">*</span><span class="mi">100</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progressBar_2</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">QApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progressBar_2</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">us_t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_validate</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>

                <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;self.tableWidget_rapporti&quot;</span>

                <span class="n">rowSelected_cmd</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.selectedItems()&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
                <span class="n">rowSelected</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">rowSelected_cmd</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">i</span>  <span class="ow">in</span> <span class="n">rowSelected</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
                    <span class="n">rowIndex</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">row</span><span class="p">())</span>
                    <span class="n">sito</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
                    <span class="n">area</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>

                    <span class="n">us_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

                    <span class="n">us_</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">us_item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                    <span class="n">rapp_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="n">rapp_</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rapp_item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>

                    <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                   <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                   <span class="s1">&#39;us&#39;</span><span class="p">:</span> <span class="n">us_</span><span class="p">}</span>
                    <span class="n">u</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">()</span>
                    <span class="n">search_dict</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">remove_empty_items_fr_dict</span><span class="p">(</span><span class="n">search_dict</span><span class="p">)</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>



                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
                        <span class="c1">#</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">rapp_</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">us_</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">unita_tipo</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">d_interpretativa</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">periodo_iniziale</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">p</span><span class="o">.</span><span class="n">fase_iniziale</span><span class="p">))</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>









    <span class="k">def</span> <span class="nf">on_pushButton_go_to_us_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#self.save_us()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;self.tableWidget_rapporti&quot;</span>
            <span class="n">rowSelected_cmd</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.selectedIndexes()&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
            <span class="n">rowSelected</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">rowSelected_cmd</span><span class="p">)</span>
            <span class="n">rowIndex</span> <span class="o">=</span> <span class="p">(</span><span class="n">rowSelected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">row</span><span class="p">())</span>
            <span class="n">sito</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="n">area</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="n">us_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">us</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">us_item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                           <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                           <span class="s1">&#39;us&#39;</span><span class="p">:</span> <span class="n">us</span><span class="p">}</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">()</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">remove_empty_items_fr_dict</span><span class="p">(</span><span class="n">search_dict</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>

                <span class="c1">#self.DB_MANAGER.insert_number_of_us_records(sito,area,us,&#39;US&#39;)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Non e&#39; stato trovato alcun record!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span> <span class="s2">&quot;kein Eintrag gefunden!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="s2">&quot;The record has not been found &quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.lineEdit_us&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                        <span class="n">strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;E&#39; stato trovato&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="s2">&quot;record&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                        <span class="n">strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Es wurde gefunden&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="s2">&quot;record&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;has been found&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="s2">&quot;record&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonGis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_vector_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_usm</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_usm_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                        <span class="n">strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Sono stati trovati&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="s2">&quot;records&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                        <span class="n">strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Sie wurden gefunden&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="s2">&quot;records&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Have been found&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="s2">&quot;records&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonGis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_vector_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_usm</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_usm_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.lineEdit_us&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>


    <span class="k">def</span> <span class="nf">on_pushButton_go_to_scheda_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1">#table_name = &quot;self.table&quot;</span>
            <span class="c1">#rowSelected_cmd = (&quot;%s.selectedIndexes()&quot;) % (table_name)</span>
            <span class="n">rowSelected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="c1">#eval(rowSelected_cmd)</span>
            <span class="n">rowIndex</span> <span class="o">=</span> <span class="n">rowSelected</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>
            <span class="n">sito_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">area_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="c1">#us = str(self.lineEdit_us.text())</span>
            <span class="n">us_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">rowIndex</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
            <span class="c1">#for i in us_item:</span>
            <span class="n">sito</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">sito_item</span><span class="p">)</span>
            <span class="n">area</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">area_item</span><span class="p">)</span>
            <span class="n">us</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">us_item</span><span class="p">)</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                           <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                           <span class="s1">&#39;us&#39;</span><span class="p">:</span> <span class="n">us</span><span class="p">}</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">()</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">remove_empty_items_fr_dict</span><span class="p">(</span><span class="n">search_dict</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Alert&quot;</span><span class="p">,</span> <span class="s2">&quot;Non hai selezionato nessuna riga. Errore python: </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)),</span>
                                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span> <span class="s2">&quot;Keine Spalte ausgew√§lt. Error python: </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)),</span>
                                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Alert&quot;</span><span class="p">,</span> <span class="s2">&quot;You didn&#39;t select any row. Python error: </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)),</span>
                                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">enable_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_list</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_new_rec</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_view_all</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_first_rec</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_last_rec</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_prev_rec</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_next_rec</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_delete</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_new_search</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_search_go</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_sort</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">enable_button_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="c1"># self.pushButton_connect.setEnabled(n)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_new_rec</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_view_all</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_first_rec</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_last_rec</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_prev_rec</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_next_rec</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_delete</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_save</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_sort</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_sort</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_insert_row_rapporti</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_remove_row_rapporti</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_insert_row_inclusi</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_remove_row_inclusi</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_insert_row_campioni</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_remove_row_campioni</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_insert_row_organici</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_remove_row_organici</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_insert_row_inorganici</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_remove_row_inorganici</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_insert_row_documentazione</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_remove_row_documentazione</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_connect_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">()</span>
        <span class="n">conn_str</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">conn_str</span><span class="p">()</span>
        <span class="n">test_conn</span> <span class="o">=</span> <span class="n">conn_str</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;sqlite&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">test_conn</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DB_SERVER</span> <span class="o">=</span> <span class="s2">&quot;sqlite&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span> <span class="o">=</span> <span class="n">Pyarchinit_db_management</span><span class="p">(</span><span class="n">conn_str</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">connection</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">charge_records</span><span class="p">()</span>  <span class="c1"># charge records from DB</span>
            <span class="c1"># check if DB is empty</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">charge_list</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.lineEdit_us&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;BENVENUTO&quot;</span><span class="p">,</span> <span class="s2">&quot;Benvenuto in pyArchInit &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">NOME_SCHEDA</span> <span class="o">+</span> <span class="s2">&quot;. Il database e&#39; vuoto. Premi &#39;Ok&#39; e buon lavoro!&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;WILLKOMMEN&quot;</span><span class="p">,</span><span class="s2">&quot;WILLKOMMEN in pyArchInit&quot;</span> <span class="o">+</span> <span class="s2">&quot;SE-MSE formular&quot;</span><span class="o">+</span> <span class="s2">&quot;. Die Datenbank ist leer. Tippe &#39;Ok&#39; und aufgehts!&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;WELCOME&quot;</span><span class="p">,</span> <span class="s2">&quot;Welcome in pyArchInit&quot;</span> <span class="o">+</span> <span class="s2">&quot;Samples SU-WSU&quot;</span> <span class="o">+</span> <span class="s2">&quot;. The DB is empty. Push &#39;Ok&#39; and Good Work!&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">charge_list</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.lineEdit_us&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">on_pushButton_new_rec_pressed</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;no such table&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;La connessione e&#39; fallita </span><span class="si">{}</span><span class="s2">. &quot;</span> \
                          <span class="s2">&quot;E&#39; NECESSARIO RIAVVIARE QGIS oppure rilevato bug! Segnalarlo allo sviluppatore&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span> <span class="n">Qgis</span><span class="o">.</span><span class="n">Warning</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Verbindungsfehler </span><span class="si">{}</span><span class="s2">. &quot;</span> \
                          <span class="s2">&quot; QGIS neustarten oder es wurde ein bug gefunden! Fehler einsenden&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span> <span class="n">Qgis</span><span class="o">.</span><span class="n">Warning</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;The connection failed </span><span class="si">{}</span><span class="s2">. &quot;</span> \
                          <span class="s2">&quot;You MUST RESTART QGIS or bug detected! Report it to the developer&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Attenzione rilevato bug! Segnalarlo allo sviluppatore. Errore: &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span> <span class="n">Qgis</span><span class="o">.</span><span class="n">Warning</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;ACHTUNG. Es wurde ein bug gefunden! Fehler einsenden: &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span> <span class="n">Qgis</span><span class="o">.</span><span class="n">Warning</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Warning bug detected! Report it to the developer. Error: &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span> <span class="n">Qgis</span><span class="o">.</span><span class="n">Warning</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">customize_GUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">QgsSettings</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;locale/userLocale&quot;</span><span class="p">,</span> <span class="n">QVariant</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">lang</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LANG</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
                <span class="n">lang</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">lang</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">lang</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Pyarchinit_OS_Utility</span><span class="o">.</span><span class="n">checkGraphvizInstallation</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_export_matrix</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_export_matrix</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Funzione disabilitata&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setColumnWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setColumnWidth</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">setColumnWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">setColumnWidth</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">setColumnWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">setColumnWidth</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">setColumnWidth</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="c1"># self.tableWidget_rapporti2.sortItems(0,QtCore.Qt.AscendingOrder)</span>
        <span class="c1"># self.tableWidget_rapporti.sortItems(0,QtCore.Qt.AscendingOrder)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_documentazione</span><span class="o">.</span><span class="n">setColumnWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_documentazione</span><span class="o">.</span><span class="n">setColumnWidth</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mapPreview</span> <span class="o">=</span> <span class="n">QgsMapCanvas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mapPreview</span><span class="o">.</span><span class="n">setCanvasColor</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">225</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">225</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapPreview</span><span class="p">,</span> <span class="s2">&quot;Piante&quot;</span><span class="p">)</span>
        <span class="c1"># media prevew system</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">iconListWidget</span><span class="o">.</span><span class="n">setLineWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iconListWidget</span><span class="o">.</span><span class="n">setMidLineWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iconListWidget</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s2">&quot;showDropIndicator&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iconListWidget</span><span class="o">.</span><span class="n">setIconSize</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="mi">430</span><span class="p">,</span> <span class="mi">570</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">iconListWidget</span><span class="o">.</span><span class="n">setUniformItemSizes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iconListWidget</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;iconListWidget&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iconListWidget</span><span class="o">.</span><span class="n">SelectionMode</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iconListWidget</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">ExtendedSelection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iconListWidget</span><span class="o">.</span><span class="n">itemDoubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openWide_image</span><span class="p">)</span>
        <span class="c1">#self.listWidget_2.itemDoubleClicked.connect(self.opentepmplatePreview)</span>
        <span class="c1"># comboBox customizations</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_per_fin&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_fas_fin&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_per_iniz&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_fas_iniz&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_struttura&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_ref_ra&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_datazione&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># lista tipo rapporti stratigrafici</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="n">valuesRS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Uguale a&quot;</span><span class="p">,</span> <span class="s2">&quot;Si lega a&quot;</span><span class="p">,</span> <span class="s2">&quot;Copre&quot;</span><span class="p">,</span> <span class="s2">&quot;Coperto da&quot;</span><span class="p">,</span> <span class="s2">&quot;Riempie&quot;</span><span class="p">,</span> <span class="s2">&quot;Riempito da&quot;</span><span class="p">,</span> <span class="s2">&quot;Taglia&quot;</span><span class="p">,</span> <span class="s2">&quot;Tagliato da&quot;</span><span class="p">,</span> <span class="s2">&quot;Si appoggia a&quot;</span><span class="p">,</span> <span class="s2">&quot;Gli si appoggia&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;&lt;&quot;</span><span class="p">,</span><span class="s2">&quot;&gt;&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;-&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span> <span class="o">=</span> <span class="n">ComboBoxDelegate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span><span class="o">.</span><span class="n">def_values</span><span class="p">(</span><span class="n">valuesRS</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span><span class="o">.</span><span class="n">def_editable</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setItemDelegateForColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;en&#39;</span><span class="p">:</span>
            <span class="n">valuesRS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Same as&quot;</span><span class="p">,</span> <span class="s2">&quot;Connected to&quot;</span><span class="p">,</span> <span class="s2">&quot;Covers&quot;</span><span class="p">,</span> <span class="s2">&quot;Covered by&quot;</span><span class="p">,</span> <span class="s2">&quot;Fills&quot;</span><span class="p">,</span> <span class="s2">&quot;Filled by&quot;</span><span class="p">,</span> <span class="s2">&quot;Cuts&quot;</span><span class="p">,</span> <span class="s2">&quot;Cutted by&quot;</span><span class="p">,</span> <span class="s2">&quot;Abuts&quot;</span><span class="p">,</span> <span class="s2">&quot;Supports&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span> <span class="o">=</span> <span class="n">ComboBoxDelegate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span><span class="o">.</span><span class="n">def_values</span><span class="p">(</span><span class="n">valuesRS</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span><span class="o">.</span><span class="n">def_editable</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setItemDelegateForColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="n">valuesRS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Entspricht&quot;</span><span class="p">,</span> <span class="s2">&quot;Bindet an&quot;</span><span class="p">,</span> <span class="s2">&quot;Liegt √ºber&quot;</span><span class="p">,</span> <span class="s2">&quot;Liegt unter&quot;</span><span class="p">,</span> <span class="s2">&quot;Verf√ºllt&quot;</span><span class="p">,</span> <span class="s2">&quot;Wird verf√ºllt durch&quot;</span><span class="p">,</span> <span class="s2">&quot;Schneidet&quot;</span><span class="p">,</span> <span class="s2">&quot;Wird geschnitten&quot;</span><span class="p">,</span> <span class="s2">&quot;St√ºtzt sich auf&quot;</span><span class="p">,</span> <span class="s2">&quot;Wird gest√ºzt von&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span> <span class="o">=</span> <span class="n">ComboBoxDelegate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span><span class="o">.</span><span class="n">def_values</span><span class="p">(</span><span class="n">valuesRS</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span><span class="o">.</span><span class="n">def_editable</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setItemDelegateForColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">valuesRS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Same as&quot;</span><span class="p">,</span> <span class="s2">&quot;Connected to&quot;</span><span class="p">,</span> <span class="s2">&quot;Covers&quot;</span><span class="p">,</span> <span class="s2">&quot;Covered by&quot;</span><span class="p">,</span> <span class="s2">&quot;Fills&quot;</span><span class="p">,</span> <span class="s2">&quot;Filled by&quot;</span><span class="p">,</span> <span class="s2">&quot;Cuts&quot;</span><span class="p">,</span> <span class="s2">&quot;Cutted by&quot;</span><span class="p">,</span> <span class="s2">&quot;Abuts&quot;</span><span class="p">,</span> <span class="s2">&quot;Supports&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span> <span class="o">=</span> <span class="n">ComboBoxDelegate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span><span class="o">.</span><span class="n">def_values</span><span class="p">(</span><span class="n">valuesRS</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span><span class="o">.</span><span class="n">def_editable</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">setItemDelegateForColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">delegateRS</span><span class="p">)</span>
        <span class="c1"># lista tipo documentazione</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.19&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">tipo_di_documentazione</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">valuesDoc</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="n">valuesDoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ICCD-Piante&quot;</span><span class="p">)</span>
            <span class="n">valuesDoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ICCD-Sezioni&quot;</span><span class="p">)</span>
            <span class="n">valuesDoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ICCD-Prospetti&quot;</span><span class="p">)</span>
            <span class="n">valuesDoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ICCD-Foto&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="n">valuesDoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Pflanzen&quot;</span><span class="p">)</span>
            <span class="n">valuesDoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Sektionen&quot;</span><span class="p">)</span>
            <span class="n">valuesDoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Prospekte&quot;</span><span class="p">)</span>
            <span class="n">valuesDoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Foto&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">valuesDoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Maps&quot;</span><span class="p">)</span>
            <span class="n">valuesDoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Sections&quot;</span><span class="p">)</span>
            <span class="n">valuesDoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Elevations&quot;</span><span class="p">)</span>
            <span class="n">valuesDoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Photo&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tipo_di_documentazione</span><span class="p">)):</span>
            <span class="n">valuesDoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tipo_di_documentazione</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="c1">#valuesDoc.sort()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateDoc</span> <span class="o">=</span> <span class="n">ComboBoxDelegate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateDoc</span><span class="o">.</span><span class="n">def_values</span><span class="p">(</span><span class="n">valuesDoc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateDoc</span><span class="o">.</span><span class="n">def_editable</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_documentazione</span><span class="o">.</span><span class="n">setItemDelegateForColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delegateDoc</span><span class="p">)</span>




        <span class="c1"># lista colore legante usm</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;201.201&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">colore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">valuesCol</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">colore</span><span class="p">)):</span>
            <span class="n">valuesCol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colore</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">valuesCol</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCol</span> <span class="o">=</span> <span class="n">ComboBoxDelegate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCol</span><span class="o">.</span><span class="n">def_values</span><span class="p">(</span><span class="n">valuesCol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCol</span><span class="o">.</span><span class="n">def_editable</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_colore_legante_usm</span><span class="o">.</span><span class="n">setItemDelegateForColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delegateCol</span><span class="p">)</span>
        <span class="c1"># lista colore materiale usm</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;201.201&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">colore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">valuesCol</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">colore</span><span class="p">)):</span>
            <span class="n">valuesCol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colore</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">valuesCol</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCol</span> <span class="o">=</span> <span class="n">ComboBoxDelegate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCol</span><span class="o">.</span><span class="n">def_values</span><span class="p">(</span><span class="n">valuesCol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCol</span><span class="o">.</span><span class="n">def_editable</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_colore_materiale_usm</span><span class="o">.</span><span class="n">setItemDelegateForColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delegateCol</span><span class="p">)</span>
        <span class="c1"># lista inclusi leganti usm</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;202.202&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="c1"># inclusi = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># valuesInclusi = []</span>
        <span class="c1"># for i in range(len(inclusi)):</span>
            <span class="c1"># valuesInclusi.append(inclusi[i].sigla_estesa)</span>
        <span class="c1"># valuesCol.sort()</span>
        <span class="c1"># self.delegateInclusi = ComboBoxDelegate()</span>
        <span class="c1"># self.delegateInclusi.def_values(valuesInclusi)</span>
        <span class="c1"># self.delegateInclusi.def_editable(&#39;False&#39;)</span>
        <span class="c1"># self.tableWidget_inclusi_leganti_usm.setItemDelegateForColumn(0, self.delegateInclusi)</span>
        <span class="c1"># # lista inclusi materiali usm</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;202.202&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="n">inclusi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">valuesInclusi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inclusi</span><span class="p">)):</span>
            <span class="n">valuesInclusi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inclusi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">valuesCol</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateInclusi</span> <span class="o">=</span> <span class="n">ComboBoxDelegate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateInclusi</span><span class="o">.</span><span class="n">def_values</span><span class="p">(</span><span class="n">valuesInclusi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateInclusi</span><span class="o">.</span><span class="n">def_editable</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi_materiali_usm</span><span class="o">.</span><span class="n">setItemDelegateForColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delegateInclusi</span><span class="p">)</span>
        <span class="c1"># lista consistenza/texture materiale usm</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.7&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">constex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">valuesCTX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">constex</span><span class="p">)):</span>
            <span class="n">valuesCTX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constex</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">valuesCol</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCons</span> <span class="o">=</span> <span class="n">ComboBoxDelegate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCons</span><span class="o">.</span><span class="n">def_values</span><span class="p">(</span><span class="n">valuesCTX</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCons</span><span class="o">.</span><span class="n">def_editable</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_consistenza_texture_mat_usm</span><span class="o">.</span><span class="n">setItemDelegateForColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delegateCons</span><span class="p">)</span>
        <span class="c1"># lista componenti organici</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.14&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">comporg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">valuesCOG</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">comporg</span><span class="p">)):</span>
            <span class="n">valuesCOG</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comporg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">valuesCOG</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCOG</span> <span class="o">=</span> <span class="n">ComboBoxDelegate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCOG</span><span class="o">.</span><span class="n">def_values</span><span class="p">(</span><span class="n">valuesCOG</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCOG</span><span class="o">.</span><span class="n">def_editable</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_organici</span><span class="o">.</span><span class="n">setItemDelegateForColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delegateCOG</span><span class="p">)</span>
        <span class="c1"># lista componenti inorganici</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.15&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">compinorg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">valuesCINOG</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">compinorg</span><span class="p">)):</span>
            <span class="n">valuesCINOG</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compinorg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">valuesCINOG</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCINOG</span> <span class="o">=</span> <span class="n">ComboBoxDelegate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCINOG</span><span class="o">.</span><span class="n">def_values</span><span class="p">(</span><span class="n">valuesCINOG</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateCINOG</span><span class="o">.</span><span class="n">def_editable</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inorganici</span><span class="o">.</span><span class="n">setItemDelegateForColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delegateCINOG</span><span class="p">)</span>
        <span class="c1">#lista campioni</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.13&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">tipo_inclusi_campioni</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">valuesINCL_CAMP</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tipo_inclusi_campioni</span><span class="p">)):</span>
            <span class="n">valuesINCL_CAMP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tipo_inclusi_campioni</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">valuesINCL_CAMP</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="c1">#valuesINCL_CAMP = [&quot;Terra&quot;,</span>
         <span class="c1">#                  &quot;Pietre&quot;,</span>
         <span class="c1">#                  &quot;Laterizio&quot;,</span>
         <span class="c1">#                  &quot;Ciottoli&quot;,</span>
         <span class="c1">#                  &quot;Calcare&quot;,</span>
         <span class="c1">#                  &quot;Calce&quot;,</span>
          <span class="c1">#                 &quot;Carboni&quot;,</span>
         <span class="c1">#                  &quot;Concotto&quot;,</span>
         <span class="c1">#                  &quot;Ghiaia&quot;,</span>
         <span class="c1">#                  &quot;Cariossidi&quot;,</span>
         <span class="c1">#                  &quot;Malacofauna&quot;,</span>
          <span class="c1">#                 &quot;Sabbia&quot;,</span>
          <span class="c1">#                 &quot;Malta&quot;,</span>
          <span class="c1">#                 &quot;Ceramica&quot;,</span>
          <span class="c1">#                 &quot;Metalli&quot;,</span>
          <span class="c1">#                 &quot;Fr. ossei umani&quot;,</span>
           <span class="c1">#                &quot;Fr. ossei animali&quot;,</span>
           <span class="c1">#                &quot;Fr. lapidei&quot;]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateINCL_CAMP</span> <span class="o">=</span> <span class="n">ComboBoxDelegate</span><span class="p">()</span>
        <span class="n">valuesINCL_CAMP</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateINCL_CAMP</span><span class="o">.</span><span class="n">def_values</span><span class="p">(</span><span class="n">valuesINCL_CAMP</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateINCL_CAMP</span><span class="o">.</span><span class="n">def_editable</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_campioni</span><span class="o">.</span><span class="n">setItemDelegateForColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delegateINCL_CAMP</span><span class="p">)</span>
        <span class="c1"># lista inclusi</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;202.202&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">tipo_inclusi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">valuesINCL</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tipo_inclusi</span><span class="p">)):</span>
            <span class="n">valuesINCL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tipo_inclusi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">valuesINCL</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateINCL</span> <span class="o">=</span> <span class="n">ComboBoxDelegate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateINCL</span><span class="o">.</span><span class="n">def_values</span><span class="p">(</span><span class="n">valuesINCL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegateINCL</span><span class="o">.</span><span class="n">def_editable</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi</span><span class="o">.</span><span class="n">setItemDelegateForColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delegateINCL</span><span class="p">)</span>
    <span class="c1"># def loadMedialist(self):</span>
        <span class="c1"># self.tableWidget_foto.clear()</span>
        <span class="c1"># col =[&#39;Sito&#39;,&#39;Area&#39;,&#39;US&#39;,&#39;Definizione&#39;]</span>
        <span class="c1"># self.tableWidget_foto.setHorizontalHeaderLabels(col)</span>
        <span class="c1"># numRows = self.tableWidget_foto.setRowCount(100)</span>
        <span class="c1"># try:</span>
            <span class="c1"># search_dict = {</span>
                <span class="c1"># &#39;sito&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)]. &quot; + self.ID_SITO)) + &quot;&#39;&quot;}</span>
            <span class="c1"># record_us_list = self.DB_MANAGER.query_bool(search_dict, &#39;US&#39;)</span>
            <span class="c1"># nus=0</span>
            <span class="c1"># for b in record_us_list:</span>
                <span class="c1"># if nus== 0:</span>
                    <span class="c1"># self.tableWidget_foto.setItem(nus, 0, QTableWidgetItem(str(b.sito)))</span>
                    <span class="c1"># self.tableWidget_foto.setItem(nus, 1, QTableWidgetItem(str(b.area)))</span>
                    <span class="c1"># self.tableWidget_foto.setItem(nus, 3, QTableWidgetItem(str(b.d_stratigrafica)))</span>
                    <span class="c1"># self.tableWidget_foto.setItem(nus, 2, QTableWidgetItem(str(b.us)))</span>
                    <span class="c1"># nus+=1</span>
                <span class="c1"># else:</span>
                    <span class="c1"># self.tableWidget_foto.setItem(nus, 0, QTableWidgetItem(str(b.sito)))</span>
                    <span class="c1"># self.tableWidget_foto.setItem(nus, 1, QTableWidgetItem(str(b.area)))</span>
                    <span class="c1"># self.tableWidget_foto.setItem(nus, 3, QTableWidgetItem(str(b.d_stratigrafica)))</span>
                    <span class="c1"># self.tableWidget_foto.setItem(nus, 2, QTableWidgetItem(str(b.us)))</span>
                    <span class="c1"># nus+=1</span>
        <span class="c1"># except:</span>
            <span class="c1"># pass</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;id_entity&#39;: &quot;&#39;&quot; + str(eval(&quot;self.DATA_LIST[int(self.REC_CORR)].&quot; + self.ID_TABLE)) + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;entity_type&#39;: &quot;&#39;US&#39;&quot;}</span>
        <span class="c1"># record_media_list = self.DB_MANAGER.query_bool(search_dict, &#39;MEDIATOENTITY&#39;)</span>
        <span class="c1"># n=0</span>
        <span class="c1"># for a in record_media_list:</span>
            <span class="c1"># if n== 0:</span>
                <span class="c1"># self.tableWidget_foto.setItem(n, 3,QTableWidgetItem(str(a.media_name)))</span>
                <span class="c1"># n+=1</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.tableWidget_foto.setItem(n, 3,QTableWidgetItem(str(a.media_name)))</span>
                <span class="c1"># n+=1</span>
    <span class="k">def</span> <span class="nf">loadMapPreview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot; if has geometry column load to map canvas &quot;&quot;&quot;</span>
            <span class="n">gidstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
                <span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;self.DATA_LIST[int(self.REC_CORR)].&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">))</span>
            <span class="n">layerToSet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">loadMapPreview</span><span class="p">(</span><span class="n">gidstr</span><span class="p">)</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;layer to set&quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">l</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">layerToSet</span><span class="p">]),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mapPreview</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">layerToSet</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mapPreview</span><span class="o">.</span><span class="n">zoomToFullExtent</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mapPreview</span><span class="o">.</span><span class="n">setLayers</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mapPreview</span><span class="o">.</span><span class="n">zoomToFullExtent</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">loadMediaPreview</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iconListWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">()</span>
        <span class="n">thumb_path</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">thumb_path</span><span class="p">()</span>
        <span class="n">thumb_path_str</span> <span class="o">=</span> <span class="n">thumb_path</span><span class="p">[</span><span class="s1">&#39;thumb_path&#39;</span><span class="p">]</span>
        <span class="c1"># if mode == 0:</span>
        <span class="c1"># &quot;&quot;&quot; if has geometry column load to map canvas &quot;&quot;&quot;</span>
        <span class="n">rec_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;self.DATA_LIST[int(self.REC_CORR)].&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">))</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;id_entity&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;self.DATA_LIST[int(self.REC_CORR)].&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;entity_type&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;US&#39;&quot;</span><span class="p">}</span>
        <span class="n">record_us_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;MEDIATOENTITY&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">record_us_list</span><span class="p">:</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;id_media&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">id_media</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">}</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">()</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">remove_empty_items_fr_dict</span><span class="p">(</span><span class="n">search_dict</span><span class="p">)</span>
            <span class="n">mediathumb_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s2">&quot;MEDIA_THUMB&quot;</span><span class="p">)</span>
            <span class="n">thumb_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">mediathumb_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">QListWidgetItem</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">media_name</span><span class="p">))</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">media_name</span><span class="p">))</span>
            <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="n">thumb_path_str</span><span class="o">+</span><span class="n">thumb_path</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iconListWidget</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="c1"># elif mode == 1:</span>
            <span class="c1"># self.iconListWidget.clear()</span>
    <span class="k">def</span> <span class="nf">openWide_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iconListWidget</span><span class="o">.</span><span class="n">selectedItems</span><span class="p">()</span>
        <span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">()</span>
        <span class="n">conn_str</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">conn_str</span><span class="p">()</span>
        <span class="n">thumb_resize</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">thumb_resize</span><span class="p">()</span>
        <span class="n">thumb_resize_str</span> <span class="o">=</span> <span class="n">thumb_resize</span><span class="p">[</span><span class="s1">&#39;thumb_resize&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">dlg</span> <span class="o">=</span> <span class="n">ImageViewer</span><span class="p">()</span>
            <span class="n">id_orig_item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>  <span class="c1"># return the name of original file</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;media_filename&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">id_orig_item</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="p">,</span> <span class="s1">&#39;mediatype&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;video&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">}</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">()</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">remove_empty_items_fr_dict</span><span class="p">(</span><span class="n">search_dict</span><span class="p">)</span>
            <span class="c1">#try:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s2">&quot;MEDIA_THUMB&quot;</span><span class="p">)</span>
            <span class="n">search_dict_2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;media_filename&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">id_orig_item</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="p">,</span> <span class="s1">&#39;mediatype&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;image&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">}</span>
            <span class="n">search_dict_2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">remove_empty_items_fr_dict</span><span class="p">(</span><span class="n">search_dict_2</span><span class="p">)</span>
            <span class="c1">#try:</span>
            <span class="n">res_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict_2</span><span class="p">,</span> <span class="s2">&quot;MEDIA_THUMB&quot;</span><span class="p">)</span>
            <span class="n">search_dict_3</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;media_filename&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">id_orig_item</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">}</span>
            <span class="n">search_dict_3</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">remove_empty_items_fr_dict</span><span class="p">(</span><span class="n">search_dict_3</span><span class="p">)</span>
            <span class="c1">#try:</span>
            <span class="n">res_3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict_3</span><span class="p">,</span> <span class="s2">&quot;MEDIA_THUMB&quot;</span><span class="p">)</span>
            <span class="c1"># file_path = str(res[0].path_resize)</span>
            <span class="c1"># file_path_2 = str(res_2[0].path_resize)</span>
            <span class="n">file_path_3</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">res_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">path_resize</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">thumb_resize_str</span><span class="o">+</span><span class="n">file_path_3</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">bool</span><span class="p">(</span><span class="n">res_2</span><span class="p">):</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">show_image</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">thumb_resize_str</span><span class="o">+</span><span class="n">file_path_3</span><span class="p">))</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">charge_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">QgsSettings</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;locale/userLocale&quot;</span><span class="p">,</span> <span class="n">QVariant</span><span class="p">)</span>
        <span class="n">lang</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LANG</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
                <span class="n">lang</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">lang</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">lang</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="c1"># lista sito</span>
        <span class="n">sito_vl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">tup_2_list_III</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s1">&#39;site_table&#39;</span><span class="p">,</span> <span class="s1">&#39;sito&#39;</span><span class="p">,</span> <span class="s1">&#39;SITE&#39;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sito_vl</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;list.remove(x): x not in list&quot;</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Messaggio&quot;</span><span class="p">,</span> <span class="s2">&quot;Sistema di aggiornamento lista Sito: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;en&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span> <span class="s2">&quot;Site list update system: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Nachricht&quot;</span><span class="p">,</span> <span class="s2">&quot;Aktualisierungssystem f√ºr die Ausgrabungst√§tte: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito_rappcheck</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">sito_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">sito_vl</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito_rappcheck</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">sito_vl</span><span class="p">)</span>

        <span class="n">responsabile_vl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">tup_2_list_III</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s1">&#39;us_table&#39;</span><span class="p">,</span> <span class="s1">&#39;schedatore&#39;</span><span class="p">,</span> <span class="s1">&#39;US&#39;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">responsabile_vl</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_schedatore</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">responsabile_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_schedatore</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">responsabile_vl</span><span class="p">)</span>


        <span class="n">responsabile2_vl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">tup_2_list_III</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s1">&#39;us_table&#39;</span><span class="p">,</span> <span class="s1">&#39;direttore_us&#39;</span><span class="p">,</span> <span class="s1">&#39;US&#39;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">responsabile2_vl</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_direttore_us</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">responsabile2_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_direttore_us</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">responsabile2_vl</span><span class="p">)</span>


        <span class="n">responsabile3_vl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">tup_2_list_III</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s1">&#39;us_table&#39;</span><span class="p">,</span> <span class="s1">&#39;responsabile_us&#39;</span><span class="p">,</span> <span class="s1">&#39;US&#39;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">responsabile3_vl</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_responsabile_us</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">responsabile3_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_responsabile_us</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">responsabile3_vl</span><span class="p">)</span>





        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_settore</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.1&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">settore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">settore_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">settore</span><span class="p">)):</span>
            <span class="n">settore_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">settore</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla</span><span class="p">)</span>
        <span class="n">settore_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_settore</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">settore_vl</span><span class="p">)</span>
        <span class="c1"># lista soprintendenza</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_soprintendenza</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.2&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">soprintendenza</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">soprintendenza_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">soprintendenza</span><span class="p">)):</span>
            <span class="n">soprintendenza_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">soprintendenza</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">soprintendenza_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_soprintendenza</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">soprintendenza_vl</span><span class="p">)</span>
        <span class="c1"># lista definizione_stratigrafica</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_strat</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.3&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">d_stratigrafica</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">d_stratigrafica_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d_stratigrafica</span><span class="p">)):</span>
            <span class="n">d_stratigrafica_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d_stratigrafica</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">d_stratigrafica_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_strat</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">d_stratigrafica_vl</span><span class="p">)</span>
        <span class="c1"># lista definizione interpretata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_intepret</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.4&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">d_interpretativa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">d_interpretativa_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d_interpretativa</span><span class="p">)):</span>
            <span class="n">d_interpretativa_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d_interpretativa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">d_interpretativa_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_intepret</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">d_interpretativa_vl</span><span class="p">)</span>
        <span class="c1"># lista funzione statica</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_funz_statica_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.5&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">funz_statica</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">funz_statica_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">funz_statica</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">funz_statica</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">funz_statica_vl</span><span class="p">:</span>
                <span class="n">funz_statica_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">funz_statica</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">funz_statica_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_funz_statica_usm</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">funz_statica_vl</span><span class="p">)</span>
        <span class="c1">#lista consistenza legante usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_legante_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.6&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">consistenza_legante_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">consistenza_legante_usm_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">consistenza_legante_usm</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">consistenza_legante_usm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">consistenza_legante_usm_vl</span><span class="p">:</span>
                <span class="n">consistenza_legante_usm_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">consistenza_legante_usm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">consistenza_legante_usm_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_legante_usm</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">consistenza_legante_usm_vl</span><span class="p">)</span>
        <span class="c1"># lista scavato</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_scavato</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;203.203&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">scavato</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">scavato_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scavato</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">scavato</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">scavato_vl</span><span class="p">:</span>
                <span class="n">scavato_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scavato</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">scavato_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_scavato</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">scavato_vl</span><span class="p">)</span>
        <span class="c1"># lista metodo di scavo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_metodo</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.8&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">metodo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">metodo_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">metodo</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">metodo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metodo_vl</span><span class="p">:</span>
                <span class="n">metodo_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metodo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">metodo_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_metodo</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">metodo_vl</span><span class="p">)</span>
        <span class="c1"># lista formazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_formazione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.9&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">formazione</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">formazione_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">formazione</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">formazione</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">formazione_vl</span><span class="p">:</span>
                <span class="n">formazione_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">formazione</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">formazione_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_formazione</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">formazione_vl</span><span class="p">)</span>
        <span class="c1"># lista modo formazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modo_formazione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.10&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">modo_formazione</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">modo_formazione_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">modo_formazione</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">modo_formazione</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modo_formazione_vl</span><span class="p">:</span>
                <span class="n">modo_formazione_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modo_formazione</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">modo_formazione_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modo_formazione</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">modo_formazione_vl</span><span class="p">)</span>
        <span class="c1"># lista colore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;201.201&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">colore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">colore_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">colore</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">colore</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">colore_vl</span><span class="p">:</span>
                <span class="n">colore_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colore</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">colore_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">colore_vl</span><span class="p">)</span>
        <span class="c1"># lista consistenza</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.11&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">consistenza</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">consistenza_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">consistenza</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">consistenza</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">consistenza_vl</span><span class="p">:</span>
                <span class="n">consistenza_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">consistenza</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">consistenza_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">consistenza_vl</span><span class="p">)</span>
        <span class="c1"># lista stato di conservazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_conservazione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.12&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">conservazione</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">conservazione_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">conservazione</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">conservazione</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">conservazione_vl</span><span class="p">:</span>
                <span class="n">conservazione_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conservazione</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">conservazione_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_conservazione</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">conservazione_vl</span><span class="p">)</span>
        <span class="c1"># lista schedatore</span>
        <span class="c1"># self.comboBox_schedatore.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.16&#39; + &quot;&#39;&quot;</span>
        <span class="c1">#}</span>
        <span class="c1"># schedatore = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># schedatore_vl = []</span>
        <span class="c1"># for i in range(len(schedatore)):</span>
            <span class="c1"># if schedatore[i].sigla_estesa not in schedatore_vl:</span>
                <span class="c1"># schedatore_vl.append(schedatore[i].sigla_estesa)</span>
        <span class="c1"># schedatore_vl.sort()</span>
        <span class="c1"># self.comboBox_schedatore.addItems(schedatore_vl)</span>
        <span class="c1"># # lista direttore us</span>
        <span class="c1"># self.comboBox_direttore_us.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.17&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># direttore_us = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># direttore_us_vl = []</span>
        <span class="c1"># for i in range(len(direttore_us)):</span>
            <span class="c1"># if direttore_us[i].sigla_estesa not in direttore_us_vl:</span>
                <span class="c1"># direttore_us_vl.append(direttore_us[i].sigla_estesa)</span>
        <span class="c1"># direttore_us_vl.sort()</span>
        <span class="c1"># self.comboBox_direttore_us.addItems(direttore_us_vl)</span>
        <span class="c1"># # lista responsabile us</span>
        <span class="c1"># self.comboBox_responsabile_us.clear()</span>
        <span class="c1"># search_dict = {</span>
            <span class="c1"># &#39;lingua&#39;: lang,</span>
            <span class="c1"># &#39;nome_tabella&#39;: &quot;&#39;&quot; + &#39;us_table&#39; + &quot;&#39;&quot;,</span>
            <span class="c1"># &#39;tipologia_sigla&#39;: &quot;&#39;&quot; + &#39;2.18&#39; + &quot;&#39;&quot;</span>
        <span class="c1"># }</span>
        <span class="c1"># responsabile_us = self.DB_MANAGER.query_bool(search_dict, &#39;PYARCHINIT_THESAURUS_SIGLE&#39;)</span>
        <span class="c1"># responsabile_us_vl = []</span>
        <span class="c1"># for i in range(len(responsabile_us)):</span>
            <span class="c1"># if responsabile_us[i].sigla_estesa not in responsabile_us_vl:</span>
                <span class="c1"># responsabile_us_vl.append(responsabile_us[i].sigla_estesa)</span>
        <span class="c1"># responsabile_us_vl.sort()</span>
        <span class="c1"># self.comboBox_responsabile_us.addItems(responsabile_us_vl)</span>


        <span class="c1"># # lista tipologia_opera</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipologia_opera</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.20&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">tipologia_opera</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">tipologia_opera_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tipologia_opera</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">tipologia_opera</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tipologia_opera_us_vl</span><span class="p">:</span>
                <span class="n">tipologia_opera_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tipologia_opera</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">tipologia_opera_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipologia_opera</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">tipologia_opera_us_vl</span><span class="p">)</span>
        <span class="c1"># lista sezione muraria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sezione_muraria</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.21&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">sezione_muraria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">sezione_muraria_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sezione_muraria</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">sezione_muraria</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sezione_muraria_us_vl</span><span class="p">:</span>
                <span class="n">sezione_muraria_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sezione_muraria</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">sezione_muraria_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sezione_muraria</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">sezione_muraria_us_vl</span><span class="p">)</span>
        <span class="c1"># lista superficie_analizzata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_superficie_analizzata</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.22&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">sup_analiz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">sup_analiz_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sezione_muraria</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">sup_analiz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sup_analiz_vl</span><span class="p">:</span>
                <span class="n">sup_analiz_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sup_analiz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">sezione_muraria_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_superficie_analizzata</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">sup_analiz_vl</span><span class="p">)</span>
        <span class="c1"># lista orientamento</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_orientamento</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.23&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">orientamento</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">orientamento_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orientamento</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">orientamento</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">orientamento_us_vl</span><span class="p">:</span>
                <span class="n">orientamento_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orientamento</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">orientamento_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_orientamento</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">orientamento_us_vl</span><span class="p">)</span>
        <span class="c1"># lista materiali_laterizi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiali_lat</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.24&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">materiali_lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">materiali_lat_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">materiali_lat</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">materiali_lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">materiali_lat_us_vl</span><span class="p">:</span>
                <span class="n">materiali_lat_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">materiali_lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">materiali_lat_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiali_lat</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">materiali_lat_us_vl</span><span class="p">)</span>
        <span class="c1"># lista lavorazione laterizi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_lat</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.25&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">lavorazione_lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">lavorazione_lat_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lavorazione_lat</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">lavorazione_lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lavorazione_lat_us_vl</span><span class="p">:</span>
                <span class="n">lavorazione_lat_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lavorazione_lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">lavorazione_lat_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_lat</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">lavorazione_lat_us_vl</span><span class="p">)</span>
        <span class="c1"># lista consistenza laterizi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_lat</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.26&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">consistenza_lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">consistenza_lat_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">consistenza_lat</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">consistenza_lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">consistenza_lat_us_vl</span><span class="p">:</span>
                <span class="n">consistenza_lat_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">consistenza_lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">consistenza_lat_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_lat</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">consistenza_lat_us_vl</span><span class="p">)</span>
        <span class="c1"># lista forma laterizi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_lat</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.27&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">forma_lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">forma_lat_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">forma_lat</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">forma_lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">forma_lat_us_vl</span><span class="p">:</span>
                <span class="n">forma_lat_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">forma_lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">forma_lat_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_lat</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">forma_lat_us_vl</span><span class="p">)</span>
        <span class="c1"># lista colore laterizi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_lat</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.28&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">colore_lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">colore_lat_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">colore_lat</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">colore_lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">colore_lat_us_vl</span><span class="p">:</span>
                <span class="n">colore_lat_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colore_lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">colore_lat_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_lat</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">colore_lat_us_vl</span><span class="p">)</span>
        <span class="c1"># lista impasto laterizi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_impasto_lat</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.29&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">impasto_lat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">impasto_lat_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">impasto_lat</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">impasto_lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">impasto_lat_us_vl</span><span class="p">:</span>
                <span class="n">impasto_lat_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">impasto_lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">impasto_lat_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_impasto_lat</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">impasto_lat_us_vl</span><span class="p">)</span>
        <span class="c1"># lista materiali litici</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiale_p</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.30&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">materiale_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">materiale_p_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">materiale_p</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">materiale_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">materiale_p_us_vl</span><span class="p">:</span>
                <span class="n">materiale_p_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">materiale_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">materiale_p_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiale_p</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">materiale_p_us_vl</span><span class="p">)</span>
        <span class="c1"># lista consistenza materiali litici</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_p</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.31&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">consistenza_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">consistenza_p_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">consistenza_p</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">consistenza_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">consistenza_p_us_vl</span><span class="p">:</span>
                <span class="n">consistenza_p_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">consistenza_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">consistenza_p_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_p</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">consistenza_p_us_vl</span><span class="p">)</span>
        <span class="c1"># lista forma materiali litici</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_p</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.32&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">forma_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">forma_p_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">forma_p</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">forma_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">forma_p_us_vl</span><span class="p">:</span>
                <span class="n">forma_p_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">forma_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">forma_p_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_p</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">forma_p_us_vl</span><span class="p">)</span>
        <span class="c1"># lista colore materiali litici</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_p</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.33&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">colore_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">colore_p_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">colore_p</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">colore_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">colore_p_us_vl</span><span class="p">:</span>
                <span class="n">colore_p_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colore_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">colore_p_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_p</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">colore_p_us_vl</span><span class="p">)</span>
        <span class="c1"># lista taglio materiali litici</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_taglio_p</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.34&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">taglio_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">taglio_p_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">taglio_p</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">taglio_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">taglio_p_us_vl</span><span class="p">:</span>
                <span class="n">taglio_p_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">taglio_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">taglio_p_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_taglio_p</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">taglio_p_us_vl</span><span class="p">)</span>
        <span class="c1"># lista posa opera materiali litici</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_opera_p</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.35&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">posa_opera_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">posa_opera_p_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">posa_opera_p</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">posa_opera_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">posa_opera_p_us_vl</span><span class="p">:</span>
                <span class="n">posa_opera_p_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posa_opera_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">posa_opera_p_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_opera_p</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">posa_opera_p_us_vl</span><span class="p">)</span>
        <span class="c1"># lista posa opera materiali laterizi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_in_opera_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.36&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">posa_opera_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">posa_opera_usm_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">posa_opera_usm</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">posa_opera_usm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">posa_opera_usm_us_vl</span><span class="p">:</span>
                <span class="n">posa_opera_usm_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posa_opera_usm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">posa_opera_usm_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_in_opera_usm</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">posa_opera_usm_us_vl</span><span class="p">)</span>
        <span class="c1"># lista tecniche costruttive</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tecnica_muraria_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.37&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">t_costruttiva</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">t_costruttiva_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_costruttiva</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">t_costruttiva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">t_costruttiva_us_vl</span><span class="p">:</span>
                <span class="n">t_costruttiva_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_costruttiva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">t_costruttiva_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tecnica_muraria_usm</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">t_costruttiva_us_vl</span><span class="p">)</span>
        <span class="c1"># lista modulo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modulo_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.38&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">modulo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">modulo_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">modulo</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">modulo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modulo_us_vl</span><span class="p">:</span>
                <span class="n">modulo_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modulo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">modulo_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modulo_usm</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">modulo_us_vl</span><span class="p">)</span>
        <span class="c1"># lista inerti</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_inerti_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.39&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">inerti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">inerti_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inerti</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">inerti</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inerti_us_vl</span><span class="p">:</span>
                <span class="n">inerti_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inerti</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">inerti_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_inerti_usm</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">inerti_us_vl</span><span class="p">)</span>
        <span class="c1"># lista tipologia legante</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipo_legante_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.40&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">tipo_legante</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">tipo_legante_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tipo_legante</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">tipo_legante</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tipo_legante_us_vl</span><span class="p">:</span>
                <span class="n">tipo_legante_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tipo_legante</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">tipo_legante_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipo_legante_usm</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">tipo_legante_us_vl</span><span class="p">)</span>
        <span class="c1"># lista rifinitura</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_rifinitura_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.41&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">rifinitura</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">rifinitura_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rifinitura</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">rifinitura</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rifinitura_us_vl</span><span class="p">:</span>
                <span class="n">rifinitura_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rifinitura</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">rifinitura_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_rifinitura_usm</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">rifinitura_us_vl</span><span class="p">)</span>
        <span class="c1"># lista lavorazione litica</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lingua&#39;</span><span class="p">:</span> <span class="n">lang</span><span class="p">,</span>
            <span class="s1">&#39;nome_tabella&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;us_table&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;tipologia_sigla&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s1">&#39;2.42&#39;</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">}</span>
        <span class="n">lavorazione_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;PYARCHINIT_THESAURUS_SIGLE&#39;</span><span class="p">)</span>
        <span class="n">lavorazione_p_us_vl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lavorazione_p</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">lavorazione_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lavorazione_p_us_vl</span><span class="p">:</span>
                <span class="n">lavorazione_p_us_vl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lavorazione_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sigla_estesa</span><span class="p">)</span>
        <span class="n">lavorazione_p_us_vl</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_usm</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">lavorazione_p_us_vl</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">msg_sito</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#self.model_a.database().close()</span>
        <span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">()</span>
        <span class="n">sito_set</span><span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">sito_set</span><span class="p">()</span>
        <span class="n">sito_set_str</span> <span class="o">=</span> <span class="n">sito_set</span><span class="p">[</span><span class="s1">&#39;sito_set&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="n">sito_set_str</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;OK&quot;</span> <span class="p">,</span><span class="s2">&quot;Sei connesso al sito: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito_set_str</span><span class="p">),</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="s2">&quot;Sie sind mit der arch√§ologischen St√§tte verbunden: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito_set_str</span><span class="p">),</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="s2">&quot;You are connected to the site: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito_set_str</span><span class="p">),</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">sito_set_str</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Attenzione&quot;</span> <span class="p">,</span><span class="s2">&quot;Non hai settato alcun sito. Vuoi settarne uno? click Ok altrimenti Annulla per  vedere tutti i record&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Achtung&quot;</span><span class="p">,</span> <span class="s2">&quot;Sie haben keine arch√§ologischen St√§tten eingerichtet. Klicken Sie auf OK oder Abbrechen, um alle Datens√§tze zu sehen&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Warning&quot;</span> <span class="p">,</span> <span class="s2">&quot;You have not set up any archaeological site. Do you want to set one? click Ok otherwise Cancel to see all records&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">msg</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dlg</span> <span class="o">=</span> <span class="n">pyArchInitDialog_Config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">charge_list</span><span class="p">()</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">set_sito</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#self.model_a.database().close()</span>
        <span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">()</span>
        <span class="n">sito_set</span><span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">sito_set</span><span class="p">()</span>
        <span class="n">sito_set_str</span> <span class="o">=</span> <span class="n">sito_set</span><span class="p">[</span><span class="s1">&#39;sito_set&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">bool</span> <span class="p">(</span><span class="n">sito_set_str</span><span class="p">):</span>
                <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito_set_str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">}</span>  <span class="c1"># 1 - Sito</span>
                <span class="n">u</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">()</span>
                <span class="n">search_dict</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">remove_empty_items_fr_dict</span><span class="p">(</span><span class="n">search_dict</span><span class="p">)</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">####darivedere</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span><span class="c1">#</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>

                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Attenzione&quot;</span> <span class="p">,</span><span class="s2">&quot;Non esiste questo sito: &quot;</span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sito_set_str</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="s2">&quot; in questa scheda, Per favore distattiva la &#39;scelta sito&#39; dalla scheda di configurazione plugin per vedere tutti i record oppure crea la scheda&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>

                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Warnung&quot;</span> <span class="p">,</span> <span class="s2">&quot;Es gibt keine solche arch√§ologische St√§tte: &quot;</span><span class="s1">&#39;&quot;&quot;&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito_set_str</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="s2">&quot; in dieser Registerkarte, Bitte deaktivieren Sie die &#39;Site-Wahl&#39; in der Plugin-Konfigurationsregisterkarte, um alle Datens√§tze zu sehen oder die Registerkarte zu erstellen&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>

                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Warning&quot;</span> <span class="p">,</span> <span class="s2">&quot;There is no such site: &quot;</span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito_set_str</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="s2">&quot; in this tab, Please disable the &#39;site choice&#39; from the plugin configuration tab to see all records or create the tab&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">generate_list_foto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data_list_foto</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)):</span>
            <span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">()</span>
            <span class="n">thumb_path</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">thumb_path</span><span class="p">()</span>
            <span class="n">thumb_path_str</span> <span class="o">=</span> <span class="n">thumb_path</span><span class="p">[</span><span class="s1">&#39;thumb_path&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">thumb_path_str</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Info&quot;</span><span class="p">,</span> <span class="s2">&quot;devi settare prima la path per salvare le thumbnail . Vai in impostazioni di sistema/ path setting &quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Info&quot;</span><span class="p">,</span> <span class="s2">&quot;m√ºssen Sie zuerst den Pfad zum Speichern der Miniaturansichten und Videos festlegen. Gehen Sie zu System-/Pfad-Einstellung&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span> <span class="s2">&quot;you must first set the path to save the thumbnails and videos. Go to system/path setting&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;id_entity&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;self.DATA_LIST[i].id_us&quot;</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;entity_type&#39;</span> <span class="p">:</span> <span class="s2">&quot;&#39;US&#39;&quot;</span><span class="p">}</span>
                <span class="n">record_doc_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="s1">&#39;MEDIAVIEW&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">media</span> <span class="ow">in</span> <span class="n">record_doc_list</span><span class="p">:</span>
                    <span class="n">thumbnail</span> <span class="o">=</span> <span class="p">(</span><span class="n">thumb_path_str</span><span class="o">+</span><span class="n">media</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>
                    <span class="n">foto</span><span class="o">=</span> <span class="p">(</span><span class="n">media</span><span class="o">.</span><span class="n">id_media</span><span class="p">)</span>
                    <span class="c1"># #sito= (media.sito)</span>
                    <span class="c1"># area= (media.area)</span>
                    <span class="c1"># us= (media.us)</span>
                    <span class="c1"># d_stratigrafica= &#39;&#39;</span>
                    <span class="c1"># unita_tipo = (media.unita_tipo)</span>
                    <span class="n">data_list_foto</span><span class="o">.</span><span class="n">append</span><span class="p">([</span>
                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sito</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)),</span> <span class="c1">#0</span>
                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">),</span> <span class="c1">#1</span>
                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">us</span><span class="p">),</span>    <span class="c1">#2</span>
                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">unita_tipo</span><span class="p">),</span><span class="c1">#3</span>
                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d_stratigrafica</span><span class="p">),</span>  <span class="c1">#4</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">foto</span><span class="p">),</span><span class="c1">#5</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">thumbnail</span><span class="p">)])</span><span class="c1">#6</span>
        <span class="k">return</span> <span class="n">data_list_foto</span>
            <span class="c1"># #####################fine########################</span>
    <span class="k">def</span> <span class="nf">generate_list_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#############inserimento nome fiel media############</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)):</span>
            <span class="c1"># assegnazione valori di quota mn e max</span>
            <span class="n">id_us</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">id_us</span><span class="p">)</span>
            <span class="n">sito</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sito</span><span class="p">)</span><span class="c1">#.replace(&#39;_&#39;,&#39; &#39;))</span>
            <span class="n">area</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">)</span>
            <span class="n">us</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">us</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">select_quote_from_db_sql</span><span class="p">(</span><span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">us</span><span class="p">)</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">sing_us</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
                <span class="n">sing_quota_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sing_us</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">sing_quota_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                    <span class="n">sing_quota_value</span> <span class="o">=</span> <span class="n">sing_quota_value</span><span class="p">[:</span><span class="mi">7</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sing_quota_value</span> <span class="o">=</span> <span class="n">sing_quota_value</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
                <span class="n">sing_quota</span> <span class="o">=</span> <span class="p">[</span><span class="n">sing_quota_value</span><span class="p">,</span> <span class="n">sing_us</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span>
                <span class="n">quote</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sing_quota</span><span class="p">)</span>
            <span class="n">quote</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="c1">#QMessageBox.information(self, &quot;Message&quot;, str(quote))</span>
            <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">quote</span><span class="p">):</span>
                <span class="n">quota_min</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quote</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">quote</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">quota_max</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quote</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">quote</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                    <span class="n">quota_min</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="n">quota_max</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">==</span> <span class="s1">&#39;de&#39;</span><span class="p">:</span>
                    <span class="n">quota_min</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="n">quota_max</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">quota_min</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="n">quota_max</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="c1"># assegnazione numero di pianta</span>
            <span class="n">resus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">select_us_from_db_sql</span><span class="p">(</span><span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">us</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">)</span>
            <span class="n">elenco_record</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">us</span> <span class="ow">in</span> <span class="n">resus</span><span class="p">:</span>
                <span class="n">elenco_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">us</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">elenco_record</span><span class="p">):</span>
                <span class="n">sing_rec</span> <span class="o">=</span> <span class="n">elenco_record</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">elenco_piante</span> <span class="o">=</span> <span class="n">sing_rec</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">elenco_piante</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">piante</span> <span class="o">=</span> <span class="n">elenco_piante</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                        <span class="n">piante</span> <span class="o">=</span> <span class="s2">&quot;US disegnata su base GIS&quot;</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                        <span class="n">piante</span> <span class="o">=</span> <span class="s2">&quot;SE im GIS gezeichnet&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">piante</span><span class="o">=</span> <span class="s2">&quot;SU draft on GIS&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                    <span class="n">piante</span> <span class="o">=</span> <span class="s2">&quot;US disegnata su base GIS&quot;</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                    <span class="n">piante</span> <span class="o">=</span> <span class="s2">&quot;SE im GIS gezeichnet&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">piante</span><span class="o">=</span> <span class="s2">&quot;SU draft on GIS&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_min_usm</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">quota_min_usm</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_min_usm</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_min_usm</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_max_usm</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">quota_max_usm</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_max_usm</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_max_usm</span><span class="p">)</span>
            <span class="c1">#nuovi campi per Archeo3</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_relativa</span><span class="p">:</span>
                <span class="n">quota_relativa</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># 55</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_relativa</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_relativa</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_abs</span><span class="p">:</span>
                <span class="n">quota_abs</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># 56</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_abs</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_abs</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lunghezza_max</span><span class="p">:</span>
                <span class="n">lunghezza_max</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lunghezza_max</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lunghezza_max</span><span class="p">)</span>  <span class="c1"># 65 lunghezza max</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">altezza_max</span><span class="p">:</span>
                <span class="n">altezza_max</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">altezza_max</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">altezza_max</span><span class="p">)</span>  <span class="c1"># 66 altezza max</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">altezza_min</span><span class="p">:</span>
                <span class="n">altezza_min</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">altezza_min</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">altezza_min</span><span class="p">)</span>  <span class="c1"># 67 altezza min</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">profondita_max</span><span class="p">:</span>
                <span class="n">profondita_max</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">profondita_max</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">profondita_max</span><span class="p">)</span>  <span class="c1"># 68 profondita_max</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">profondita_min</span><span class="p">:</span>
                <span class="n">profondita_min</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">profondita_min</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">profondita_min</span><span class="p">)</span>  <span class="c1"># 69 profondita min</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">larghezza_media</span><span class="p">:</span>
                <span class="n">larghezza_media</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">larghezza_media</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">larghezza_media</span><span class="p">)</span>  <span class="c1"># 70 larghezza media</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_max_abs</span><span class="p">:</span>
                <span class="n">quota_max_abs</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_max_abs</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_max_abs</span><span class="p">)</span>  <span class="c1"># 71 quota_max_abs</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_max_rel</span><span class="p">:</span>
                <span class="n">quota_max_rel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_max_rel</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_max_rel</span><span class="p">)</span>  <span class="c1"># 72 quota_max_rel</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_min_abs</span><span class="p">:</span>
                <span class="n">quota_min_abs</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_min_abs</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_min_abs</span><span class="p">)</span>  <span class="c1"># 73 quota_min_abs</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_min_rel</span><span class="p">:</span>
                <span class="n">quota_min_rel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_min_rel</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quota_min_rel</span><span class="p">)</span>  <span class="c1"># 74 quota_min_rel</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lunghezza_usm</span><span class="p">:</span>
                <span class="n">lunghezza_usm</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lunghezza_usm</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lunghezza_usm</span><span class="p">)</span>  <span class="c1"># 85 lunghezza usm</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">altezza_usm</span><span class="p">:</span>
                <span class="n">altezza_usm</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">altezza_usm</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">altezza_usm</span><span class="p">)</span>  <span class="c1"># 86 altezza usm</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spessore_usm</span><span class="p">:</span>
                <span class="n">spessore_usm</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">spessore_usm</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spessore_usm</span><span class="p">)</span>  <span class="c1"># 87 spessore usm</span>
            <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sito</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)),</span>  <span class="c1"># 0 - Sito</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">),</span>  <span class="c1"># 1 - Area</span>
                <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">us</span><span class="p">),</span>  <span class="c1"># 2 - US</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d_stratigrafica</span><span class="p">),</span>  <span class="c1"># 3 - definizione stratigrafica</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d_interpretativa</span><span class="p">),</span>  <span class="c1"># 4 - definizione intepretata</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">descrizione</span><span class="p">),</span>  <span class="c1"># 5 - descrizione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interpretazione</span><span class="p">),</span>  <span class="c1"># 6 - interpretazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">periodo_iniziale</span><span class="p">),</span>  <span class="c1"># 7 - periodo iniziale</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fase_iniziale</span><span class="p">),</span>  <span class="c1"># 8 - fase iniziale</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">periodo_finale</span><span class="p">),</span>  <span class="c1"># 9 - periodo finale iniziale</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fase_finale</span><span class="p">),</span>  <span class="c1"># 10 - fase finale</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scavato</span><span class="p">),</span>  <span class="c1"># 11 - scavato</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">attivita</span><span class="p">),</span>  <span class="c1"># 12 - attivita</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">anno_scavo</span><span class="p">),</span>  <span class="c1"># 13 - anno scavo</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">metodo_di_scavo</span><span class="p">),</span>  <span class="c1"># 14 - metodo</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">inclusi</span><span class="p">),</span>  <span class="c1"># 15 - inclusi</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">campioni</span><span class="p">),</span>  <span class="c1"># 16 - campioni</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">rapporti</span><span class="p">),</span>            <span class="c1"># 17 - rapporti</span>
                <span class="c1">#str(self.DATA_LIST[i].organici),  # organici</span>
                <span class="c1">#str(self.DATA_LIST[i].inorganici),  # inorganici</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">data_schedatura</span><span class="p">),</span>  <span class="c1"># 18 - data schedatura</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">schedatore</span><span class="p">),</span>  <span class="c1"># 19 - schedatore</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">formazione</span><span class="p">),</span>  <span class="c1"># 20 - formazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">stato_di_conservazione</span><span class="p">),</span>  <span class="c1"># 21 - conservazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">colore</span><span class="p">),</span>  <span class="c1"># 22 - colore</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">consistenza</span><span class="p">),</span>  <span class="c1"># 23 - consistenza</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">struttura</span><span class="p">),</span>  <span class="c1"># 24 - struttura</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">quota_min</span><span class="p">),</span>  <span class="c1"># 25 - quota_min</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">quota_max</span><span class="p">),</span>  <span class="c1"># 26 - quota_max</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">piante</span><span class="p">),</span>  <span class="c1"># 27 - piante CAMPO RICAVATO DA GIS CON VALORI SI/NO</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">documentazione</span><span class="p">),</span>  <span class="c1"># 28 - documentazione</span>
                <span class="c1">#campi USM</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">unita_tipo</span><span class="p">),</span>  <span class="c1"># 29 - unita tipo</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">settore</span><span class="p">),</span>  <span class="c1"># 30 - settore</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quad_par</span><span class="p">),</span>  <span class="c1"># 31 quadrato</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ambient</span><span class="p">),</span>  <span class="c1"># 32 ambiente</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">saggio</span><span class="p">),</span>  <span class="c1"># 33 saggio</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elem_datanti</span><span class="p">),</span>  <span class="c1"># 34 - elem_datanti</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">funz_statica</span><span class="p">),</span>  <span class="c1"># 35 - funz_statica</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lavorazione</span><span class="p">),</span>  <span class="c1"># 36 lavorazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spess_giunti</span><span class="p">),</span>  <span class="c1"># 37 spess_giunti</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">letti_posa</span><span class="p">),</span>            <span class="c1">#38 letti posa</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">alt_mod</span><span class="p">),</span>               <span class="c1">#39  al modulo</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">un_ed_riass</span><span class="p">),</span>           <span class="c1">#40 unita edilizia riassuntiva</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reimp</span><span class="p">),</span>                 <span class="c1">#41 reimpiego</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">posa_opera</span><span class="p">),</span>            <span class="c1">#42 posa opera</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">quota_min_usm</span><span class="p">),</span>                           <span class="c1">#43 quota min usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">quota_max_usm</span><span class="p">),</span>                           <span class="c1">#44 quota max usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cons_legante</span><span class="p">),</span>          <span class="c1">#45 cons legante</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">col_legante</span><span class="p">),</span>           <span class="c1">#46 col legante</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">aggreg_legante</span><span class="p">),</span>        <span class="c1">#47 aggreg legante</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">con_text_mat</span><span class="p">),</span>          <span class="c1">#48  con text mat</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">col_materiale</span><span class="p">),</span>         <span class="c1">#49  col materiale</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">inclusi_materiali_usm</span><span class="p">),</span>  <span class="c1">#50 inclusi materili usm</span>
                <span class="c1">#NUOVI CAMPI PER ARCHEO3</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_catalogo_generale</span><span class="p">),</span>  <span class="c1"># 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_catalogo_interno</span><span class="p">),</span>  <span class="c1"># 52 nr catalogo interno</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_catalogo_internazionale</span><span class="p">),</span>  <span class="c1"># 53 nr catalogo internazionale</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">soprintendenza</span><span class="p">),</span>  <span class="c1"># 54 nr soprintendenza</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">quota_relativa</span><span class="p">),</span> <span class="c1">#55 quota relativa</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">quota_abs</span><span class="p">),</span>   <span class="c1">#56 quota assoluta</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ref_tm</span><span class="p">),</span>  <span class="c1"># 57 ref tm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ref_ra</span><span class="p">),</span>  <span class="c1"># 58 ref ra</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ref_n</span><span class="p">),</span>  <span class="c1"># 59 ref n</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">posizione</span><span class="p">),</span>  <span class="c1"># 60 posizione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">criteri_distinzione</span><span class="p">),</span>  <span class="c1">#61 criteri distinzione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">modo_formazione</span><span class="p">),</span>  <span class="c1"># 62 modo formazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">componenti_organici</span><span class="p">),</span>  <span class="c1"># 63 componenti organici</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">componenti_inorganici</span><span class="p">),</span>  <span class="c1"># 64 #  componenti inorganici</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">lunghezza_max</span><span class="p">),</span> <span class="c1">#65 lunghezza max</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">altezza_max</span><span class="p">),</span> <span class="c1">#66 altezza max</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">altezza_min</span><span class="p">),</span>  <span class="c1">#67 altezza min</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">profondita_max</span><span class="p">),</span>  <span class="c1">#68 profondita max</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">profondita_min</span><span class="p">),</span>  <span class="c1">#69 profondita min</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">larghezza_media</span><span class="p">),</span>  <span class="c1">#70 larghezza media</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">quota_max_abs</span><span class="p">),</span>   <span class="c1">#71 quota max assoluta</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">quota_max_rel</span><span class="p">),</span>   <span class="c1">#72 quota max rel</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">quota_min_abs</span><span class="p">),</span>   <span class="c1">#73 quota min assoluta</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">quota_min_rel</span><span class="p">),</span>   <span class="c1">#74 quota min relativa</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">osservazioni</span><span class="p">),</span>  <span class="c1"># 75 osservazioni</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">datazione</span><span class="p">),</span> <span class="c1"># 76 datazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">flottazione</span><span class="p">),</span>  <span class="c1"># 77 flottazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setacciatura</span><span class="p">),</span>  <span class="c1"># 78 setacciatura</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">affidabilita</span><span class="p">),</span>  <span class="c1"># 79 affidabilita</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">direttore_us</span><span class="p">),</span>  <span class="c1"># 80 direttore us</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">responsabile_us</span><span class="p">),</span>  <span class="c1"># 81 responsabile us</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cod_ente_schedatore</span><span class="p">),</span>  <span class="c1"># 82 cod ente schedatore</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">data_rilevazione</span><span class="p">),</span>  <span class="c1"># 83 data rilevazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">data_rielaborazione</span><span class="p">),</span>  <span class="c1"># 84 data rielaborazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">lunghezza_usm</span><span class="p">),</span> <span class="c1">#85 lunghezza usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">altezza_usm</span><span class="p">),</span>  <span class="c1">#86 altezza usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">spessore_usm</span><span class="p">),</span>  <span class="c1">#87 spessore usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tecnica_muraria_usm</span><span class="p">),</span>  <span class="c1"># 88 tecnica muraria usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">modulo_usm</span><span class="p">),</span>  <span class="c1"># 89 modulo usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">campioni_malta_usm</span><span class="p">),</span>  <span class="c1"># 90 campioni malta usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">campioni_mattone_usm</span><span class="p">),</span>  <span class="c1"># 91 campioni mattone usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">campioni_pietra_usm</span><span class="p">),</span>  <span class="c1"># 92 campioni pietra usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">provenienza_materiali_usm</span><span class="p">),</span>  <span class="c1"># 93 provenienza_materiali_usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">criteri_distinzione_usm</span><span class="p">),</span>  <span class="c1"># 94 criteri distinzione usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">uso_primario_usm</span><span class="p">),</span>  <span class="c1">#95 uso primario</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tipologia_opera</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sezione_muraria</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">superficie_analizzata</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">orientamento</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">materiali_lat</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lavorazione_lat</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">consistenza_lat</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">forma_lat</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">colore_lat</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">impasto_lat</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">forma_p</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">colore_p</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">taglio_p</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">posa_opera_p</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">inerti_usm</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tipo_legante_usm</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">rifinitura_usm</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">materiale_p</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">consistenza_p</span><span class="p">),</span>
            <span class="p">])</span>
        <span class="k">return</span> <span class="n">data_list</span>
    <span class="k">def</span> <span class="nf">on_pushButton_exp_tavole_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">()</span>
        <span class="n">conn_str</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">conn_str</span><span class="p">()</span>
        <span class="c1"># QMessageBox.warning(self, &quot;Messaggio&quot;, str(conn_str), QMessageBox.Ok)</span>
        <span class="n">PU</span> <span class="o">=</span> <span class="n">Print_utility</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
        <span class="n">PU</span><span class="o">.</span><span class="n">progressBarUpdated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">updateProgressBar</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">conn_str</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;postgresql&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">PU</span><span class="o">.</span><span class="n">first_batch_try</span><span class="p">(</span><span class="s2">&quot;postgres&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">PU</span><span class="o">.</span><span class="n">first_batch_try</span><span class="p">(</span><span class="s2">&quot;sqlite&quot;</span><span class="p">)</span>
    <span class="nd">@pyqtSlot</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">updateProgressBar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tav</span><span class="p">,</span> <span class="n">tot</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">tav</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">tot</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progressBar</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="c1"># text = &#39; di &#39;.join([str(tav), str(tot)])</span>
        <span class="c1"># self.countLabel.setText(text)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_print_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_s_us</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">US_pdf_sheet</span> <span class="o">=</span> <span class="n">generate_US_pdf</span><span class="p">()</span>
                <span class="n">data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_list_pdf</span><span class="p">()</span>
                <span class="n">US_pdf_sheet</span><span class="o">.</span><span class="n">build_US_sheets</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Ok&#39;</span><span class="p">,</span><span class="s2">&quot;Esportazione terminata Schede US&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_e_us</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="p">:</span>
                <span class="n">US_index_pdf</span> <span class="o">=</span> <span class="n">generate_US_pdf</span><span class="p">()</span>
                <span class="n">data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_list_pdf</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">data_list</span><span class="p">):</span>
                        <span class="n">US_index_pdf</span><span class="o">.</span><span class="n">build_index_US</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Ok&#39;</span><span class="p">,</span><span class="s2">&quot;Esportazione terminata Elenco US&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ATTENZIONE&#39;</span><span class="p">,</span><span class="s2">&quot;L&#39;elenco US non pu√≤ essere esportato devi riempire prima le schede US&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span> <span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ATTENZIONE&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_e_foto_t</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">US_index_pdf</span> <span class="o">=</span> <span class="n">generate_US_pdf</span><span class="p">()</span>
                <span class="n">data_list_foto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_list_foto</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">data_list_foto</span><span class="p">):</span>
                            <span class="n">US_index_pdf</span><span class="o">.</span><span class="n">build_index_Foto</span><span class="p">(</span><span class="n">data_list_foto</span><span class="p">,</span> <span class="n">data_list_foto</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Ok&#39;</span><span class="p">,</span><span class="s2">&quot;Esportazione terminata Elenco Foto&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ATTENZIONE&#39;</span><span class="p">,</span><span class="s2">&quot;L&#39;elenco foto non pu√≤ essere esportato perch√® non hai immagini taggate.&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span> <span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ATTENZIONE&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_e_foto</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">US_index_pdf</span> <span class="o">=</span> <span class="n">generate_US_pdf</span><span class="p">()</span>
                <span class="n">data_list_foto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_list_foto</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">data_list_foto</span><span class="p">):</span>
                            <span class="n">US_index_pdf</span><span class="o">.</span><span class="n">build_index_Foto_2</span><span class="p">(</span><span class="n">data_list_foto</span><span class="p">,</span> <span class="n">data_list_foto</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Ok&#39;</span><span class="p">,</span><span class="s2">&quot;Esportazione terminata Elenco Foto senza thumbanil&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ATTENZIONE&#39;</span><span class="p">,</span><span class="s2">&quot;L&#39;elenco foto non pu√≤ essere esportato perch√® non hai immagini taggate.&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span> <span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ATTENZIONE&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;en&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_s_us</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">US_pdf_sheet</span> <span class="o">=</span> <span class="n">generate_US_pdf</span><span class="p">()</span>
                <span class="n">data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_list_pdf</span><span class="p">()</span>
                <span class="n">US_pdf_sheet</span><span class="o">.</span><span class="n">build_US_sheets_en</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Ok&#39;</span><span class="p">,</span><span class="s2">&quot;Export finished SU Forms&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_e_us</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="p">:</span>
                <span class="n">US_index_pdf</span> <span class="o">=</span> <span class="n">generate_US_pdf</span><span class="p">()</span>
                <span class="n">data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_list_pdf</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">data_list</span><span class="p">):</span>
                        <span class="n">US_index_pdf</span><span class="o">.</span><span class="n">build_index_US_en</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Ok&#39;</span><span class="p">,</span><span class="s2">&quot;Export finished SU List&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">,</span><span class="s2">&quot;The SU list cannot be exported you have to fill in the SU tabs first&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span> <span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_e_foto_t</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">US_index_pdf</span> <span class="o">=</span> <span class="n">generate_US_pdf</span><span class="p">()</span>
                <span class="n">data_list_foto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_list_foto</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">data_list_foto</span><span class="p">):</span>
                            <span class="n">US_index_pdf</span><span class="o">.</span><span class="n">build_index_Foto_en</span><span class="p">(</span><span class="n">data_list_foto</span><span class="p">,</span> <span class="n">data_list_foto</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Ok&#39;</span><span class="p">,</span><span class="s2">&quot;Export finished SU List&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="s1">&#39;The photo list cannot be exported because you do not have tagged images.&#39;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span> <span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_e_foto</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">US_index_pdf</span> <span class="o">=</span> <span class="n">generate_US_pdf</span><span class="p">()</span>
                <span class="n">data_list_foto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_list_foto</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">data_list_foto</span><span class="p">):</span>
                            <span class="n">US_index_pdf</span><span class="o">.</span><span class="n">build_index_Foto_2_en</span><span class="p">(</span><span class="n">data_list_foto</span><span class="p">,</span> <span class="n">data_list_foto</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Ok&#39;</span><span class="p">,</span> <span class="s2">&quot;Export finished Photo List without thumbanil&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="s2">&quot;The photo list cannot be exported because you do not have tagged images.&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span> <span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_s_us</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">US_pdf_sheet</span> <span class="o">=</span> <span class="n">generate_US_pdf</span><span class="p">()</span>
                <span class="n">data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_list_pdf</span><span class="p">()</span>
                <span class="n">US_pdf_sheet</span><span class="o">.</span><span class="n">build_US_sheets_de</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Okay&quot;</span><span class="p">,</span> <span class="s2">&quot;Export beendet&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_e_us</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="p">:</span>
                <span class="n">US_index_pdf</span> <span class="o">=</span> <span class="n">generate_US_pdf</span><span class="p">()</span>
                <span class="n">data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_list_pdf</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">data_list</span><span class="p">):</span>
                        <span class="n">US_index_pdf</span><span class="o">.</span><span class="n">build_index_US_de</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Okay&quot;</span><span class="p">,</span> <span class="s2">&quot;Export beendet&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNUNG&#39;</span><span class="p">,</span> <span class="s1">&#39;Die SE-Liste kann nicht exportiert werden, Sie m√ºssen zuerst die SE-Formulare ausf√ºllen&#39;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span> <span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNUNG&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_e_foto_t</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">US_index_pdf</span> <span class="o">=</span> <span class="n">generate_US_pdf</span><span class="p">()</span>
                <span class="n">data_list_foto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_list_foto</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">data_list_foto</span><span class="p">):</span>
                            <span class="n">US_index_pdf</span><span class="o">.</span><span class="n">build_index_Foto_de</span><span class="p">(</span><span class="n">data_list_foto</span><span class="p">,</span> <span class="n">data_list_foto</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Okay&quot;</span><span class="p">,</span> <span class="s2">&quot;Fertige Fotoliste exportieren&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNUNG&#39;</span><span class="p">,</span> <span class="s1">&#39;Die Fotoliste kann nicht exportiert werden, da Sie keine markierten Bilder haben.&#39;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span> <span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNUNG&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_e_foto</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">US_index_pdf</span> <span class="o">=</span> <span class="n">generate_US_pdf</span><span class="p">()</span>
                <span class="n">data_list_foto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_list_foto</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">data_list_foto</span><span class="p">):</span>
                            <span class="n">US_index_pdf</span><span class="o">.</span><span class="n">build_index_Foto_2_de</span><span class="p">(</span><span class="n">data_list_foto</span><span class="p">,</span> <span class="n">data_list_foto</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Ok&#39;</span><span class="p">,</span> <span class="s1">&#39;Fertige Fotoliste ohne Daumenballen exportieren&#39;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNUNG&#39;</span><span class="p">,</span> <span class="s1">&#39;Die Fotoliste kann nicht exportiert werden, da Sie keine markierten Bilder haben.&#39;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span> <span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNUNG&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setPathpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">QgsSettings</span><span class="p">()</span>
        <span class="n">dbpath</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;Set file name&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PDFFOLDER</span><span class="p">,</span>
            <span class="s2">&quot; PDF (*.pdf)&quot;</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1">#filename=dbpath.split(&quot;/&quot;)[-1]</span>
        <span class="k">if</span> <span class="n">dbpath</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_pdf_path</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">dbpath</span><span class="p">)</span>
            <span class="n">s</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">dbpath</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_convert_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># if not bool(self.setPathpdf()):</span>
            <span class="c1"># QMessageBox.warning(self, &quot;INFO&quot;, &quot;devi scegliere un file pdf&quot;,</span>
                                <span class="c1"># QMessageBox.Ok)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pdf_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_pdf_path</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">pdf_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">docx_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PDFFOLDER</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.docx&#39;</span>
            <span class="c1"># convert pdf to docx</span>
            <span class="n">parse</span><span class="p">(</span><span class="n">pdf_file</span><span class="p">,</span> <span class="n">docx_file</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_pag1</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="n">end</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_pag2</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>

            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;INFO&quot;</span><span class="p">,</span> <span class="s2">&quot;Conversion completed&quot;</span><span class="p">,</span>
                                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setPathdot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">QgsSettings</span><span class="p">()</span>
        <span class="n">dbpath</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;Set file name&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MATRIX_PATH</span><span class="p">,</span>
            <span class="s2">&quot; Dot (*.dot)&quot;</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1">#filename=dbpath.split(&quot;/&quot;)[-1]</span>
        <span class="k">if</span> <span class="n">dbpath</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_input</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">dbpath</span><span class="p">)</span>
            <span class="n">s</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">dbpath</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setPathgraphml</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">QgsSettings</span><span class="p">()</span>
        <span class="n">dbpath</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;Set file name&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MATRIX_PATH</span><span class="p">,</span>
            <span class="s2">&quot; Graphml (*.graphml)&quot;</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1">#filename=dbpath.split(&quot;/&quot;)[-1]</span>
        <span class="k">if</span> <span class="n">dbpath</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_output</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">dbpath</span><span class="p">)</span>
            <span class="n">s</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">dbpath</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setDoc_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">QgsSettings</span><span class="p">()</span>
        <span class="n">dbpath</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;Set file name&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MATRIX_PATH</span><span class="p">,</span>
            <span class="s2">&quot; All files (*.*)&quot;</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">filename</span><span class="o">=</span><span class="n">dbpath</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">dbpath</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mQgsFileWidget</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;DosCo</span><span class="se">\\</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">s</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">dbpath</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">list2pipe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="n">lista</span> <span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;], [&#39;</span>  <span class="ow">and</span> <span class="s1">&#39;, &#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>

            <span class="k">return</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&#39;Copre&#39;,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&#39;Coperto da&#39;,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&#39;Riempie&#39;,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&#39;Riempito da&#39;,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&#39;Taglia&#39;,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&#39;Tagliato da&#39;,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&#39;Si appoggia a&#39;,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&#39;Gli si appoggia&#39;,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&#39;Si lega a&#39;,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&#39;Uguale a&#39;,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Copre,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Coperto da,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Riempie,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Riempito da,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Taglia,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Tagliato da,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Si appoggia a,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Gli si appoggia,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Si lega a,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Uguale a,&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>


        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
    <span class="k">def</span> <span class="nf">on_pushButton_graphml_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># if not bool(self.setPathpdf()):</span>
            <span class="c1"># QMessageBox.warning(self, &quot;INFO&quot;, &quot;devi scegliere un file pdf&quot;,</span>
                                <span class="c1"># QMessageBox.Ok)</span>

        <span class="n">dottoxml</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BIN</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;dottoxml.py&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">input_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_input</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_output</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

            <span class="n">python_path</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exec_prefix</span>
            <span class="n">python_version</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;Windows&#39;</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">\python&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">python_path</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;Darwin&#39;</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/bin/python</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">python_path</span><span class="p">,</span> <span class="n">python_version</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/bin/python</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">python_path</span><span class="p">,</span> <span class="n">python_version</span><span class="p">)</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="n">dottoxml</span><span class="p">,</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="s1">&#39;Graphml&#39;</span><span class="p">,</span><span class="n">input_file</span><span class="p">,</span> <span class="n">output_file</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span> <span class="p">:</span>
                <span class="n">filedata</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

                <span class="c1"># Replace the target string</span>
                <span class="n">filedata</span> <span class="o">=</span> <span class="n">filedata</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;b&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">filedata</span> <span class="o">=</span> <span class="n">filedata</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;graphml&gt;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;graphml&gt;&#39;</span><span class="p">)</span>
                <span class="c1"># Write the file out again</span>


            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>

                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filedata</span><span class="p">)</span>


            <span class="n">sito_location</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="n">cfg_rel_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;pyarchinit_DB_folder&#39;</span><span class="p">,</span> <span class="s1">&#39;config.cfg&#39;</span><span class="p">)</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HOME</span><span class="p">,</span> <span class="n">cfg_rel_path</span><span class="p">)</span>
            <span class="n">conf</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">set_configuration</span><span class="p">()</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="n">db_username</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">USER</span>
            <span class="n">host</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">HOST</span>
            <span class="n">port</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">PORT</span>
            <span class="n">database_password</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">PASSWORD</span>
            <span class="n">db_names</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">DATABASE</span>
            <span class="n">server</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">SERVER</span>

            <span class="k">if</span> <span class="n">server</span><span class="o">==</span><span class="s1">&#39;postgres&#39;</span><span class="p">:</span>
                <span class="n">connessione</span> <span class="o">=</span><span class="s2">&quot;dbname=</span><span class="si">%s</span><span class="s2"> user=</span><span class="si">%s</span><span class="s2"> host=</span><span class="si">%s</span><span class="s2"> password=</span><span class="si">%s</span><span class="s2"> port=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_names</span><span class="p">,</span><span class="n">db_username</span><span class="p">,</span><span class="n">host</span><span class="p">,</span><span class="n">database_password</span><span class="p">,</span><span class="n">port</span><span class="p">)</span>


                <span class="n">conn</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">connessione</span><span class="p">)</span>
                <span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
                <span class="c1"># WITH RECURSIVE cte AS (</span>
                  <span class="c1"># SELECT id,</span>
                         <span class="c1"># SUBSTR(test, 1, STRPOS(test || &#39;;&#39;, &#39;;&#39;) - 1) col,</span>
                         <span class="c1"># SUBSTR(test, STRPOS(test || &#39;;&#39;, &#39;;&#39;) + 1) rest</span>
                  <span class="c1"># FROM (SELECT id, REPLACE(REPLACE(REPLACE(test, &#39;[[&#39;, &#39;[&#39;), &#39;]]&#39;, &#39;]&#39;), &#39;],[&#39;, &#39;];[&#39;) test FROM tablename) t</span>
                  <span class="c1"># UNION ALL</span>
                  <span class="c1"># SELECT id,</span>
                         <span class="c1"># SUBSTR(rest, 1, STRPOS(rest || &#39;;&#39;, &#39;;&#39;) - 1),</span>
                         <span class="c1"># SUBSTR(rest, STRPOS(rest || &#39;;&#39;, &#39;;&#39;) + 1)</span>
                  <span class="c1"># FROM cte</span>
                  <span class="c1"># WHERE LENGTH(rest) &gt; 0</span>
                <span class="c1"># )</span>
                <span class="c1"># SELECT STRING_AGG(CASE WHEN col LIKE &#39;[&#39;&#39;a&#39;&#39;,%&#39; OR col LIKE &#39;[&#39;&#39;b&#39;&#39;,%&#39; THEN col END, &#39;,&#39;) x,</span>
                       <span class="c1"># STRING_AGG(CASE WHEN col LIKE &#39;[&#39;&#39;c&#39;&#39;,%&#39; THEN col END, &#39;,&#39;) y,</span>
                       <span class="c1"># STRING_AGG(CASE WHEN col LIKE &#39;[&#39;&#39;d&#39;&#39;,%&#39; THEN col END, &#39;,&#39;) z</span>
                <span class="c1"># FROM cte</span>
                <span class="c1"># GROUP BY id</span>

            <span class="k">elif</span> <span class="n">server</span><span class="o">==</span><span class="s1">&#39;sqlite&#39;</span><span class="p">:</span>


                <span class="n">sqlite_DB_path</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HOME</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span><span class="s2">&quot;pyarchinit_DB_folder&quot;</span><span class="p">)</span>

                <span class="n">file_path_sqlite</span> <span class="o">=</span> <span class="n">sqlite_DB_path</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">db_names</span>
                <span class="n">conn</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">file_path_sqlite</span><span class="p">)</span>
                <span class="n">conn</span><span class="o">.</span><span class="n">enable_load_extension</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>


                <span class="c1">#now we can load the extension</span>
                <span class="c1"># depending on your OS and sqlite/spatialite version you might need to add</span>
                <span class="c1"># &#39;.so&#39; (Linux) or &#39;.dll&#39; (Windows) to the extension name</span>

                <span class="c1">#mod_spatialite (recommended)</span>
                <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT load_extension(&quot;mod_spatialite&quot;)&#39;</span><span class="p">)</span>
                <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT InitSpatialMetaData(1);&#39;</span><span class="p">)</span>
                <span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
                <span class="n">cur2</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

                <span class="n">name_</span><span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sito_location</span><span class="o">+</span><span class="s1">&#39;_&#39;</span> <span class="o">+</span>  <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">_&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.xlsx&#39;</span><span class="p">)</span>
                <span class="n">dump_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MATRIX_PATH</span><span class="p">,</span> <span class="n">name_</span><span class="p">)</span>
                <span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">dump_dir</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>
                <span class="n">workbook</span>  <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>


                <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT  area, us, attivita,datazione From us_table where sito=&#39;</span><span class="si">%s</span><span class="s2">&#39; order by rowid;&quot;</span> <span class="o">%</span> <span class="n">sito_location</span><span class="p">)</span>
                <span class="n">rows1</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="n">col_names1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Area&#39;</span><span class="p">,</span><span class="s1">&#39;US&#39;</span><span class="p">,</span><span class="s1">&#39;Attivit√†&#39;</span><span class="p">,</span><span class="s1">&#39;Epoca&#39;</span><span class="p">]</span>
                <span class="n">t1</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows1</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">col_names1</span><span class="p">)</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list2pipe</span><span class="p">)</span>
                <span class="n">t1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;US&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="n">cur2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;WITH cte AS </span>
<span class="s2">                    (   SELECT rowid ,</span>
<span class="s2">                   SUBSTR(rapporti,  1, INSTR(rapporti || &#39;;&#39;, &#39;;&#39;) -1) col,</span>
<span class="s2">                   SUBSTR(rapporti, INSTR(rapporti || &#39;;&#39;, &#39;;&#39;) + 1) rest</span>
<span class="s2">                   FROM (SELECT rowid, REPLACE(REPLACE(REPLACE(rapporti, &#39;[[&#39;, &#39;[&#39;), &#39;]]&#39;, &#39;]&#39;), &#39;], [&#39;, &#39;];[&#39;) rapporti FROM us_table</span>
<span class="s2">                   WHERE sito = &quot;&quot;&quot;</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">sito_location</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="s2">&quot;&quot;&quot;)</span>
<span class="s2">                   UNION all</span>
<span class="s2">                   SELECT rowid us,</span>
<span class="s2">                   SUBSTR(rest, 1, INSTR(rest || &#39;;&#39;, &#39;;&#39;)  -1),</span>
<span class="s2">                   SUBSTR(rest, INSTR(rest || &#39;;&#39;, &#39;;&#39;) + 1)   FROM cte   WHERE LENGTH(rest) &gt; 0 )</span>
<span class="s2">                   SELECT </span>
<span class="s2">                   GROUP_CONCAT(CASE WHEN col LIKE &#39;[&#39;&#39;Copre&#39;&#39;,%&#39; OR col LIKE &#39;[&#39;&#39;Taglia&#39;&#39;,%&#39;</span>
<span class="s2">                   OR col LIKE &#39;[&#39;&#39;Riempie&#39;&#39;,%&#39; OR col LIKE &#39;[&#39;&#39;Si appoggia a&#39;&#39;,%&#39;  THEN col END) post,</span>
<span class="s2">                   </span>
<span class="s2">                   GROUP_CONCAT(CASE WHEN col LIKE &#39;[&#39;&#39;Coperto da&#39;&#39;,%&#39; OR col LIKE &#39;[&#39;&#39;Riempito da&#39;&#39;,%&#39;</span>
<span class="s2">                   OR col LIKE &#39;[&#39;&#39;Tagliato da&#39;&#39;,%&#39; OR col LIKE &#39;[&#39;&#39;Gli si appoggia&#39;&#39;,%&#39; THEN col END) ante,</span>
<span class="s2">                   </span>
<span class="s2">                   GROUP_CONCAT(CASE WHEN col LIKE &#39;[&#39;&#39;Si lega a&#39;&#39;,%&#39; or col LIKE &#39;[&#39;&#39;Uguale a&#39;&#39;,%&#39; THEN col END) contemp</span>
<span class="s2">            </span>
<span class="s2">                    FROM cte GROUP BY rowid order by rowid&quot;&quot;&quot;</span><span class="p">)</span>
                <span class="n">rows2</span> <span class="o">=</span> <span class="n">cur2</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="n">col_names2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Rapporto Posteriore&#39;</span><span class="p">,</span><span class="s1">&#39;Rapporto Anteriore&#39;</span><span class="p">,</span> <span class="s1">&#39;Rapporto Contemporaneo&#39;</span><span class="p">]</span>
                <span class="n">t2</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows2</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">col_names2</span><span class="p">)</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list2pipe</span><span class="p">)</span>
                <span class="n">t2</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Rapporti&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="n">worksheet1</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;US&#39;</span><span class="p">]</span>
                <span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:B&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;D:D&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;E:E&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>


                <span class="n">worksheet2</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;Rapporti&#39;</span><span class="p">]</span>
                <span class="n">worksheet2</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">worksheet2</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:B&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">worksheet2</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;INFO&quot;</span><span class="p">,</span> <span class="s2">&quot;Conversion completed&quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">openpdfDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">HOME</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYARCHINIT_HOME&#39;</span><span class="p">]</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">HOME</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;pyarchinit_PDF_folder&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;xdg-open&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">on_pushButton_export_matrix_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_ED</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

            <span class="n">id_us_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)):</span>
                <span class="n">id_us_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">us</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">id_us</span>

            <span class="n">dlg</span> <span class="o">=</span> <span class="n">pyarchinit_Interactive_Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">,</span> <span class="n">id_us_dict</span><span class="p">)</span>
            <span class="n">data_plot</span><span class="o">=</span><span class="n">dlg</span><span class="o">.</span><span class="n">generate_matrix_2</span><span class="p">()</span>

            <span class="c1"># ###interactive matrix###</span>
            <span class="c1"># matrix_path = &#39;{}{}{}&#39;.format(self.HOME, os.sep, &quot;pyarchinit_Matrix_folder&quot;)</span>
            <span class="c1"># filename=&#39;Harris_matrix2ED_graphml.dot&#39;</span>
            <span class="c1"># hm=os.path.join(matrix_path, filename)</span>
            <span class="c1"># gv = pgv.AGraph(hm, strict=False, directed=False)</span>
            <span class="c1"># dlg.plot_matrix(gv)</span>
            <span class="c1"># dlg.exec_()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_ED</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">id_us_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)):</span>
                <span class="n">id_us_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">us</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">id_us</span>
            <span class="n">dlg</span> <span class="o">=</span> <span class="n">pyarchinit_Interactive_Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">,</span> <span class="n">id_us_dict</span><span class="p">)</span>
            <span class="n">data_plot</span><span class="o">=</span><span class="n">dlg</span><span class="o">.</span><span class="n">generate_matrix</span><span class="p">()</span>

            <span class="c1">###interactive matrix###</span>
        <span class="c1"># if self.checkBox_IM.isChecked():</span>
            <span class="c1"># matrix_path = &#39;{}{}{}&#39;.format(self.HOME, os.sep, &quot;pyarchinit_Matrix_folder&quot;)</span>
            <span class="c1"># filename=&#39;Harris_matrix_tred.dot&#39;</span>
            <span class="c1"># hm=os.path.join(matrix_path, filename)</span>
            <span class="c1"># gv = pgv.AGraph(hm, strict=False, directed=True)</span>
            <span class="c1"># dlg.plot_matrix(gv)</span>
            <span class="c1"># dlg.exec_()</span>
    <span class="k">def</span> <span class="nf">launch_matrix_exp_if</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">msg</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_pushButton_export_matrix_pressed</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">on_pushButton_orderLayers_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># QMessageBox.warning(self, &#39;ATTENZIONE&#39;,</span>
        <span class="c1">#                     &quot;&quot;&quot;Il sistema accetta come dataset da elaborare ricerche su singolo SITO e AREA. Se state lanciando il sistema su siti o aree differenti, i dati di siti differenti saranno sovrascritti. Per terminare il sistema dopo l&#39;Ok premere Cancel.&quot;&quot;&quot;,</span>
        <span class="c1">#                     QMessageBox.Ok)</span>
        <span class="c1"># self.launch_matrix_exp_if(QMessageBox.warning(self, &#39;ATTENZIONE&#39;,</span>
        <span class="c1">#                                               &quot;Si consiglia di lanciare il matrix e controllare se sono presenti paradossi stratigrafici prima di proseguire&quot;,</span>
        <span class="c1">#                                               QMessageBox.Ok | QMessageBox.Cancel))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">launch_order_layer_if</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ATTENZIONE&#39;</span><span class="p">,</span>
                                                       <span class="s2">&quot;Se saranno presenti paradossi stratigrafici l&#39;order layer non andr√† a buon fine&quot;</span><span class="p">,</span>
                                                       <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">launch_order_layer_if</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ACHTUNG&#39;</span><span class="p">,</span>
                                                       <span class="s2">&quot;Bist du sicher das du fortfahren m√∂chtest? Wenn aktuell stratigraphische Paradoxa auftauchen K√∂nnte das System zusammenbrechen!&quot;</span><span class="p">,</span>
                                                       <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">launch_order_layer_if</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ATTENZIONE&#39;</span><span class="p">,</span>
                                                       <span class="s2">&quot;Are you sure you want to go on? If there are stratigraphic paradoxes, the system could crush!&quot;</span><span class="p">,</span>
                                                       <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">launch_order_layer_if</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">msg</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">:</span>
            <span class="c1"># report errori rapporti stratigrafici</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="n">msg_tipo_rapp</span> <span class="o">=</span> <span class="s2">&quot;Manca il tipo di rapporto nell&#39;US: </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">msg_nr_rapp</span> <span class="o">=</span> <span class="s2">&quot;Manca il numero del rapporto nell&#39;US: </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">msg_paradx_rapp</span> <span class="o">=</span> <span class="s2">&quot;Paradosso nei rapporti: </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">msg_us_mancanti</span> <span class="o">=</span> <span class="s2">&quot;Mancano le seguenti schede US presenti nei rapporti: </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="n">msg_tipo_rapp</span> <span class="o">=</span> <span class="s2">&quot;Der Beziehungstyp fehlt in den SE: </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">msg_nr_rapp</span> <span class="o">=</span> <span class="s2">&quot;Die Berichtsnummer fehlt in den SE: </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">msg_paradx_rapp</span> <span class="o">=</span> <span class="s2">&quot;Paradox in Beziehungen: </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">msg_us_mancanti</span> <span class="o">=</span> <span class="s2">&quot;Folgende SE-formular fehlen in den Berichten: </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg_tipo_rapp</span> <span class="o">=</span> <span class="s2">&quot;The relationship type is missing in the SU: </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">msg_nr_rapp</span> <span class="o">=</span> <span class="s2">&quot;The report number is missing in the SU: </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">msg_paradx_rapp</span> <span class="o">=</span> <span class="s2">&quot;Paradox in relationships: </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">msg_us_mancanti</span> <span class="o">=</span> <span class="s2">&quot;The following SU forms are missing from the reports: </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="c1"># report errori rapporti stratigrafici</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Blocca il sistema di ordinamento su un sito ed area specifci in base alla ricerca eseguita sulla scheda US</span>





            <span class="k">for</span> <span class="n">sing_rec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">:</span>
                <span class="n">us</span> <span class="o">=</span> <span class="n">sing_rec</span><span class="o">.</span><span class="n">us</span>
                <span class="n">rapporti_stratigrafici</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">sing_rec</span><span class="o">.</span><span class="n">rapporti</span><span class="p">)</span>
                <span class="c1"># [l.pop(4) for l in rapporti_stratigrafici]</span>
                <span class="c1"># [l.pop(3) for l in rapporti_stratigrafici]</span>
                <span class="c1"># [l.pop(2) for l in rapporti_stratigrafici]</span>

                <span class="k">for</span> <span class="n">sing_rapp</span> <span class="ow">in</span> <span class="n">rapporti_stratigrafici</span><span class="p">:</span>


                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">)</span> <span class="o">!=</span><span class="mi">2</span><span class="p">:</span><span class="c1">##cambiato da 2 a 5</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                            <span class="n">msg_nr_rapp</span> <span class="o">=</span> <span class="n">msg_nr_rapp</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;relativo a: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">us</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                            <span class="n">msg_nr_rapp</span> <span class="o">=</span> <span class="n">msg_nr_rapp</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;bez√ºglich: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">us</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">msg_nr_rapp</span> <span class="o">=</span> <span class="n">msg_nr_rapp</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;concerning: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">us</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cuts&#39;</span> <span class="ow">or</span>  <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Covers&#39;</span> <span class="ow">or</span>  <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Abuts&#39;</span> <span class="ow">or</span>  <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Fills&#39;</span> <span class="ow">or</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Taglia&#39;</span> <span class="ow">or</span>  <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Copre&#39;</span> <span class="ow">or</span>  <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Si appoggia a&#39;</span> <span class="ow">or</span>  <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Riempie&#39;</span>  <span class="ow">or</span>  <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Schneidet&#39;</span> <span class="ow">or</span>  <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Liegt √ºber&#39;</span> <span class="ow">or</span>  <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;St√ºtzt sich auf&#39;</span> <span class="ow">or</span>  <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Verf√ºllt&#39;</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                                    <span class="n">harris_rapp</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                                    <span class="c1">##                                  if harris_rapp== (1, 67):</span>
                                    <span class="c1">##                                      QMessageBox.warning(self, &quot;Messaggio&quot;, &quot;Magagna&quot;, QMessageBox.Ok)</span>
                                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">harris_rapp</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="n">msg_nr_rapp</span> <span class="o">=</span> <span class="n">msg_nr_rapp</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">us</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">msg_tipo_rapp</span> <span class="o">=</span> <span class="n">msg_tipo_rapp</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">us</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">temp_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span>
                    <span class="mi">0</span><span class="p">])</span>  <span class="c1"># controlla che nn vi siano rapporti inversi dentro la lista DA PROBLEMI CON GLI UGUALE A E I SI LEGA A</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Messaggio&quot;, &quot;Temp_tup&quot; + str(temp_tup), QMessageBox.Ok)</span>
                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">temp_tup</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">msg_paradx_rapp</span> <span class="o">=</span> <span class="n">msg_paradx_rapp</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">temp_tup</span><span class="p">)</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="c1"># OK</span>
                    <span class="c1">## QMessageBox.warning(self, &quot;Messaggio&quot;, &quot;DATA LIST&quot; + str(data), QMessageBox.Ok)</span>
                    <span class="c1"># Blocca il sistema di ordinamento su un sito ed area specifci in base alla ricerca eseguita sulla scheda US</span>


            <span class="n">sito</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sito</span>  <span class="c1"># self.comboBox_sito_rappcheck.currentText()</span>
            <span class="n">area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">area</span>  <span class="c1"># self.comboBox_area.currentText()</span>
            <span class="c1"># script order layer from pyqgis</span>
            <span class="n">OL</span> <span class="o">=</span> <span class="n">Order_layer_v2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="p">,</span> <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">)</span>
            <span class="c1"># QMessageBox.warning(None, &quot;Messaggio&quot;, &quot;DATA LIST&quot; + str(OL), QMessageBox.Ok)</span>
            <span class="n">order_layer_dict</span> <span class="o">=</span> <span class="n">OL</span><span class="o">.</span><span class="n">main_order_layer</span><span class="p">()</span>
            <span class="c1">#QMessageBox.warning(None, &quot;Messaggio&quot;, &quot;DATA LIST&quot; + str(order_layer_dict), QMessageBox.Ok)</span>
            <span class="c1"># order_number = &quot;&quot;</span>
            <span class="c1"># us = &quot;&quot;</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">order_layer_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span><span class="c1">#era iteritems prima</span>
                <span class="n">order_number</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="n">us</span> <span class="o">=</span> <span class="n">v</span>
                <span class="c1"># QMessageBox.warning(None, &quot;Messaggio&quot;, &quot;DATA LIST&quot; + str(k)+str(v), QMessageBox.Ok)</span>
                <span class="k">for</span> <span class="n">sing_us</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                    <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sito</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">area</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                   <span class="s1">&#39;us&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_us</span><span class="p">)}</span>
                    <span class="c1">#QMessageBox.warning(None, &quot;Messaggio&quot;, &quot;DATA LIST&quot; + str(search_dict), QMessageBox.Ok)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>  <span class="c1"># carica tutti i dati di uno scavo ordinati per numero di US</span>
                        <span class="c1">#QMessageBox.warning(None, &quot;Messaggio&quot;, &quot;records&quot; + str(records), QMessageBox.Ok)</span>
                        <span class="n">a</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id_us</span><span class="p">)],</span> <span class="p">[</span><span class="s1">&#39;order_layer&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">order_number</span><span class="p">])</span>
                        <span class="c1">#QMessageBox.warning(None, &quot;Messaggio&quot;, &quot;records&quot; + str(a), QMessageBox.Ok)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">on_pushButton_view_all_pressed</span><span class="p">()</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;ACHTUNG&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="c1"># blocco output errori</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="n">filename_tipo_rapporti_mancanti</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REPORT_PATH</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;tipo_rapporti_mancanti.txt&#39;</span><span class="p">)</span>
                <span class="n">filename_nr_rapporti_mancanti</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REPORT_PATH</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;nr_rapporti_mancanti.txt&#39;</span><span class="p">)</span>
                <span class="n">filename_paradosso_rapporti</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REPORT_PATH</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;paradosso_rapporti.txt&#39;</span><span class="p">)</span>
                <span class="n">filename_us_mancanti</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REPORT_PATH</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;us_mancanti.txt&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="n">filename_tipo_rapporti_mancanti</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REPORT_PATH</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;type_missing_relationships.txt&#39;</span><span class="p">)</span>
                <span class="n">filename_nr_rapporti_mancanti</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REPORT_PATH</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;nr_missing relashionships.txt&#39;</span><span class="p">)</span>
                <span class="n">filename_paradosso_rapporti</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REPORT_PATH</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;relashionships_paradox.txt&#39;</span><span class="p">)</span>
                <span class="n">filename_us_mancanti</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REPORT_PATH</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;su_missing.txt&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">filename_tipo_rapporti_mancanti</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REPORT_PATH</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;type_missing_relationships.txt&#39;</span><span class="p">)</span>
                <span class="n">filename_nr_rapporti_mancanti</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REPORT_PATH</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;nr_missing relashionships.txt&#39;</span><span class="p">)</span>
                <span class="n">filename_paradosso_rapporti</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REPORT_PATH</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;relashionships_paradox.txt&#39;</span><span class="p">)</span>
                <span class="n">filename_us_mancanti</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REPORT_PATH</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;su_missing.txt&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testing</span><span class="p">(</span><span class="n">filename_tipo_rapporti_mancanti</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg_tipo_rapp</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testing</span><span class="p">(</span><span class="n">filename_nr_rapporti_mancanti</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg_nr_rapp</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testing</span><span class="p">(</span><span class="n">filename_paradosso_rapporti</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg_paradx_rapp</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testing</span><span class="p">(</span><span class="n">filename_us_mancanti</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg_us_mancanti</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;ATTENZIONE&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Sistema di ordinamento Terminato&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;ACHTUNG&#39;</span><span class="p">,</span> <span class="s2">&quot;Ordnungssystem beendet&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="s2">&quot;Sorting system Complete&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;ATTENZIONE&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Sistema di ordinamento US abortito&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ACHTUNG&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Ordnungssystem verlassen&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="s2">&quot;SU aborted sorting system&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
           <span class="c1"># blocco output errori</span>
    <span class="k">def</span> <span class="nf">on_toolButtonPan_toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolPan</span> <span class="o">=</span> <span class="n">QgsMapToolPan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapPreview</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mapPreview</span><span class="o">.</span><span class="n">setMapTool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolPan</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_showSelectedFeatures_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># field_position = self.pyQGIS.findFieldFrDict(self.ID_TABLE) #ricava la posizione del campo</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">mapCanvas</span><span class="p">()</span><span class="o">.</span><span class="n">currentLayer</span><span class="p">()</span>
            <span class="n">fieldname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">layer</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ATTENZIONE&#39;</span><span class="p">,</span> <span class="s2">&quot;Nessun elemento selezionato&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ACHTUNG&#39;</span><span class="p">,</span> <span class="s2">&quot;keine Elemente ausgew√§hlt&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="s2">&quot;No items selected&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="n">features_list</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">selectedFeatures</span><span class="p">()</span>
            <span class="n">field_position</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">single</span> <span class="ow">in</span> <span class="n">layer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
                <span class="n">field_position</span> <span class="o">=</span> <span class="n">single</span><span class="o">.</span><span class="n">fieldNameIndex</span><span class="p">(</span><span class="n">fieldname</span><span class="p">)</span>
            <span class="n">id_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">features_list</span><span class="p">:</span>
                <span class="n">attr_list</span> <span class="o">=</span> <span class="n">feat</span><span class="o">.</span><span class="n">attributes</span><span class="p">()</span>
                <span class="n">id_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr_list</span><span class="p">[</span><span class="n">field_position</span><span class="p">])</span>
                <span class="c1"># viene impostata la query per il database</span>
            <span class="n">items</span><span class="p">,</span> <span class="n">order_type</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">],</span> <span class="s2">&quot;asc&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">temp_data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_sort</span><span class="p">(</span><span class="n">id_list</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">order_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">us</span> <span class="ow">in</span> <span class="n">temp_data_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">us</span><span class="p">)</span>
                <span class="c1"># vengono riempiti i campi con i dati trovati</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;&lt;type &#39;str&#39;&gt;&quot;</span><span class="p">:</span>
                <span class="n">corr</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">corr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ATTENZIONE&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_pushButton_sort_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_record_state</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dlg</span> <span class="o">=</span> <span class="n">SortPanelMain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">dlg</span><span class="o">.</span><span class="n">insertItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORT_ITEMS</span><span class="p">)</span>
            <span class="n">dlg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
            <span class="n">items</span><span class="p">,</span> <span class="n">order_type</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ITEMS</span><span class="p">,</span> <span class="n">dlg</span><span class="o">.</span><span class="n">TYPE_ORDER</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SORT_ITEMS_CONVERTED</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Messaggio&quot;,i, QMessageBox.Ok)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SORT_ITEMS_CONVERTED</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">CONVERSION_DICT</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>  <span class="c1"># apportare la modifica nellle altre schede</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SORT_MODE</span> <span class="o">=</span> <span class="n">order_type</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
            <span class="n">id_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">:</span>
                <span class="n">id_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;i.&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">temp_data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_sort</span><span class="p">(</span><span class="n">id_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SORT_ITEMS_CONVERTED</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SORT_MODE</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">temp_data_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;&lt;type &#39;str&#39;&gt;&quot;</span><span class="p">:</span>
                <span class="n">corr</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">corr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_toolButtonGis_toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonGis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Messaggio&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Modalita&#39; GIS attiva. Da ora le tue ricerche verranno visualizzate sul GIS&quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Messaggio&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Modalita&#39; GIS disattivata. Da ora le tue ricerche non verranno piu&#39; visualizzate sul GIS&quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonGis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Modalit√§t&#39; GIS aktiv. Von jetzt wird Deine Untersuchung mit Gis visualisiert&quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Modalit√§t&#39; GIS deaktiviert. Von jetzt an wird deine Untersuchung nicht mehr mit Gis visualisiert&quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonGis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;GIS mode active. From now on your searches will be displayed on the GIS&quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;GIS mode disabled. From now on, your searches will no longer be displayed on the GIS.&quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_toolButtonPreview_toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonPreview</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Messaggio&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Modalita&#39; Preview US attivata. Le piante delle US saranno visualizzate nella sezione Piante&quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadMapPreview</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadMapPreview</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonPreview</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Modalit√§t&#39; Preview der aktivierten SE. Die Plana der SE werden in der Auswahl der Plana visualisiert&quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadMapPreview</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadMapPreview</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonPreview</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Preview SU mode enabled. US plants will be displayed in the Plants section&quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadMapPreview</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadMapPreview</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># def on_toolButtonPreviewMedia_toggled(self):</span>
        <span class="c1"># if self.L==&#39;it&#39;:</span>
            <span class="c1"># if self.toolButtonPreviewMedia.isChecked() == True:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Messaggio&quot;,</span>
                                    <span class="c1"># &quot;Modalita&#39; Preview Media US attivata. Le immagini delle US saranno visualizzate nella sezione Media&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
                <span class="c1"># self.loadMediaPreview()</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.loadMediaPreview(1)</span>
        <span class="c1"># elif self.L==&#39;de&#39;:</span>
            <span class="c1"># if self.toolButtonPreviewMedia.isChecked()== True:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># &quot;Modalit√§t&#39; Preview Media SE aktiviert. Die Bilder der SE werden in der Preview media Auswahl visualisiert&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
                <span class="c1"># self.loadMediaPreview()</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.loadMediaPreview(1)</span>
        <span class="c1"># else:</span>
            <span class="c1"># if self.toolButtonPreviewMedia.isChecked()== True:</span>
                <span class="c1"># QMessageBox.warning(self, &quot;Message&quot;,</span>
                                    <span class="c1"># &quot;SU Media Preview mode enabled. US images will be displayed in the Media section&quot;,</span>
                                    <span class="c1"># QMessageBox.Ok)</span>
                <span class="c1"># self.loadMediaPreview()</span>
            <span class="c1"># else:</span>
                <span class="c1"># self.loadMediaPreview(1)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_addRaster_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonGis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">addRasterLayer</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_pushButton_new_rec_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">()</span>

        <span class="n">sito_set</span><span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">sito_set</span><span class="p">()</span>
        <span class="n">sito_set_str</span> <span class="o">=</span> <span class="n">sito_set</span><span class="p">[</span><span class="s1">&#39;sito_set&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_error_check</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="c1"># else:</span>
                <span class="c1"># if self.BROWSE_STATUS == &quot;b&quot;:</span>
                    <span class="c1"># if self.DATA_LIST:</span>
                        <span class="c1"># if self.records_equal_check() == 1:</span>
                            <span class="c1"># if self.L==&#39;it&#39;:</span>
                                <span class="c1"># self.update_if(QMessageBox.warning(self, &#39;Errore&#39;,</span>
                                                                   <span class="c1"># &quot;Il record e&#39; stato modificato. Vuoi salvare le modifiche?&quot;,QMessageBox.Ok | QMessageBox.Cancel))</span>
                            <span class="c1"># elif self.L==&#39;de&#39;:</span>
                                <span class="c1"># self.update_if(QMessageBox.warning(self, &#39;Error&#39;,</span>
                                                                   <span class="c1"># &quot;Der Record wurde ge√§ndert. M√∂chtest du die √Ñnderungen speichern?&quot;,</span>
                                                                   <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel))</span>
                            <span class="c1"># else:</span>
                                <span class="c1"># self.update_if(QMessageBox.warning(self, &#39;Error&#39;,</span>
                                                                   <span class="c1"># &quot;The record has been changed. Do you want to save the changes?&quot;,</span>
                                                                   <span class="c1"># QMessageBox.Ok | QMessageBox.Cancel))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">!=</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="n">sito_set_str</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields_nosite</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_unita_tipo&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.lineEdit_us&quot;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_unita_tipo&quot;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_unita_tipo&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.lineEdit_us&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_unita_tipo&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span><span class="p">])</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">])</span>


            <span class="bp">self</span><span class="o">.</span><span class="n">enable_button</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save_rapp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_error_check</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">records_equal_check</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_if</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">):</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span>


                    <span class="c1"># self.empty_fields()</span>
                    <span class="c1"># self.SORT_STATUS = &quot;n&quot;</span>
                    <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[self.SORT_STATUS])</span>
                    <span class="c1"># self.enable_button(1)</span>

                    <span class="c1"># self.fill_fields(self.REC_CORR)</span>
                <span class="c1"># else:</span>
                    <span class="c1"># if self.L==&#39;it&#39;:</span>
                        <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Non √® stata realizzata alcuna modifica.&quot;, QMessageBox.Ok)</span>
                    <span class="c1"># elif self.L==&#39;de&#39;:</span>
                        <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Keine √Ñnderung vorgenommen&quot;, QMessageBox.Ok)</span>
                    <span class="c1"># else:</span>
                        <span class="c1"># QMessageBox.warning(self, &quot;Warning&quot;, &quot;No changes have been made&quot;, QMessageBox.Ok)</span>
        <span class="c1"># else:</span>
            <span class="c1"># if self.data_error_check() == 0:</span>
                <span class="c1"># test_insert = self.insert_new_rec()</span>
                <span class="c1"># if test_insert == 1:</span>
                    <span class="c1"># self.empty_fields()</span>
                    <span class="c1"># self.SORT_STATUS = &quot;n&quot;</span>
                    <span class="c1"># self.label_sort.setText(self.SORTED_ITEMS[self.SORT_STATUS])</span>
                    <span class="c1"># self.charge_records()</span>
                    <span class="c1"># self.charge_list()</span>
                    <span class="c1"># self.set_sito()</span>
                    <span class="c1"># self.BROWSE_STATUS = &quot;b&quot;</span>
                    <span class="c1"># self.label_status.setText(self.STATUS_ITEMS[self.BROWSE_STATUS])</span>
                    <span class="c1"># self.REC_TOT, self.REC_CORR = len(self.DATA_LIST), len(self.DATA_LIST) - 1</span>
                    <span class="c1"># self.set_rec_counter(self.REC_TOT, self.REC_CORR + 1)</span>
                    <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_sito&quot;], 1)</span>
                    <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_area&quot;], 1)</span>
                    <span class="c1"># self.setComboBoxEditable([&quot;self.comboBox_unita_tipo&quot;], 1)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_sito&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_area&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.lineEdit_us&quot;], &quot;False&quot;)</span>
                    <span class="c1"># self.setComboBoxEnable([&quot;self.comboBox_unita_tipo&quot;], &quot;True&quot;)</span>
                    <span class="c1"># self.fill_fields(self.REC_CORR)</span>
                    <span class="c1"># self.enable_button(1)</span>
            <span class="c1"># else:</span>
                <span class="c1"># if self.L==&#39;it&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Problema nell&#39;inserimento dati&quot;, QMessageBox.Ok)</span>
                <span class="c1"># elif self.L==&#39;de&#39;:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;ACHTUNG&quot;, &quot;Problem der Dateneingabe&quot;, QMessageBox.Ok)</span>
                <span class="c1"># else:</span>
                    <span class="c1"># QMessageBox.warning(self, &quot;Warning&quot;, &quot;Problem with data entry&quot;, QMessageBox.Ok)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_save_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_error_check</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">records_equal_check</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_if</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Errore&#39;</span><span class="p">,</span>
                                                           <span class="s2">&quot;Il record e&#39; stato modificato. Vuoi salvare le modifiche?&quot;</span><span class="p">,</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_if</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span>
                                                           <span class="s2">&quot;Der Record wurde ge√§ndert. M√∂chtest du die √Ñnderungen speichern?&quot;</span><span class="p">,</span>
                                                           <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_if</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span>
                                                           <span class="s2">&quot;The record has been changed. Do you want to save the changes?&quot;</span><span class="p">,</span>
                                                           <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">enable_button</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Non √® stata realizzata alcuna modifica.&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span> <span class="s2">&quot;Keine √Ñnderung vorgenommen&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="s2">&quot;No changes have been made&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_error_check</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">test_insert</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_rec</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">test_insert</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">charge_records</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">charge_list</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_sito</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_unita_tipo&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.lineEdit_us&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_unita_tipo&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">enable_button</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Problema nell&#39;inserimento dati&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span> <span class="s2">&quot;Problem der Dateneingabe&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="s2">&quot;Problem with data entry&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_rapp_check_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sito_check</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito_rappcheck</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="n">area_check</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area_rappcheck</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rapporti_stratigrafici_check</span><span class="p">(</span><span class="n">sito_check</span><span class="p">,</span> <span class="n">area_check</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">def_strati_to_rapporti_stratigrafici_check</span><span class="p">(</span><span class="n">sito_check</span><span class="p">,</span> <span class="n">area_check</span><span class="p">)</span>  <span class="c1"># SPERIMENTALE</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Initial Message&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Messaggio&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Controllo Rapporti Stratigrafici. </span><span class="se">\n</span><span class="s2"> Controllo eseguito con successo&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Pr√ºfen der stratigraphischen Beziehung.  Kontrolle erfolgereich&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Monitoring of stratigraphic relationships. </span><span class="se">\n</span><span class="s2"> Control performed successfully&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_pushButton_h_check_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listWidget_rapp</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">sito_check</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="n">area_check</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">rapporti_stratigrafici_check</span><span class="p">(</span><span class="n">sito_check</span><span class="p">,</span> <span class="n">area_check</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">def_strati_to_rapporti_stratigrafici_check</span><span class="p">(</span><span class="n">sito_check</span><span class="p">,</span> <span class="n">area_check</span><span class="p">)</span>  <span class="c1"># SPERIMENTALE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">periodi_to_rapporti_stratigrafici_check</span><span class="p">(</span><span class="n">sito_check</span><span class="p">,</span> <span class="n">area_check</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">automaticform_check</span><span class="p">(</span><span class="n">sito_check</span><span class="p">,</span> <span class="n">area_check</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">listWidget_rapp</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listWidget_rapp</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Controllo Rapporti Stratigrafici.</span><span class="se">\n</span><span class="s2">Controllo eseguito con successo.&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="n">Qself</span><span class="o">.</span><span class="n">listWidget_rapp</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Pr√ºfen der stratigraphischen Beziehung.  Kontrolle erfolgereich&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">listWidget_rapp</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Monitoring of stratigraphic relationships. </span><span class="se">\n</span><span class="s2"> Control performed successfully&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">data_error_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">test</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">EC</span> <span class="o">=</span> <span class="n">Error_check</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_empty</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Sito. </span><span class="se">\n</span><span class="s2"> Il campo non deve essere vuoto&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_empty</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Area. </span><span class="se">\n</span><span class="s2"> Il campo non deve essere vuoto&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_empty</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo US. </span><span class="se">\n</span><span class="s2"> Il campo non deve essere vuoto&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_empty</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Tipo US/USM. </span><span class="se">\n</span><span class="s2"> Il campo non deve essere vuoto&quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="sd">&quot;&quot;&quot;controllo campi numerici&quot;&quot;&quot;</span>
            <span class="n">area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">us</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">area</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_int</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Area. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">us</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_int</span><span class="p">(</span><span class="n">us</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo US. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="sd">&quot;&quot;&quot;controllo campi numerici float&quot;&quot;&quot;</span>
            <span class="c1">#TAB USM</span>
            <span class="n">spessore_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">qmin_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmin_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">qmax_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmax_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">lunghezza_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">altezza_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="c1">#TAB MISURE</span>
            <span class="n">quota_abs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">quota_relativa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_relativa</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">quota_max_abs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">quota_max_rel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_rel</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">quota_min_abs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">quota_min_rel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_rel</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">larghezza_media</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_larghezza_media</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">lunghezza_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">profondita_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_min</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">profondita_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">altezza_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">altezza_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_min</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">spessore_usm</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">spessore_usm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo USM-Spessore USM. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">qmin_usm</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">qmin_usm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo USM 3-Quota minima USM. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">qmax_usm</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">qmax_usm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo USM 3-Quota max USM. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">lunghezza_usm</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">lunghezza_usm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo USM 3-Lunghezza USM. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">altezza_usm</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">altezza_usm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo USM 3-Altezza USM. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="c1">###########################</span>
            <span class="k">if</span> <span class="n">quota_abs</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">quota_abs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Quota Assoluta. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">quota_relativa</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">quota_relativa</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Quota Relativa. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">quota_max_abs</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">quota_max_abs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Quota Massima Assoluta. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">quota_max_rel</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">quota_max_rel</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Quota Massima Relativa. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">quota_min_abs</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">quota_min_abs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Quota Minima Assoluta. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">quota_min_rel</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">quota_min_rel</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Quota Minima Relativa. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">larghezza_media</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">larghezza_media</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Larghezza Media. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">lunghezza_max</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">lunghezza_max</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Lunghezza Massima. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">profondita_min</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">profondita_min</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Profondit√† Minima. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">profondita_max</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">profondita_max</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Profondit√† Massima. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">altezza_max</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">altezza_max</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Spessore. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">altezza_min</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_float</span><span class="p">(</span><span class="n">altezza_min</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Campo Spessore Minima. </span><span class="se">\n</span><span class="s2"> Il valore deve essere di tipo numerico. </span><span class="se">\n</span><span class="s2"> (Sono stati inserite lettere, virgole, accenti o caratteri non numerici.&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="sd">&quot;&quot;&quot;controllo lunghezza campo alfanumerico&quot;&quot;&quot;</span>
            <span class="n">attivita</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_attivita</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">colore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">anno_scavo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_anno</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">formazione</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_formazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">stato_conservazione</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_conservazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">colore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">consistenza</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">struttura</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_struttura</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">cont_per</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_codice_periodo</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">d_interpretativa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_intepret</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">d_stratigrafica</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_strat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">attivita</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">attivita</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Campo Attivita. </span><span class="se">\n</span><span class="s2"> Il valore non deve superare i 4 caratteri alfanumerici&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="c1"># if anno_scavo != &quot;&quot;:</span>
            <span class="c1"># if EC.data_lenght(anno_scavo,3) == 0:</span>
            <span class="c1">#       QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Anno. \n immettere una sola data (es. 2014)&quot;,  QMessageBox.Ok)</span>
            <span class="c1">#       test = 1</span>

            <span class="k">if</span> <span class="n">formazione</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">d_interpretativa</span><span class="p">,</span> <span class="mi">254</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Campo definizione interpreta. </span><span class="se">\n</span><span class="s2"> Il valore non deve superare i 255 caratteri alfanumerici&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">formazione</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">d_stratigrafica</span><span class="p">,</span> <span class="mi">254</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Campo definizione stratigrafica. </span><span class="se">\n</span><span class="s2"> Il valore non deve superare i 255 caratteri alfanumerici&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">formazione</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">formazione</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Campo Formazione. </span><span class="se">\n</span><span class="s2"> Il valore non deve superare i 20 caratteri alfanumerici&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">stato_conservazione</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">stato_conservazione</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Campo Conservazione. </span><span class="se">\n</span><span class="s2"> Il valore non deve superare i 20 caratteri alfanumerici&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">colore</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">colore</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Campo Colore. </span><span class="se">\n</span><span class="s2"> Il valore non deve superare i 20 caratteri alfanumerici&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">consistenza</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">consistenza</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Campo Consistenza. </span><span class="se">\n</span><span class="s2"> Il valore non deve superare i 20 caratteri alfanumerici&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">struttura</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">struttura</span><span class="p">,</span> <span class="mi">29</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Campo Struttura. </span><span class="se">\n</span><span class="s2"> Il valore non deve superare i 30 caratteri alfanumerici&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_empty</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span> <span class="s2">&quot; Feld Ausgrabungst√§tte. </span><span class="se">\n</span><span class="s2"> Das Feld darf nicht leer sein&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_empty</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span> <span class="s2">&quot;Feld Areal. </span><span class="se">\n</span><span class="s2"> Das Feld darf nicht leer sein&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_empty</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span> <span class="s2">&quot;Feld SE. </span><span class="se">\n</span><span class="s2"> Das Feld darf nicht leer sein&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_empty</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span> <span class="s2">&quot;Feld SE/MSE Typ. </span><span class="se">\n</span><span class="s2"> Das Feld darf nicht leer sein&quot;</span><span class="p">,</span>   <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">us</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">attivita</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_attivita</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">colore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">anno_scavo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_anno</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">formazione</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_formazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">stato_conservazione</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_conservazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">colore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">consistenza</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">struttura</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_struttura</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">cont_per</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_codice_periodo</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">area</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_int</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span> <span class="s2">&quot;Feld Areal. </span><span class="se">\n</span><span class="s2"> Der Wert muss numerisch eingegeben werden&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">us</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_int</span><span class="p">(</span><span class="n">us</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span> <span class="s2">&quot;Feld SE. </span><span class="se">\n</span><span class="s2"> Der Wert muss numerisch eingegeben werden&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">attivita</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">attivita</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Feld aktiviert. </span><span class="se">\n</span><span class="s2"> Der Wert darf nicht mehr als 4 alphanumerische Zeichen enthalten&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="c1"># if anno_scavo != &quot;&quot;:</span>
            <span class="c1"># if EC.data_lenght(anno_scavo,3) == 0:</span>
            <span class="c1">#       QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Anno. \n immettere una sola data (es. 2014)&quot;,  QMessageBox.Ok)</span>
            <span class="c1">#       test = 1</span>
            <span class="k">if</span> <span class="n">formazione</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">formazione</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Feld Bodenart. </span><span class="se">\n</span><span class="s2"> Der Wert darf nicht mehr als 20 alphanumerische Zeichen enthalten&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">stato_conservazione</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">stato_conservazione</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Feld Erhaltungszustand.  Der Wert darf nicht mehr als 20 alphanumerische Zeichen enthalten&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">colore</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">colore</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Feld Farbe. </span><span class="se">\n</span><span class="s2"> Der Wert darf nicht mehr als 20 alphanumerische Zeichen enthalten&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">consistenza</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">consistenza</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Feld Konsistenz. </span><span class="se">\n</span><span class="s2"> Der Wert darf nicht mehr als 20 alphanumerische Zeichen enthalten&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">struttura</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">struttura</span><span class="p">,</span> <span class="mi">29</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Feld Struktur. </span><span class="se">\n</span><span class="s2"> Der Wert darf nicht mehr als 30 alphanumerische Zeichen enthalten&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_empty</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span> <span class="s2">&quot;Site Field. </span><span class="se">\n</span><span class="s2"> The field must not be empty&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_empty</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span> <span class="s2">&quot;Area Field. </span><span class="se">\n</span><span class="s2"> The field must not be empty&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_empty</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span> <span class="s2">&quot;SU Field. </span><span class="se">\n</span><span class="s2"> The field must not be empty&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_empty</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span> <span class="s2">&quot;SU-WSU Field. </span><span class="se">\n</span><span class="s2"> The field must not be empty&quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">us</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">attivita</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_attivita</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">colore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">anno_scavo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_anno</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">formazione</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_formazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">stato_conservazione</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_conservazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">colore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">consistenza</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">struttura</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_struttura</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">cont_per</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_codice_periodo</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">area</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_int</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span> <span class="s2">&quot;Area Field. </span><span class="se">\n</span><span class="s2"> The value must be numerical&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">us</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_is_int</span><span class="p">(</span><span class="n">us</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span> <span class="s2">&quot;SU Field. </span><span class="se">\n</span><span class="s2"> The value must be numerical&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">attivita</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">attivita</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Activity Field. </span><span class="se">\n</span><span class="s2"> The value must not exceed 4 alphanumeric characters&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="c1"># if anno_scavo != &quot;&quot;:</span>
            <span class="c1"># if EC.data_lenght(anno_scavo,3) == 0:</span>
            <span class="c1">#       QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Anno. \n immettere una sola data (es. 2014)&quot;,  QMessageBox.Ok)</span>
            <span class="c1">#       test = 1</span>
            <span class="k">if</span> <span class="n">formazione</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">formazione</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Formation Field. </span><span class="se">\n</span><span class="s2"> The value must not exceed 20 alphanumeric characters&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">stato_conservazione</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">stato_conservazione</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Conservation Field. </span><span class="se">\n</span><span class="s2"> The value must not exceed 20 alphanumeric characters&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">colore</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">colore</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Color Field. </span><span class="se">\n</span><span class="s2"> The value must not exceed 20 alphanumeric characters&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">consistenza</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">consistenza</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Texture Field. </span><span class="se">\n</span><span class="s2"> The value must not exceed 20 alphanumeric characters&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">struttura</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EC</span><span class="o">.</span><span class="n">data_lenght</span><span class="p">(</span><span class="n">struttura</span><span class="p">,</span> <span class="mi">29</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Structure Field. </span><span class="se">\n</span><span class="s2"> The value must not exceed 20 alphanumeric characters&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1"># if cont_per != &quot;&quot;:</span>
                <span class="c1">#   if EC.data_lenght(cont_per,199) == 0:</span>
                <span class="c1">#       QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo codice periodo. \n Il valore non deve superare i 200 caratteri numerici&quot;,  QMessageBox.Ok)</span>
                <span class="c1">#       test = 1</span>
                <span class="c1"># PERIODIZZAZIONE CHECK</span>
                <span class="c1"># periodo iniz compilato e fase vuota  il blocco deve essere utilizzato meglio a partire dai signals</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        if self.comboBox_per_iniz.currentText() != &quot;&quot; and self.comboBox_fas_iniz.currentText() == &quot;&quot;:</span>
<span class="sd">            QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Fase iniziale \n Specificare la Fase iniziale oltre al Periodo&quot;,  QMessageBox.Ok)</span>
<span class="sd">            test = 1</span>
<span class="sd">        if self.comboBox_per_fin.currentText()  != &quot;&quot; and self.comboBox_fas_fin.currentText() == &quot;&quot;:</span>
<span class="sd">            QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Fase finale \n Specificare la Fase finale oltre al Periodo&quot;,  QMessageBox.Ok)</span>
<span class="sd">            test = 1</span>
<span class="sd">        if self.comboBox_per_iniz.currentText()  == &quot;&quot; and self.comboBox_fas_iniz.currentText() != &quot;&quot;:</span>
<span class="sd">            QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Periodo iniziale \n Specificare un Periodo iniziale oltre alla Fase&quot;,  QMessageBox.Ok)</span>
<span class="sd">            test = 1</span>
<span class="sd">        if self.comboBox_per_fin.currentText()  == &quot;&quot; and self.comboBox_fas_fin.currentText() != &quot;&quot;:</span>
<span class="sd">            QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campo Periodo iniziale \n Specificare un Periodo finale oltre alla Fase&quot;,  QMessageBox.Ok)</span>
<span class="sd">            test = 1</span>
<span class="sd">        if self.comboBox_per_fin.currentText()  != &quot;&quot; and self.comboBox_fas_fin.currentText() != &quot;&quot; and self.comboBox_per_iniz.currentText()  == &quot;&quot; and self.comboBox_fas_iniz.currentText() == &quot;&quot;:</span>
<span class="sd">            QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campi Periodo e Fase iniziali \n Specificare un Periodo e Fase iniziali se si vuole inserire un Periodo e Fase finali&quot;,  QMessageBox.Ok)</span>
<span class="sd">            test = 1</span>
<span class="sd">        if self.comboBox_per_fin.currentText()  != &quot;&quot; and self.comboBox_fas_fin.currentText() != &quot;&quot; and self.comboBox_per_iniz.currentText()  == &quot;&quot; and self.comboBox_fas_iniz.currentText() == &quot;&quot;:</span>
<span class="sd">            QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campi Periodo e Fase iniziali \n Specificare un Periodo e Fase iniziali se si vuole inserire un Periodo e Fase finali&quot;,  QMessageBox.Ok)</span>
<span class="sd">            test = 1</span>
<span class="sd">        if self.comboBox_per_iniz.currentText()  != &quot;&quot; and self.comboBox_fas_iniz.currentText() != &quot;&quot;:</span>
<span class="sd">            search_dict = {</span>
<span class="sd">            &#39;sito&#39;  : &quot;&#39;&quot;+str(self.comboBox_sito.currentText())+&quot;&#39;&quot;,</span>
<span class="sd">            &#39;periodo&#39;  : &quot;&#39;&quot;+str(self.comboBox_per_iniz.currentText())+&quot;&#39;&quot;,</span>
<span class="sd">            }</span>
<span class="sd">            if  bool(self.DB_MANAGER.query_bool(search_dict, &#39;PERIODIZZAZIONE&#39;)) == False:</span>
<span class="sd">                QMessageBox.warning(self, &quot;ATTENZIONE&quot;, &quot;Campi Periodo e Fase iniziali \n E&#39; stata inserita una periodizzazione inesistente&quot;,  QMessageBox.Ok)</span>
<span class="sd">                test = 1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">test</span>

    <span class="k">def</span> <span class="nf">automaticform_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sito_check</span><span class="p">,</span> <span class="n">area_check</span><span class="p">):</span>

        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito_check</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">area_check</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">}</span>
        <span class="n">records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>  <span class="c1"># carica tutti i dati di uno scavo ordinati per numero di US</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="n">report_rapporti3</span> <span class="o">=</span> <span class="s1">&#39;Report controllo e conteggio delle Schede create automatcamente - Sito: </span><span class="si">%s</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">sito_check</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="n">report_rapporti3</span> <span class="o">=</span> <span class="s1">&#39;Kontrollbericht Definition Stratigraphische zu Stratigraphische Berichte - Ausgrabungsst√§tte: </span><span class="si">%s</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">sito_check</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">report_rapporti3</span> <span class="o">=</span> <span class="s1">&#39;Control and count of forms automatically created - Site: </span><span class="si">%s</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">sito_check</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)):</span>
            <span class="n">sito</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">sito</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="n">area</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="n">us</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">us</span><span class="p">)</span>
            <span class="n">def_stratigrafica</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">d_stratigrafica</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="n">rapporti</span> <span class="o">=</span> <span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">rapporti</span>  <span class="c1"># caricati i rapporti nella variabile</span>
            <span class="n">rapporti</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">def_stratigrafica</span><span class="p">)</span>
            <span class="c1">#for sing_rapp in range(len(records)):  # itera sulla serie di rapporti</span>
            <span class="n">report3</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">def_stratigrafica</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;SCHEDA CREATA IN AUTOMATICO&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>


                <span class="n">report3</span> <span class="o">=</span> <span class="s1">&#39;Sito: </span><span class="si">%s</span><span class="s1">, Area: </span><span class="si">%s</span><span class="s1">, US: </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">. Da rivedere &#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">def_stratigrafica</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">report3</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">report_rapporti3</span> <span class="o">=</span> <span class="n">report_rapporti3</span> <span class="o">+</span> <span class="n">report3</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="c1"># self.listWidget_rapp.item(0).setForeground(QtCore.Qt.blue)</span>
                <span class="c1"># self.listWidget_rapp.item(1).setForeground(QtCore.Qt.blue)</span>
                <span class="c1">#self.listWidget_rapp.clear()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listWidget_rapp</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">report_rapporti3</span><span class="p">)</span>
        <span class="n">HOME</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYARCHINIT_HOME&#39;</span><span class="p">]</span>
        <span class="n">report_path</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">HOME</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;pyarchinit_Report_folder&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;log_schedeautomatiche.txt&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;log_def_strat_to_SE relation.txt&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;en&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;log_strat_def_to_SU relation.txt&#39;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">report_rapporti3</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">rapporti_stratigrafici_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sito_check</span><span class="p">,</span> <span class="n">area_check</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listWidget_rapp</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">conversion_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Covers&#39;</span><span class="p">:</span><span class="s1">&#39;Covered by&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Covered by&#39;</span><span class="p">:</span> <span class="s1">&#39;Covers&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Fills&#39;</span><span class="p">:</span> <span class="s1">&#39;Filled by&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Filled by&#39;</span><span class="p">:</span><span class="s1">&#39;Fills&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Cuts&#39;</span><span class="p">:</span> <span class="s1">&#39;Cutted by&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Cutted by&#39;</span><span class="p">:</span> <span class="s1">&#39;Cuts&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Abuts&#39;</span><span class="p">:</span> <span class="s1">&#39;Supports&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Supports&#39;</span><span class="p">:</span> <span class="s1">&#39;Abuts&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Connected to&#39;</span><span class="p">:</span> <span class="s1">&#39;Connected to&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Same as&#39;</span><span class="p">:</span><span class="s1">&#39;Same as&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Copre&#39;</span><span class="p">:</span><span class="s1">&#39;Coperto da&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Coperto da&#39;</span><span class="p">:</span> <span class="s1">&#39;Copre&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Riempie&#39;</span><span class="p">:</span> <span class="s1">&#39;Riempito da&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Riempito da&#39;</span> <span class="p">:</span> <span class="s1">&#39;Riempie&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Taglia&#39;</span><span class="p">:</span> <span class="s1">&#39;Tagliato da&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Tagliato da&#39;</span><span class="p">:</span> <span class="s1">&#39;Taglia&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Si appoggia a&#39;</span><span class="p">:</span> <span class="s1">&#39;Gli si appoggia&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Gli si appoggia&#39;</span><span class="p">:</span> <span class="s1">&#39;Si appoggia a&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Si lega a&#39;</span><span class="p">:</span> <span class="s1">&#39;Si lega a&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Uguale a&#39;</span><span class="p">:</span><span class="s1">&#39;Uguale a&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Liegt √ºber&#39;</span><span class="p">:</span><span class="s1">&#39;Liegt unter&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Liegt unter&#39;</span><span class="p">:</span><span class="s1">&#39;Liegt √ºber&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Schneidet&#39;</span><span class="p">:</span><span class="s1">&#39;Wird geschnitten&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Wird geschnitten&#39;</span><span class="p">:</span><span class="s1">&#39;Schneidet&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Verf√ºllt&#39;</span><span class="p">:</span><span class="s1">&#39;Wird verf√ºllt durch&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Wird verf√ºllt durch&#39;</span><span class="p">:</span><span class="s1">&#39;Verf√ºllt&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;St√ºtzt sich auf&#39;</span><span class="p">:</span><span class="s1">&#39;Wird gest√ºzt von&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Wird gest√ºzt von&#39;</span><span class="p">:</span><span class="s1">&#39;St√ºtzt sich auf&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Bindet an&#39;</span><span class="p">:</span><span class="s1">&#39;Bindet an&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Entspricht&#39;</span><span class="p">:</span><span class="s1">&#39;Entspricht&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">:</span><span class="s1">&#39;&lt;&lt;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&lt;&lt;&#39;</span><span class="p">:</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&lt;-&gt;&#39;</span><span class="p">:</span><span class="s1">&#39;&lt;-&gt;&#39;</span>
                           <span class="p">}</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito_check</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">area_check</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">}</span>
        <span class="n">records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>  <span class="c1"># carica tutti i dati di uno scavo ordinati per numero di US</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="n">report_rapporti</span> <span class="o">=</span> <span class="s1">&#39;Report controllo Rapporti Stratigrafici - Sito: </span><span class="si">%s</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sito_check</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="n">report_rapporti</span> <span class="o">=</span> <span class="s1">&#39;Kontrollbericht Stratigraphische Beziehungen - Ausgrabungsst√§tte: </span><span class="si">%s</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sito_check</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">report_rapporti</span> <span class="o">=</span> <span class="s1">&#39;Control report Stratigraphic relationships - Site: </span><span class="si">%s</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sito_check</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)):</span>
            <span class="n">sito</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">sito</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="n">area</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="n">us</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">us</span><span class="p">)</span>
            <span class="n">rapporti</span> <span class="o">=</span> <span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">rapporti</span>  <span class="c1"># caricati i rapporti nella variabile</span>
            <span class="n">rapporti</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">rapporti</span><span class="p">)</span>
            <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">sing_rapp</span> <span class="ow">in</span> <span class="n">rapporti</span><span class="p">:</span>  <span class="c1"># itera sulla serie di rapporti</span>


                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">us</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

                        <span class="n">rapp_converted</span> <span class="o">=</span> <span class="n">conversion_dict</span><span class="p">[</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

                        <span class="n">serch_dict_rapp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="n">sito</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="n">area</span><span class="p">,</span> <span class="s1">&#39;us&#39;</span><span class="p">:</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
                        <span class="n">us_rapp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">serch_dict_rapp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>

                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">us_rapp</span><span class="p">):</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                                <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Sito: </span><span class="si">%s</span><span class="s1">, Area: </span><span class="si">%s</span><span class="s1">, US: </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> US: </span><span class="si">%d</span><span class="s1">: Scheda US non esistente&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                    <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                                <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Ausgrabungsst√§tte: </span><span class="si">%s</span><span class="s1">, Areal: </span><span class="si">%s</span><span class="s1">, SE: </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> SE: </span><span class="si">%d</span><span class="s1">: SE formular nicht existent&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                    <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Site: </span><span class="si">%s</span><span class="s1">, Area: </span><span class="si">%s</span><span class="s1">, SU: </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> SU: </span><span class="si">%d</span><span class="s1">: SU form not-existent&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                    <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                            <span class="c1"># new system rapp_check</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">rapporti_check</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">us_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rapporti</span><span class="p">)</span>

                            <span class="n">us_rapp_check</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">us</span><span class="p">)</span>

                            <span class="k">if</span> <span class="n">rapporti_check</span><span class="o">.</span><span class="n">count</span><span class="p">([</span><span class="n">rapp_converted</span><span class="p">,</span> <span class="n">us_rapp_check</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="n">report</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                                    <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Sito: </span><span class="si">%s</span><span class="s1">, Area: </span><span class="si">%s</span><span class="s1">, US: </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> US: </span><span class="si">%d</span><span class="s1">: Rapporto non verificato&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                        <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                                    <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Ausgrabungsst√§tte: </span><span class="si">%s</span><span class="s1">, Areal: </span><span class="si">%s</span><span class="s1">, SE: </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> SE: </span><span class="si">%d</span><span class="s1">: nicht gepr√ºfter Bericht&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                        <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Site: </span><span class="si">%s</span><span class="s1">, Area: </span><span class="si">%s</span><span class="s1">, SU: </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> SU: </span><span class="si">%d</span><span class="s1">: relashionships not verified&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                        <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

                <span class="k">if</span> <span class="n">report</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">report_rapporti</span> <span class="o">=</span> <span class="n">report_rapporti</span> <span class="o">+</span> <span class="n">report</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">listWidget_rapp</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">report_rapporti</span><span class="p">)</span>

            <span class="c1"># self.progressBar_3.setHidden(False)</span>
            <span class="c1"># value = (float(rec)/float(len(records)))*100</span>
            <span class="c1"># self.progressBar_3.setValue(value)</span>
            <span class="c1"># QApplication.processEvents()</span>
        <span class="c1"># self.progressBar_3.reset()</span>

        <span class="n">HOME</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYARCHINIT_HOME&#39;</span><span class="p">]</span>
        <span class="n">report_path</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">HOME</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;pyarchinit_Report_folder&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;log_rapporti_US.txt&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;log_SE.txt&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;log_SU_relations.txt&#39;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">report_rapporti</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">def_strati_to_rapporti_stratigrafici_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sito_check</span><span class="p">,</span> <span class="n">area_check</span><span class="p">):</span>
        <span class="n">conversion_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Covers&#39;</span><span class="p">:</span><span class="s1">&#39;Covered by&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Covered by&#39;</span><span class="p">:</span> <span class="s1">&#39;Covers&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Fills&#39;</span><span class="p">:</span> <span class="s1">&#39;Filled by&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Filled by&#39;</span><span class="p">:</span><span class="s1">&#39;Fills&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Cuts&#39;</span><span class="p">:</span> <span class="s1">&#39;Cutted by&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Cutted by&#39;</span><span class="p">:</span> <span class="s1">&#39;Cuts&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Abuts&#39;</span><span class="p">:</span> <span class="s1">&#39;Supports&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Supports&#39;</span><span class="p">:</span> <span class="s1">&#39;Abuts&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Connected to&#39;</span><span class="p">:</span> <span class="s1">&#39;Connected to&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Same as&#39;</span><span class="p">:</span><span class="s1">&#39;Same as&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Copre&#39;</span><span class="p">:</span><span class="s1">&#39;Coperto da&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Coperto da&#39;</span><span class="p">:</span> <span class="s1">&#39;Copre&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Riempie&#39;</span><span class="p">:</span> <span class="s1">&#39;Riempito da&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Riempito da&#39;</span> <span class="p">:</span> <span class="s1">&#39;Riempie&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Taglia&#39;</span><span class="p">:</span> <span class="s1">&#39;Tagliato da&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Tagliato da&#39;</span><span class="p">:</span> <span class="s1">&#39;Taglia&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Si appoggia a&#39;</span><span class="p">:</span> <span class="s1">&#39;Gli si appoggia&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Gli si appoggia&#39;</span><span class="p">:</span> <span class="s1">&#39;Si appoggia a&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Si lega a&#39;</span><span class="p">:</span> <span class="s1">&#39;Si lega a&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Uguale a&#39;</span><span class="p">:</span><span class="s1">&#39;Uguale a&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Liegt √ºber&#39;</span><span class="p">:</span><span class="s1">&#39;Liegt unter&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Liegt unter&#39;</span><span class="p">:</span><span class="s1">&#39;Liegt √ºber&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Schneidet&#39;</span><span class="p">:</span><span class="s1">&#39;Wird geschnitten&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Wird geschnitten&#39;</span><span class="p">:</span><span class="s1">&#39;Schneidet&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Verf√ºllt&#39;</span><span class="p">:</span><span class="s1">&#39;Wird verf√ºllt durch&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Wird verf√ºllt durch&#39;</span><span class="p">:</span><span class="s1">&#39;Verf√ºllt&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;St√ºtzt sich auf&#39;</span><span class="p">:</span><span class="s1">&#39;Wird gest√ºzt von&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Wird gest√ºzt von&#39;</span><span class="p">:</span><span class="s1">&#39;St√ºtzt sich auf&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Bindet an&#39;</span><span class="p">:</span><span class="s1">&#39;Bindet an&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Entspricht&#39;</span><span class="p">:</span><span class="s1">&#39;Entspricht&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">:</span><span class="s1">&#39;&lt;&lt;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&lt;&lt;&#39;</span><span class="p">:</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&lt;-&gt;&#39;</span><span class="p">:</span><span class="s1">&#39;&lt;-&gt;&#39;</span>
                           <span class="p">}</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito_check</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">area_check</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">}</span>
        <span class="n">records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>  <span class="c1"># carica tutti i dati di uno scavo ordinati per numero di US</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="n">report_rapporti1</span> <span class="o">=</span> <span class="s1">&#39;Report controllo Definizione Stratigrafica a Rapporti Stratigrafici - Sito: </span><span class="si">%s</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">sito_check</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="n">report_rapporti1</span> <span class="o">=</span> <span class="s1">&#39;Kontrollbericht Definition Stratigraphische zu Stratigraphische Berichte - Ausgrabungsst√§tte: </span><span class="si">%s</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">sito_check</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">report_rapporti1</span> <span class="o">=</span> <span class="s1">&#39;Control report Definition Stratigraphic to Stratigraphic Reports - Site: </span><span class="si">%s</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">sito_check</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)):</span>
            <span class="n">sito</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">sito</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="n">area</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="n">us</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">us</span><span class="p">)</span>
            <span class="n">def_stratigrafica</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">d_stratigrafica</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="n">rapporti</span> <span class="o">=</span> <span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">rapporti</span>  <span class="c1"># caricati i rapporti nella variabile</span>
            <span class="n">rapporti</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">rapporti</span><span class="p">)</span>


            <span class="k">for</span> <span class="n">sing_rapp</span> <span class="ow">in</span> <span class="n">rapporti</span><span class="p">:</span>  <span class="c1"># itera sulla serie di rapporti</span>
                <span class="n">report</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">if</span> <span class="n">def_stratigrafica</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Strato&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Paradosso strati che tagliano o si legano</span>
                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Si lega a&#39;</span><span class="p">:</span>
                        <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Sito: </span><span class="si">%s</span><span class="s1">, Area: </span><span class="si">%s</span><span class="s1">, US: </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: lo strato </span><span class="si">%s</span><span class="s1"> US: </span><span class="si">%d</span><span class="s1">: &#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">def_stratigrafica</span><span class="p">,</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">def_stratigrafica</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Riempimento&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Paradosso riempimentiche tagliano o si legano</span>
                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Taglia&#39;</span> <span class="ow">or</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Si lega a&#39;</span><span class="ow">or</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Si appoggia a&#39;</span> <span class="ow">or</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Gli si appoggia&#39;</span> <span class="ow">or</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Taglia&#39;</span><span class="p">:</span>
                        <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Sito: </span><span class="si">%s</span><span class="s1">, Area: </span><span class="si">%s</span><span class="s1">, US: </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: lo strato </span><span class="si">%s</span><span class="s1"> US: </span><span class="si">%d</span><span class="s1">: &#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">def_stratigrafica</span><span class="p">,</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">def_stratigrafica</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Taglio&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Paradosso riempimentiche tagliano o si legano</span>
                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Riempie&#39;</span> <span class="ow">or</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Si lega a&#39;</span> <span class="ow">or</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Si appoggia a&#39;</span>  <span class="ow">or</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Gli si appoggia&#39;</span><span class="p">:</span>
                        <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Sito: </span><span class="si">%s</span><span class="s1">, Area: </span><span class="si">%s</span><span class="s1">, US: </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: lo strato </span><span class="si">%s</span><span class="s1"> US: </span><span class="si">%d</span><span class="s1">: &#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">def_stratigrafica</span><span class="p">,</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">report</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">report_rapporti1</span> <span class="o">=</span> <span class="n">report_rapporti1</span> <span class="o">+</span> <span class="n">report</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="c1">#versione inglese</span>
                <span class="k">elif</span> <span class="n">def_stratigrafica</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Stra&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Paradosso strati che tagliano o si legano</span>
                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Connected to&#39;</span><span class="p">:</span>
                        <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Site: </span><span class="si">%s</span><span class="s1">, Area: </span><span class="si">%s</span><span class="s1">, SU: </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: the stratum </span><span class="si">%s</span><span class="s1"> SU: </span><span class="si">%d</span><span class="s1">: &#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">def_stratigrafica</span><span class="p">,</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">def_stratigrafica</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Fills&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Paradosso riempimentiche tagliano o si legano</span>
                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cuts&#39;</span> <span class="ow">or</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Connected to&#39;</span><span class="p">:</span>
                        <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Site: </span><span class="si">%s</span><span class="s1">, Area: </span><span class="si">%s</span><span class="s1">, SU: </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: the startum </span><span class="si">%s</span><span class="s1"> SU: </span><span class="si">%d</span><span class="s1">: &#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">def_stratigrafica</span><span class="p">,</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="c1"># if def_stratigrafica.find(&#39;Filling&#39;) &gt;= 0:  # Paradosso riempimentiche tagliano o si legano</span>
                    <span class="c1"># if sing_rapp[0] == &#39;Cuts&#39; or sing_rapp[0] == &#39;Connected to&#39;:</span>
                        <span class="c1"># report = &#39;Site: %s, Area: %s, SU: %d - %s: the stratum %s SU: %d: &#39; % (</span>
                            <span class="c1"># sito, area, int(us), def_stratigrafica, sing_rapp[0], int(sing_rapp[1]))</span>
                <span class="k">if</span> <span class="n">report</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">report_rapporti1</span> <span class="o">=</span> <span class="n">report_rapporti1</span> <span class="o">+</span> <span class="n">report</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="c1">#versione tedesca</span>
                <span class="k">elif</span> <span class="n">def_stratigrafica</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Stratum&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Paradosso strati che tagliano o si legano</span>
                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bindet an&#39;</span><span class="p">:</span>
                        <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Sito: </span><span class="si">%s</span><span class="s1">, Area: </span><span class="si">%s</span><span class="s1">, SE: </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: die startum </span><span class="si">%s</span><span class="s1"> US: </span><span class="si">%d</span><span class="s1">: &#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">def_stratigrafica</span><span class="p">,</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">def_stratigrafica</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Verfull√ºng&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Paradosso riempimentiche tagliano o si legano</span>
                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Schneidet&#39;</span> <span class="ow">or</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bindet an&#39;</span><span class="p">:</span>
                        <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Sito: </span><span class="si">%s</span><span class="s1">, Area: </span><span class="si">%s</span><span class="s1">, SE: </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: die stratum </span><span class="si">%s</span><span class="s1"> US: </span><span class="si">%d</span><span class="s1">: &#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">def_stratigrafica</span><span class="p">,</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="c1"># if def_stratigrafica.find(&#39;Verfull√ºng&#39;) &gt;= 0:  # Paradosso riempimentiche tagliano o si legano</span>
                    <span class="c1"># if sing_rapp[0] == &#39;Schneidet&#39; or sing_rapp[0] == &#39;Bindet an&#39;:</span>
                        <span class="c1"># report = &#39;Sito: %s, Area: %s, SE: %d - %s: die startum %s US: %d: &#39; % (</span>
                            <span class="c1"># sito, area, int(us), def_stratigrafica, sing_rapp[0], int(sing_rapp[1]))</span>
                <span class="k">if</span> <span class="n">report</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">report_rapporti1</span> <span class="o">=</span> <span class="n">report_rapporti1</span> <span class="o">+</span> <span class="n">report</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">listWidget_rapp</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">report_rapporti1</span><span class="p">)</span>

        <span class="n">HOME</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYARCHINIT_HOME&#39;</span><span class="p">]</span>
        <span class="n">report_path</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">HOME</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;pyarchinit_Report_folder&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;log_def_strat_a_rapporti_US.txt&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;log_def_strat_to_SE relation.txt&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;en&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;log_strat_def_to_SU relation.txt&#39;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">report_rapporti1</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="si">}{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">periodi_to_rapporti_stratigrafici_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sito_check</span><span class="p">,</span> <span class="n">area_check</span><span class="p">):</span>
        <span class="n">conversion_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Covers&#39;</span><span class="p">:</span><span class="s1">&#39;Covered by&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Covered by&#39;</span><span class="p">:</span> <span class="s1">&#39;Covers&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Fills&#39;</span><span class="p">:</span> <span class="s1">&#39;Filled by&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Filled by&#39;</span><span class="p">:</span><span class="s1">&#39;Fills&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Cuts&#39;</span><span class="p">:</span> <span class="s1">&#39;Cutted by&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Cutted by&#39;</span><span class="p">:</span> <span class="s1">&#39;Cuts&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Abuts&#39;</span><span class="p">:</span> <span class="s1">&#39;Supports&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Supports&#39;</span><span class="p">:</span> <span class="s1">&#39;Abuts&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Connected to&#39;</span><span class="p">:</span> <span class="s1">&#39;Connected to&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Same as&#39;</span><span class="p">:</span><span class="s1">&#39;Same as&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Copre&#39;</span><span class="p">:</span><span class="s1">&#39;Coperto da&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Coperto da&#39;</span><span class="p">:</span> <span class="s1">&#39;Copre&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Riempie&#39;</span><span class="p">:</span> <span class="s1">&#39;Riempito da&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Riempito da&#39;</span> <span class="p">:</span> <span class="s1">&#39;Riempie&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Taglia&#39;</span><span class="p">:</span> <span class="s1">&#39;Tagliato da&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Tagliato da&#39;</span><span class="p">:</span> <span class="s1">&#39;Taglia&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Si appoggia a&#39;</span><span class="p">:</span> <span class="s1">&#39;Gli si appoggia&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Gli si appoggia&#39;</span><span class="p">:</span> <span class="s1">&#39;Si appoggia a&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Si lega a&#39;</span><span class="p">:</span> <span class="s1">&#39;Si lega a&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Uguale a&#39;</span><span class="p">:</span><span class="s1">&#39;Uguale a&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Liegt √ºber&#39;</span><span class="p">:</span><span class="s1">&#39;Liegt unter&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Liegt unter&#39;</span><span class="p">:</span><span class="s1">&#39;Liegt √ºber&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Schneidet&#39;</span><span class="p">:</span><span class="s1">&#39;Wird geschnitten&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Wird geschnitten&#39;</span><span class="p">:</span><span class="s1">&#39;Schneidet&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Verf√ºllt&#39;</span><span class="p">:</span><span class="s1">&#39;Wird verf√ºllt durch&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Wird verf√ºllt durch&#39;</span><span class="p">:</span><span class="s1">&#39;Verf√ºllt&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;St√ºtzt sich auf&#39;</span><span class="p">:</span><span class="s1">&#39;Wird gest√ºzt von&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Wird gest√ºzt von&#39;</span><span class="p">:</span><span class="s1">&#39;St√ºtzt sich auf&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Bindet an&#39;</span><span class="p">:</span><span class="s1">&#39;Bindet an&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Entspricht&#39;</span><span class="p">:</span><span class="s1">&#39;Entspricht&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">:</span><span class="s1">&#39;&lt;&lt;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&lt;&lt;&#39;</span><span class="p">:</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;&lt;-&gt;&#39;</span><span class="p">:</span><span class="s1">&#39;&lt;-&gt;&#39;</span>
                           <span class="p">}</span>
        <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sito&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sito_check</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">area_check</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">}</span>
        <span class="n">records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>  <span class="c1"># carica tutti i dati di uno scavo ordinati per numero di US</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="n">report_rapporti2</span> <span class="o">=</span> <span class="s1">&#39;Report controllo Periodi/Unit√† Tipo a Rapporti Stratigrafici - Sito: </span><span class="si">%s</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">sito_check</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="n">report_rapporti2</span> <span class="o">=</span> <span class="s1">&#39;Kontrollbericht Periodization/Type Unit zu Stratigraphische Berichte - Ausgrabungsst√§tte: </span><span class="si">%s</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">sito_check</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">report_rapporti2</span> <span class="o">=</span> <span class="s1">&#39;Control report Periodization/Type Unit to Stratigraphic Reports - Site: </span><span class="si">%s</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">sito_check</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)):</span>
            <span class="n">sito</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">sito</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="n">area</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="n">us</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">us</span><span class="p">)</span>
            <span class="n">periodo_in</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">periodo_iniziale</span><span class="p">)</span>
            <span class="n">fase_in</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">fase_iniziale</span><span class="p">)</span>
            <span class="n">periodo_fin</span> <span class="o">=</span>  <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">periodo_finale</span><span class="p">)</span>
            <span class="n">fase_fin</span> <span class="o">=</span>  <span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">fase_iniziale</span><span class="p">)</span>
            <span class="n">ut</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">unita_tipo</span><span class="p">)</span>
            <span class="n">rapporti</span> <span class="o">=</span> <span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">rapporti</span>  <span class="c1"># caricati i rapporti nella variabile</span>
            <span class="n">rapporti</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">rapporti</span><span class="p">)</span>
            <span class="n">rapporti2</span> <span class="o">=</span> <span class="n">records</span><span class="p">[</span><span class="n">rec</span><span class="p">]</span><span class="o">.</span><span class="n">rapporti2</span>  <span class="c1"># caricati i rapporti nella variabile</span>
            <span class="n">rapporti2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">rapporti2</span><span class="p">)</span>


            <span class="k">for</span> <span class="n">sing_rapp</span> <span class="ow">in</span> <span class="n">rapporti2</span><span class="p">:</span>  <span class="c1"># itera sulla serie di rapporti</span>
                <span class="n">report</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">report2</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

                <span class="c1"># rapp_sing=sing_rapp[4].split()</span>
                <span class="c1"># QMessageBox.information(self,&#39;&#39;,str(rapp_sing))</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;6&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;7&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;8&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;9&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;10&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;11&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;13&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;14&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;15&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>

                    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)</span><span class="o">!=</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Si lega a&#39;</span> <span class="ow">or</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Uguale a&#39;</span> <span class="ow">or</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Same as&#39;</span> <span class="ow">or</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Connected to&#39;</span><span class="p">:</span>
                            <span class="n">report</span> <span class="o">=</span> <span class="s1">&#39;Sito: </span><span class="si">%s</span><span class="s1">, Area: </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">: </span><span class="si">%d</span><span class="s1"> -  Il periodo e fase iniziale </span><span class="si">%s</span><span class="s1">: deve essere: </span><span class="si">%s</span><span class="s1"> corrispondente con la </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1">: &#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">sito</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

                    <span class="c1"># if not bool(sing_rapp):</span>
                        <span class="c1"># report2:&#39;la table widget deve essere riempita&#39;</span>
                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Si lega a&#39;</span> <span class="ow">and</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;US&#39;</span><span class="p">:</span>

                        <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1">: devono essere USM&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Connected to&#39;</span> <span class="ow">and</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;SU&#39;</span><span class="p">:</span>

                        <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1">: should be WSU&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Uguale a&#39;</span> <span class="ow">and</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;USM&#39;</span><span class="p">:</span>

                        <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1">: devono essere US&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Same as&#39;</span> <span class="ow">and</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;WSU&#39;</span><span class="p">:</span>

                        <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1">: should be SU&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Si appoggia a&#39;</span> <span class="ow">and</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;US&#39;</span><span class="p">:</span>

                        <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1">: devono essere USM&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Gli si appoggia&#39;</span> <span class="ow">and</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;US&#39;</span><span class="p">:</span>

                        <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1">: devono essere USM&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Abuts&#39;</span> <span class="ow">and</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;SU&#39;</span><span class="p">:</span>

                        <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1">: should be WSU&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Supports&#39;</span> <span class="ow">and</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;SU&#39;</span><span class="p">:</span>

                        <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1">: should be WSU&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;-&#39;</span><span class="p">:</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Covers&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- should be Covered by </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Covered by&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- should be Covers </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Fills&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Should be Filled by </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Filled by&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Shuld be Fills </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cuts&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Shuld be Cutted by </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cutted by&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Shuld be Cuts </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Abuts&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Shuld be Supports </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Supports&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Shuld be Abuts </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Copre&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Dovrebbe essere Coperto da </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Coperto da&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Dovrebbe Coprire </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Riempie&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Dovrebbe essere Riempito da </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Riempito da&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Dovrebbe Riempire </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Taglia&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Dovrebbe essere Tagliato da </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Tagliato da&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Dovrebbe Tagliare </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Si appoggia a&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Dovrebbe essere Gli si appoggia </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Gli si appoggia&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fase_in</span><span class="p">)):</span>

                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%d</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">- Dovrebbe Si appoggia a </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">ut</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">us</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">periodo_in</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">fase_in</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;-&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;Manca la peridizzazione in </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">report2</span> <span class="o">=</span> <span class="s1">&#39;Missing the periodization in </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">sing_rapp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sing_rapp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>



                <span class="k">if</span> <span class="n">report2</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">report_rapporti2</span> <span class="o">=</span> <span class="n">report_rapporti2</span> <span class="o">+</span> <span class="n">report</span> <span class="o">+</span> <span class="n">report2</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">listWidget_rapp</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">report_rapporti2</span><span class="p">)</span>



        <span class="n">HOME</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYARCHINIT_HOME&#39;</span><span class="p">]</span>
        <span class="n">report_path</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">HOME</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;pyarchinit_Report_folder&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;log_per_ut_a_rapporti_US.txt&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;log_per_ut_to_SE relation.txt&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;en&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;log_per_ut_to_SU relation.txt&#39;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">report_rapporti2</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">insert_new_rec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TableWidget</span>
        <span class="c1">#Rapporti</span>
        <span class="n">rapporti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_rapporti&quot;</span><span class="p">)</span>
        <span class="n">rapporti2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_rapporti2&quot;</span><span class="p">)</span>
        <span class="c1">#Inclusi</span>
        <span class="n">inclusi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi&quot;</span><span class="p">)</span>
        <span class="c1">#Campioni</span>
        <span class="n">campioni</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_campioni&quot;</span><span class="p">)</span>
        <span class="c1">#organici</span>
        <span class="n">organici</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_organici&quot;</span><span class="p">)</span>
        <span class="c1">#inorganici</span>
        <span class="n">inorganici</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inorganici&quot;</span><span class="p">)</span>
        <span class="c1">#Documentazione</span>
        <span class="n">documentazione</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_documentazione&quot;</span><span class="p">)</span>
        <span class="c1">#Colore legante usm</span>
        <span class="n">colore_legante_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_colore_legante_usm&quot;</span><span class="p">)</span>
        <span class="c1">#Inclusi leganti usm</span>
        <span class="n">aggreg_legante_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi_leganti_usm&quot;</span><span class="p">)</span>
        <span class="c1">#Consistenza texture mat_usm</span>
        <span class="n">consistenza_texture_mat_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_consistenza_texture_mat_usm&quot;</span><span class="p">)</span>
        <span class="c1">#inclusi_materiali_usm</span>
        <span class="n">inclusi_materiali_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi_materiali_usm&quot;</span><span class="p">)</span>
        <span class="c1">#colore_materiale_usm</span>
        <span class="n">colore_materiale_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_colore_materiale_usm&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEditOrderLayer</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">order_layer</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">order_layer</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEditOrderLayer</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##quota min usm</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmin_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">qmin_usm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">qmin_usm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmin_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##quota max usm</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmax_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">qmax_usm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">qmax_usm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmax_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##quota relativa</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_relativa</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">quota_relativa</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quota_relativa</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_relativa</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##quota abs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">quota_abs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quota_abs</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_abs</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##lunghezza max</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">lunghezza_max</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lunghezza_max</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##altezza max</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">altezza_max</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">altezza_max</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##altezza min</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_min</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">altezza_min</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">altezza_min</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_min</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##profondita max</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">profondita_max</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">profondita_max</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_max</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##profondita min</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_min</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">profondita_min</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">profondita_min</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_min</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##larghezza media</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_larghezza_media</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">larghezza_media</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">larghezza_media</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_larghezza_media</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##quota max abs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">quota_max_abs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quota_max_abs</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_abs</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##quota max relativa</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_rel</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">quota_max_rel</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quota_max_rel</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_rel</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##quota min abs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">quota_min_abs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quota_min_abs</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_abs</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##quota min relativa</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_rel</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">quota_min_rel</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quota_min_rel</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_rel</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##lunghezza usm</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">lunghezza_usm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lunghezza_usm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##altezza usm</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">altezza_usm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">altezza_usm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="c1">##spessore usm</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">spessore_usm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">spessore_usm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># data</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">insert_values</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">max_num_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 1 - Sito</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 2 - Area</span>
                <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 3 - US</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_strat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 4 - Definizione stratigrafica</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_intepret</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 5 - Definizione intepretata</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_descrizione</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()),</span>  <span class="c1"># 6 - descrizione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_interpretazione</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()),</span>  <span class="c1"># 7 - interpretazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 8 - periodo iniziale</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_iniz</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 9 - fase iniziale</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_fin</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 10 - periodo finale iniziale</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_fin</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 11 - fase finale</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_scavato</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 12 - scavato</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_attivita</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 13 - attivita</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_anno</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 14 - anno scavo</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_metodo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 15 - metodo</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">inclusi</span><span class="p">),</span>  <span class="c1"># 16 - inclusi</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">campioni</span><span class="p">),</span>  <span class="c1"># 17 - campioni</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">rapporti</span><span class="p">),</span>  <span class="c1"># 18 - rapporti</span>
                <span class="c1">#str(organici), # componenti organici</span>
                <span class="c1">#str(inorganici), #componenti inorganici</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_schedatura</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 19 - data schedatura</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_schedatore</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 20 - schedatore</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_formazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 21 - formazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_conservazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 22 - conservazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 23 - colore</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 24 - consistenza</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_struttura</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 25 - struttura</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_codice_periodo</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 26 - continuita  periodo</span>
                <span class="n">order_layer</span><span class="p">,</span>  <span class="c1"># 27 - order layer</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">documentazione</span><span class="p">),</span>  <span class="c1"># 28 - documentazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 29 us_tipo            NUOVI CAMPI NUOVI CAMPI</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_settore</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 30 settore</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quadrato</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 31 quadrato</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ambiente</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 32 ambiente</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_saggio</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 33 saggio</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_elementi_datanti</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()),</span>  <span class="c1"># 34 elementi datanti</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_funz_statica_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 35 funzione statica</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 36 lavorazione usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_giunti_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 37 spessore giunti</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_letti_di_posa_giunti_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 38 letti posa giunti usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_h_modulo_c_corsi_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 39 altezza modulo corsi usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_edilizia_riassuntiva_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 40 unita edilizia riassuntiva</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_reimpiego_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 41 unita edilizia riassuntiva</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_in_opera_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 42 posa in opera</span>
                <span class="n">qmin_usm</span><span class="p">,</span>  <span class="c1"># 43 quota minima</span>
                <span class="n">qmax_usm</span><span class="p">,</span>  <span class="c1"># 44 quota massima</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_legante_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1">#  1 45 consitenza legante usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">colore_legante_usm</span><span class="p">),</span>  <span class="c1"># 2 46 colore legante usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">aggreg_legante_usm</span><span class="p">),</span>  <span class="c1"># 47 3 aggreg legante usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">consistenza_texture_mat_usm</span><span class="p">),</span>  <span class="c1"># 4 48 consistenza text mat</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">colore_materiale_usm</span><span class="p">),</span>  <span class="c1"># 5 49 colore materiale usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">inclusi_materiali_usm</span><span class="p">),</span> <span class="c1"># 6 50 inclusi_mat_usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_generale</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_interno</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 52 nr catalogo interno</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_internazionale</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 53 nr catalogo internazionale</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_soprintendenza</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span> <span class="c1"># 54 nr soprintendenza</span>
                <span class="n">quota_relativa</span><span class="p">,</span> <span class="c1">#55 quota relativa</span>
                <span class="n">quota_abs</span><span class="p">,</span> <span class="c1">#56 quota abs</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ref_tm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 57 ref tm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_ref_ra</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 58 ref ra</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ref_n</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 59 ref n</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posizione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 60 posizione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_criteri_distinzione</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 61 criteri distinzione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modo_formazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 62 modo formazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">organici</span><span class="p">),</span>  <span class="c1"># 63 componenti organici</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">inorganici</span><span class="p">),</span>  <span class="c1"># 64 componenti inorganici</span>
                <span class="n">lunghezza_max</span><span class="p">,</span>  <span class="c1"># 65</span>
                <span class="n">altezza_max</span><span class="p">,</span>  <span class="c1"># 66</span>
                <span class="n">altezza_min</span><span class="p">,</span>  <span class="c1"># 67</span>
                <span class="n">profondita_max</span><span class="p">,</span>  <span class="c1"># 68</span>
                <span class="n">profondita_min</span><span class="p">,</span>  <span class="c1"># 69</span>
                <span class="n">larghezza_media</span><span class="p">,</span>  <span class="c1"># 70</span>
                <span class="n">quota_max_abs</span><span class="p">,</span>  <span class="c1"># 71</span>
                <span class="n">quota_max_rel</span><span class="p">,</span>  <span class="c1"># 72</span>
                <span class="n">quota_min_abs</span><span class="p">,</span>  <span class="c1"># 73</span>
                <span class="n">quota_min_rel</span><span class="p">,</span>  <span class="c1"># 74</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_osservazioni</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()),</span>  <span class="c1"># 75 osservazioni</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_datazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 76 datazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_flottazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 77 flottazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_setacciatura</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 78 setacciatura</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_affidabilita</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 79 affidabilita</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_direttore_us</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 80 direttore us</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_responsabile_us</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 81 responsabile us</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_cod_ente_schedatore</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 82 cod ente schedatore</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_rilevazione</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 83 data rilevazione</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_rielaborazione</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 84 data rielaborazione</span>
                <span class="n">lunghezza_usm</span><span class="p">,</span>  <span class="c1"># 85</span>
                <span class="n">altezza_usm</span><span class="p">,</span>  <span class="c1"># 86</span>
                <span class="n">spessore_usm</span><span class="p">,</span>  <span class="c1"># 87</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tecnica_muraria_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 88 tecnica muraria usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modulo_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 89 modulo usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_malta_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 90 campioni malta usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_mattone_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 91 campioni mattone usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_pietra_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 92 campioni pietra usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_provenienza_materiali_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 93 provenienza_materiali_usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_criteri_distinzione_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 94 criteri distinzione usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_uso_primario_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipologia_opera</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sezione_muraria</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_superficie_analizzata</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_orientamento</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiali_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_impasto_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_taglio_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_opera_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_inerti_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipo_legante_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_rifinitura_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiale_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">rapporti2</span><span class="p">),</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mQgsFileWidget</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="p">)</span>
            <span class="c1"># todelete</span>
            <span class="c1"># f = open(&quot;C:\\Users\\Luca\\pyarchinit_Report_folder\\data_insert_list.txt&quot;, &quot;w&quot;)</span>
            <span class="c1"># f.write(str(data))</span>
            <span class="c1"># f.close</span>
            <span class="c1"># todelete</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">insert_data_session</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">e_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">e_str</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="s2">&quot;IntegrityError&quot;</span><span class="p">):</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;US gi√† presente nel database&quot;</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="s2">&quot;Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span> <span class="o">+</span> <span class="s2">&quot; bereits in der Datenbank&quot;</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="s2">&quot;Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span> <span class="o">+</span> <span class="s2">&quot; exist in db&quot;</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="s2">&quot;Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="n">e</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="s2">&quot;Error 1 </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">0</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="s2">&quot;Error 2 </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
            <span class="c1"># insert new row into tableWidget</span>
    <span class="k">def</span> <span class="nf">on_pushButton_insert_row_rapporti_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_rapporti&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_pushButton_remove_row_rapporti_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_rapporti&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_pushButton_insert_row_rapporti2_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_rapporti2&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_remove_row_rapporti2_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">remove_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_rapporti2&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_pushButton_insert_row_inclusi_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_inclusi&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_remove_row_inclusi_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_inclusi&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_insert_row_campioni_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_campioni&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_remove_row_campioni_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_campioni&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_insert_row_organici_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_organici&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_remove_row_organici_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_organici&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_insert_row_inorganici_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_inorganici&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_remove_row_inorganici_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_inorganici&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_insert_row_documentazione_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_documentazione&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_remove_row_documentazione_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_documentazione&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_insert_row_inclusi_materiali_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_inclusi_materiali_usm&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_remove_row_inclusi_materiali_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_inclusi_materiali_usm&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_insert_row_inclusi_leganti_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_inclusi_leganti_usm&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_remove_row_inclusi_leganti_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_inclusi_leganti_usm&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_insert_row_colore_legante_usm_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_colore_legante_usm&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_remove_row_colore_legante_usm_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_colore_legante_usm&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_insert_row_consistenza_texture_mat_usm_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_consistenza_texture_mat_usm&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_remove_row_consistenza_texture_mat_usm_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_consistenza_texture_mat_usm&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_insert_row_colore_materiale_usm_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_colore_materiale_usm&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_remove_row_colore_materiale_usm_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_row</span><span class="p">(</span><span class="s1">&#39;self.tableWidget_colore_materiale_usm&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">check_record_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_error_check</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ec</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>  <span class="c1"># ci sono errori di immissione</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">records_equal_check</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ec</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_if</span><span class="p">(</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Errore&#39;</span><span class="p">,</span> <span class="s2">&quot;Il record e&#39; stato modificato. Vuoi salvare le modifiche?&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_if</span><span class="p">(</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Errore&#39;</span><span class="p">,</span> <span class="s2">&quot;Der Record wurde ge√§ndert. M√∂chtest du die √Ñnderungen speichern?&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_if</span><span class="p">(</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="s2">&quot;The record has been changed. You want to save the changes?&quot;</span><span class="p">,</span>
                                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">))</span>
            <span class="k">return</span> <span class="mi">0</span>
            <span class="c1"># records surf functions</span>
    <span class="k">def</span> <span class="nf">on_pushButton_view_all_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charge_records</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;&lt;class &#39;str&#39;&gt;&quot;</span><span class="p">:</span>
            <span class="n">corr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">corr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span><span class="p">])</span>
        <span class="c1"># records surf functions</span>
    <span class="k">def</span> <span class="nf">on_pushButton_first_rec_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_record_state</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">:</span>
                <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">on_pushButton_last_rec_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_record_state</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">on_pushButton_prev_rec_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">rec_goto</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_goto</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_record_state</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">-</span> <span class="n">rec_goto</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="n">rec_goto</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Attenzione&quot;</span><span class="p">,</span> <span class="s2">&quot;Numero Rec Step troppo elevato&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span><span class="c1"># Exception as e:</span>
                <span class="k">pass</span><span class="c1">#QMessageBox.warning(self, &quot;Error&quot;, str(e), QMessageBox.Ok)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_next_rec_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">rec_goto</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_goto</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>



        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_record_state</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="n">rec_goto</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">-</span> <span class="n">rec_goto</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Attenzione&quot;</span><span class="p">,</span> <span class="s2">&quot;Numero Rec Step troppo elevato&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">:</span><span class="c1">#Exception as e:</span>
                <span class="k">pass</span><span class="c1">#QMessageBox.warning(self, &quot;Error&quot;, str(e), QMessageBox.Ok)</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_validate</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selectRows</span><span class="p">()</span>
            <span class="c1"># while True:</span>
                <span class="c1"># try:</span>
                    <span class="c1"># self.empty_fields()</span>
                    <span class="c1"># self.fill_fields(self.REC_CORR)</span>
                    <span class="c1"># self.set_rec_counter(self.REC_TOT, self.REC_CORR + 1)</span>
                <span class="c1"># except :#Exception as e:</span>
                    <span class="c1"># pass#QMessageBox.warning(self, &quot;Error&quot;, str(e), QMessageBox.Ok)</span>
                <span class="c1"># #continue</span>
                <span class="c1"># else:</span>
                    <span class="c1"># break</span>
    <span class="k">def</span> <span class="nf">on_pushButton_delete_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Attenzione!!!&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;Vuoi veramente eliminare il record? </span><span class="se">\n</span><span class="s2"> L&#39;azione √® irreversibile&quot;</span><span class="p">,</span>
                                      <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">msg</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Messagio!!!&quot;</span><span class="p">,</span> <span class="s2">&quot;Azione Annullata!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">id_to_delete</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;self.DATA_LIST[self.REC_CORR].&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">delete_one_record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TABLE_NAME</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">,</span> <span class="n">id_to_delete</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">charge_records</span><span class="p">()</span>  <span class="c1"># charge records from DB</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Messaggio!!!&quot;</span><span class="p">,</span> <span class="s2">&quot;Record eliminato!&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Messaggio!!!&quot;</span><span class="p">,</span> <span class="s2">&quot;Tipo di errore: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">):</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Attenzione&quot;</span><span class="p">,</span> <span class="s2">&quot;Il database √® vuoto!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="c1"># check if DB is empty</span>
                <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="mi">0</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">charge_list</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_sito</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Achtung!!!&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;Willst du wirklich diesen Eintrag l√∂schen? </span><span class="se">\n</span><span class="s2"> Der Vorgang ist unumkehrbar&quot;</span><span class="p">,</span>
                                      <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">msg</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message!!!&quot;</span><span class="p">,</span> <span class="s2">&quot;Aktion annulliert!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">id_to_delete</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;self.DATA_LIST[self.REC_CORR].&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">delete_one_record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TABLE_NAME</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">,</span> <span class="n">id_to_delete</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">charge_records</span><span class="p">()</span>  <span class="c1"># charge records from DB</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message!!!&quot;</span><span class="p">,</span> <span class="s2">&quot;Record gel√∂scht!&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Messagge!!!&quot;</span><span class="p">,</span> <span class="s2">&quot;Errortyp: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">):</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Attenzione&quot;</span><span class="p">,</span> <span class="s2">&quot;Die Datenbank ist leer!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="c1"># check if DB is empty</span>
                <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="mi">0</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">charge_list</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_sito</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Warning!!!&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;Do you really want to break the record? </span><span class="se">\n</span><span class="s2"> Action is irreversible.&quot;</span><span class="p">,</span>
                                      <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">msg</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message!!!&quot;</span><span class="p">,</span> <span class="s2">&quot;Action deleted!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">id_to_delete</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;self.DATA_LIST[self.REC_CORR].&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">delete_one_record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TABLE_NAME</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">,</span> <span class="n">id_to_delete</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">charge_records</span><span class="p">()</span>  <span class="c1"># charge records from DB</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message!!!&quot;</span><span class="p">,</span> <span class="s2">&quot;Record deleted!&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span> <span class="s2">&quot;error type: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">):</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="s2">&quot;the db is empty!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="c1"># check if DB is empty</span>
                <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="mi">0</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">charge_list</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_sito</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span><span class="p">])</span>
            <span class="c1">#</span>
    <span class="k">def</span> <span class="nf">on_pushButton_new_search_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_a</span><span class="o">.</span><span class="n">database</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">!=</span> <span class="s2">&quot;f&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_record_state</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enable_button_search</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">()</span>

            <span class="n">sito_set</span><span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">sito_set</span><span class="p">()</span>
            <span class="n">sito_set_str</span> <span class="o">=</span> <span class="n">sito_set</span><span class="p">[</span><span class="s1">&#39;sito_set&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">!=</span> <span class="s2">&quot;f&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="n">sito_set_str</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields_nosite</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_schedatura</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_anno</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_formazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_metodo</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="c1">#self.setComboBoxEditable([&quot;self.comboBox_sito&quot;], 1)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_unita_tipo&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_unita_tipo&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.lineEdit_us&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.textEdit_descrizione&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.textEdit_interpretazione&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setTableEnable</span><span class="p">(</span>
                        <span class="p">[</span><span class="s2">&quot;self.tableWidget_campioni&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_rapporti&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_inclusi&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_organici&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_inorganici&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_documentazione&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_inclusi_materiali_usm&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_colore_legante_usm&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_inclusi_leganti_usm&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_consistenza_texture_mat_usm&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_colore_materiale_usm&quot;</span><span class="p">,</span><span class="s2">&quot;self.tableWidget_rapporti2&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="c1">###</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">])</span>
                    <span class="c1">#self.charge_list()</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span>
                    <span class="c1">###</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_schedatura</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_anno</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_formazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_metodo</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEditable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_unita_tipo&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_unita_tipo&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.lineEdit_us&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.textEdit_descrizione&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.textEdit_interpretazione&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setTableEnable</span><span class="p">(</span>
                        <span class="p">[</span><span class="s2">&quot;self.tableWidget_campioni&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_rapporti&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_inclusi&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_organici&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_inorganici&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_documentazione&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_inclusi_materiali_usm&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_colore_legante_usm&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_inclusi_leganti_usm&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_consistenza_texture_mat_usm&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_colore_materiale_usm&quot;</span><span class="p">,</span><span class="s2">&quot;self.tableWidget_rapporti2&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="c1">###</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_sort</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SORTED_ITEMS</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">charge_list</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
<div class="viewcode-block" id="pyarchinit_US.on_pushButton_showLayer_pressed"><a class="viewcode-back" href="../../06_moduli.html#tabs.US_USM.pyarchinit_US.on_pushButton_showLayer_pressed">[documenti]</a>    <span class="k">def</span> <span class="nf">on_pushButton_showLayer_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        for sing_us in range(len(self.DATA_LIST)):</span>
<span class="sd">            sing_layer = [self.DATA_LIST[sing_us]]</span>
<span class="sd">            self.pyQGIS.charge_vector_layers(sing_layer)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sing_layer</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_vector_layers</span><span class="p">(</span><span class="n">sing_layer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_usm_layers</span><span class="p">(</span><span class="n">sing_layer</span><span class="p">)</span></div>
    <span class="k">def</span> <span class="nf">on_pushButton_crea_codice_periodo_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_sito</span><span class="p">()</span>
            <span class="n">sito</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">update_cont_per</span><span class="p">(</span><span class="n">sito</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">empty_fields</span><span class="p">()</span>
            <span class="c1">#self.charge_records()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span>  <span class="c1"># ricaricare tutti i record in uso e passare il valore REC_CORR a fill_fields</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;INFO&quot;</span><span class="p">,</span> <span class="s2">&quot;Codice periodo aggiornato per lo scavo </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sito</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;INFO&quot;</span><span class="p">,</span> <span class="s2">&quot;Der Zeitstellungscode wurde f√ºr die Ausgrabung hochgeladen </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sito</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;en&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;INFO&quot;</span><span class="p">,</span> <span class="s2">&quot;Updated period code for excavation </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sito</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Attenzione&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Achtung&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;en&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Attention&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_pushButton_search_go_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_query</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">!=</span> <span class="s2">&quot;f&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Per eseguire una nuova ricerca clicca sul pulsante &#39;new search&#39; &quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span> <span class="s2">&quot;Um eine neue Abfrage zu starten dr√ºcke  &#39;new search&#39; &quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span> <span class="s2">&quot;To perform a new search click on the &#39;new search&#39; button &quot;</span><span class="p">,</span>
                                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># TableWidget</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">us</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">us</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="c1">##qmin_usm</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmin_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">qmin_usm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmin_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">qmin_usm</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1">##qmax_usm</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmax_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">qmax_usm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmax_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">qmax_usm</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1">#pre pyarchinit 3.0</span>
            <span class="c1">##quota relativa</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_relativa</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">quota_relativa</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_relativa</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_relativa</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##quota abs</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">quota_abs</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_abs</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_abs</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##lunghezza max</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">lunghezza_max</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lunghezza_max</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##altezza max</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">altezza_max</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">altezza_max</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##altezza min</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_min</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">altezza_min</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">altezza_min</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_min</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##profondita max</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">profondita_max</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">profondita_max</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_max</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##profondita min</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_min</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">profondita_min</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">profondita_min</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_min</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##larghezza media</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_larghezza_media</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">larghezza_media</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">larghezza_media</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_larghezza_media</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##quota max abs</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">quota_max_abs</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_max_abs</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_abs</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##quota max relativa</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_rel</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">quota_max_rel</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_max_rel</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_rel</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##quota min abs</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">quota_min_abs</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_min_abs</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_abs</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##quota min relativa</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_rel</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">quota_min_rel</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quota_min_rel</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_rel</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##lunghezza usm</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">lunghezza_usm</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lunghezza_usm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##altezza usm</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">altezza_usm</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">altezza_usm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="c1">##spessore usm</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">spessore_usm</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">spessore_usm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 1 - Sito</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 2 - Area</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">us</span><span class="p">,</span>  <span class="c1"># 3 - US</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_strat</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="c1"># 4 - Definizione stratigrafica</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_intepret</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="c1"># 5 - Definizione intepretata</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_descrizione</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()),</span>  <span class="c1"># 6 - descrizione</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_interpretazione</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()),</span>  <span class="c1"># 7 - interpretazione</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 8 - periodo iniziale</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_iniz</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 9 - fase iniziale</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_fin</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="c1"># 10 - periodo finale iniziale</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_fin</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 11 - fase finale</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_scavato</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 12 - scavato</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_attivita</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 13 - attivita</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_anno</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 14 - anno scavo</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_metodo</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 15 - metodo</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_schedatura</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 16 - data schedatura</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_schedatore</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 17 - schedatore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_formazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 18 - formazione</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_conservazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 19 - conservazione</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 20 - colore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 21 - consistenza</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_struttura</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 22 - struttura</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">25</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_codice_periodo</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 23 - codice_periodo</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">26</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEditOrderLayer</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 24 - order layer</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">28</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 24 - order layer</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">29</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_settore</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 24 - order layer</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">30</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quadrato</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 30 quadrato</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">31</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ambiente</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 30 quadrato</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">32</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_saggio</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 30 quadrato</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">33</span><span class="p">]:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_elementi_datanti</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()),</span>  <span class="c1"># 6 - descrizione</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">34</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_funz_statica_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="c1"># 24 - order layer</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">35</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 30 quadrato</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">36</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_giunti_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 30 quadrato</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">37</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_letti_di_posa_giunti_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">38</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_h_modulo_c_corsi_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">39</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_edilizia_riassuntiva_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">40</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_reimpiego_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">41</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_in_opera_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">42</span><span class="p">]:</span> <span class="n">qmin_usm</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">43</span><span class="p">]:</span> <span class="n">qmax_usm</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">44</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_legante_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">50</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_generale</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="c1"># 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">51</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_interno</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="c1"># 52 nr catalogo interno</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">52</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_internazionale</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="c1"># 53 nr catalogo internazionale</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">53</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_soprintendenza</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="c1"># 54 nr soprintendenza</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">54</span><span class="p">]:</span>  <span class="n">quota_relativa</span><span class="p">,</span>  <span class="c1"># 55 quota relativa</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">55</span><span class="p">]:</span>  <span class="n">quota_abs</span><span class="p">,</span>  <span class="c1"># 56 quota abs</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">56</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ref_tm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 57 ref tm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">57</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_ref_ra</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 58 ref ra</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">58</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ref_n</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 59 ref n</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">59</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posizione</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 60 posizione</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">60</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_criteri_distinzione</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="c1"># 61 criteri distinzione</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">61</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modo_formazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
            <span class="c1"># 62 modo formazione</span>
            <span class="c1">#    self.TABLE_FIELDS[62]: &quot;&#39;&quot; + str(self.comboBox_componenti_organici.currentText()) + &quot;&#39;&quot;,</span>
            <span class="c1"># 63 componenti organici</span>
            <span class="c1">#    self.TABLE_FIELDS[63]: &quot;&#39;&quot; + str(self.comboBox_componenti_inorganici.currentText()) + &quot;&#39;&quot;,</span>
            <span class="c1"># 64 componenti inorganici</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">62</span><span class="p">]:</span><span class="n">lunghezza_max</span><span class="p">,</span>  <span class="c1"># 65</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">63</span><span class="p">]:</span><span class="n">altezza_max</span><span class="p">,</span>  <span class="c1"># 66</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">64</span><span class="p">]:</span><span class="n">altezza_min</span><span class="p">,</span>  <span class="c1"># 67</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">65</span><span class="p">]:</span><span class="n">profondita_max</span><span class="p">,</span>  <span class="c1"># 68</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">66</span><span class="p">]:</span><span class="n">profondita_min</span><span class="p">,</span>  <span class="c1"># 69</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">67</span><span class="p">]:</span><span class="n">larghezza_media</span><span class="p">,</span>  <span class="c1"># 70</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">68</span><span class="p">]:</span><span class="n">quota_max_abs</span><span class="p">,</span>  <span class="c1"># 71</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">69</span><span class="p">]:</span><span class="n">quota_max_rel</span><span class="p">,</span>  <span class="c1"># 72</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">70</span><span class="p">]:</span><span class="n">quota_min_abs</span><span class="p">,</span>  <span class="c1"># 73</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">71</span><span class="p">]:</span><span class="n">quota_min_rel</span><span class="p">,</span>  <span class="c1"># 74</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">72</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_osservazioni</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 75 osservazioni</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">73</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_datazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 76 datazione</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">74</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_flottazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 77 flottazione</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">75</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_setacciatura</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 78 setacciatura</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">76</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_affidabilita</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 79 affidabilita</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">77</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_direttore_us</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 80 direttore us</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">78</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_responsabile_us</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="c1"># 81 responsabile us</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">79</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_cod_ente_schedatore</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="c1"># 82 cod ente schedatore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">80</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_rilevazione</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 83 data rilevazione</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">81</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_rielaborazione</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="c1"># 84 data rielaborazione</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">82</span><span class="p">]:</span> <span class="n">lunghezza_usm</span><span class="p">,</span>  <span class="c1"># 85</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">83</span><span class="p">]:</span> <span class="n">altezza_usm</span><span class="p">,</span>  <span class="c1"># 86</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">84</span><span class="p">]:</span> <span class="n">spessore_usm</span><span class="p">,</span>  <span class="c1"># 87</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">85</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tecnica_muraria_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="c1"># 88 tecnica muraria usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">86</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modulo_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="c1"># 89 modulo usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">87</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_malta_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="c1"># 90 campioni malta usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">88</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_mattone_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="c1"># 91 campioni mattone usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">89</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_pietra_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="c1"># 92 campioni pietra usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">90</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_provenienza_materiali_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="c1"># 93 provenienza_materiali_usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">91</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_criteri_distinzione_usm</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="c1"># 94 criteri distinzione usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">92</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_uso_primario_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">93</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipologia_opera</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">94</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sezione_muraria</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="p">,</span> <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">95</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_superficie_analizzata</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="p">,</span> <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">96</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_orientamento</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="p">,</span> <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">97</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiali_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">98</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">99</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">100</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="p">,</span> <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">101</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">102</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_impasto_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">103</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="p">,</span> <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">104</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">105</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_taglio_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="p">,</span> <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">106</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_opera_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">107</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_inerti_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">108</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipo_legante_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">109</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_rifinitura_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">110</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiale_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 95 uso primario usm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">[</span><span class="mi">111</span><span class="p">]:</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="p">}</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">()</span>
            <span class="n">search_dict</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">remove_empty_items_fr_dict</span><span class="p">(</span><span class="n">search_dict</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Non √® stata impostata nessuna ricerca!!!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span> <span class="s2">&quot;Keine Abfrage definiert!!!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot; WARNING&quot;</span><span class="p">,</span> <span class="s2">&quot;No search has been set!!!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_bool</span><span class="p">(</span><span class="n">search_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ATTENZIONE&quot;</span><span class="p">,</span> <span class="s2">&quot;Non √® stato trovato nessun record!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ACHTUNG&quot;</span><span class="p">,</span> <span class="s2">&quot;Keinen Record gefunden!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span> <span class="s2">&quot;No record found!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_unita_tipo&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.lineEdit_us&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.textEdit_descrizione&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.textEdit_interpretazione&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setTableEnable</span><span class="p">(</span>
                        <span class="p">[</span><span class="s2">&quot;self.tableWidget_campioni&quot;</span><span class="p">,</span> <span class="s2">&quot;self.tableWidget_rapporti&quot;</span><span class="p">,</span> <span class="s2">&quot;self.tableWidget_inclusi&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_organici&quot;</span><span class="p">,</span> <span class="s2">&quot;self.tableWidget_inorganici&quot;</span><span class="p">,</span> <span class="s2">&quot;self.tableWidget_documentazione&quot;</span><span class="p">,</span><span class="s2">&quot;self.tableWidget_rapporti2&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="mi">0</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fill_fields</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_rec_counter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;E&#39; stato trovato&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="s2">&quot;record&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonGis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_vector_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_usm</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_usm_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Sono stati trovati&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="s2">&quot;records&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonGis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_vector_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_usm</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_usm_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Es wurde gefunden&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="s2">&quot;record&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonGis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_vector_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_usm</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_usm_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Sie wurden gefunden&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="s2">&quot;records&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonGis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_vector_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_usm</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_usm_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;It has been found&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="s2">&quot;record&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonGis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_vector_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_usm</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_usm_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;They have been found&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_TOT</span><span class="p">,</span> <span class="s2">&quot;records&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonGis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_vector_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButton_usm</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pyQGIS</span><span class="o">.</span><span class="n">charge_usm_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_sito&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_area&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.lineEdit_us&quot;</span><span class="p">],</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.comboBox_unita_tipo&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setTableEnable</span><span class="p">(</span>
                        <span class="p">[</span><span class="s2">&quot;self.tableWidget_campioni&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_rapporti&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_inclusi&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_organici&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_inorganici&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_documentazione&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_inclusi_materiali_usm&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_colore_legante_usm&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_inclusi_leganti_usm&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_consistenza_texture_mat_usm&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;self.tableWidget_colore_materiale_usm&quot;</span><span class="p">,</span><span class="s2">&quot;self.tableWidget_rapporti2&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.textEdit_descrizione&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setComboBoxEnable</span><span class="p">([</span><span class="s2">&quot;self.textEdit_interpretazione&quot;</span><span class="p">],</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">strings</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enable_button_search</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">update_if</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="n">rec_corr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span>
        <span class="k">if</span> <span class="n">msg</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">:</span>
            <span class="n">test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_record</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">test</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">id_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">:</span>
                    <span class="n">id_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;i.&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">SORT_STATUS</span> <span class="o">==</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span>
                    <span class="n">temp_data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_sort</span><span class="p">(</span><span class="n">id_list</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">],</span> <span class="s1">&#39;asc&#39;</span><span class="p">,</span>
                                                                <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">,</span>
                                                                <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">temp_data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_sort</span><span class="p">(</span><span class="n">id_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SORT_ITEMS_CONVERTED</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SORT_MODE</span><span class="p">,</span>
                                                                <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">temp_data_list</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STATUS_ITEMS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;&lt;type &#39;str&#39;&gt;&quot;</span><span class="p">:</span>
                    <span class="n">corr</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">corr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">REC_CORR</span>
                <span class="k">return</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">test</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
    <span class="k">def</span> <span class="nf">update_record</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">,</span>
                                   <span class="p">[</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;int(self.DATA_LIST[self.REC_CORR].&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">)],</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">rec_toupdate</span><span class="p">())</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">save_file</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HOME</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span><span class="s2">&quot;pyarchinit_Report_folder&quot;</span><span class="p">)</span>
            <span class="n">file_</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_file</span><span class="p">,</span><span class="s1">&#39;error_encodig_data_recover.txt&#39;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;it&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Messaggio&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Problema di encoding: sono stati inseriti accenti o caratteri non accettati dal database. Verr√† fatta una copia dell&#39;errore con i dati che puoi recuperare nella cartella pyarchinit_Report _Folder&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>


            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">==</span><span class="s1">&#39;de&#39;</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Encoding problem: accents or characters not accepted by the database were entered. A copy of the error will be made with the data you can retrieve in the pyarchinit_Report _Folder&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Kodierungsproblem: Es wurden Akzente oder Zeichen eingegeben, die von der Datenbank nicht akzeptiert werden. Es wird eine Kopie des Fehlers mit den Daten erstellt, die Sie im pyarchinit_Report _Ordner abrufen k√∂nnen&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>



            <span class="k">return</span> <span class="mi">0</span>
    <span class="k">def</span> <span class="nf">rec_toupdate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rec_to_update</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTILITY</span><span class="o">.</span><span class="n">pos_none_in_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rec_to_update</span>
        <span class="c1"># custom functions</span>
    <span class="k">def</span> <span class="nf">charge_records</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_SERVER</span> <span class="o">==</span> <span class="s1">&#39;sqlite&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">id_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">):</span>
                <span class="n">id_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;i.&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">))</span>
            <span class="n">temp_data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DB_MANAGER</span><span class="o">.</span><span class="n">query_sort</span><span class="p">(</span><span class="n">id_list</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">],</span> <span class="s1">&#39;asc&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAPPER_TABLE_CLASS</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">ID_TABLE</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">temp_data_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">datestrfdate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
        <span class="n">today</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">today</span>
    <span class="k">def</span> <span class="nf">yearstrfdate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">year</span>
    <span class="k">def</span> <span class="nf">table2dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tablename</span> <span class="o">=</span> <span class="n">n</span>
        <span class="n">row</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span> <span class="o">+</span> <span class="s2">&quot;.rowCount()&quot;</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span> <span class="o">+</span> <span class="s2">&quot;.columnCount()&quot;</span><span class="p">)</span>
        <span class="n">lista</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="n">sub_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tablename</span> <span class="o">+</span> <span class="s2">&quot;.item(r,c)&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">sub_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span>
            <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">sub_list</span><span class="p">):</span>
                <span class="n">lista</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lista</span>
<div class="viewcode-block" id="pyarchinit_US.tableInsertData"><a class="viewcode-back" href="../../06_moduli.html#tabs.US_USM.pyarchinit_US.tableInsertData">[documenti]</a>    <span class="k">def</span> <span class="nf">tableInsertData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value into alls Grid&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_name</span> <span class="o">=</span> <span class="n">t</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_list</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="c1"># column table count</span>
        <span class="n">table_col_count_cmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.columnCount()&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_name</span><span class="p">)</span>
        <span class="n">table_col_count</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">table_col_count_cmd</span><span class="p">)</span>
        <span class="c1"># clear table</span>
        <span class="n">table_clear_cmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.clearContents()&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_name</span><span class="p">)</span>
        <span class="nb">eval</span><span class="p">(</span><span class="n">table_clear_cmd</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">table_col_count</span><span class="p">):</span>
            <span class="n">table_rem_row_cmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.removeRow(int(</span><span class="si">{}</span><span class="s2">))&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_name</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="nb">eval</span><span class="p">(</span><span class="n">table_rem_row_cmd</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="p">)):</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.insertRow(int(</span><span class="si">{}</span><span class="s1">))&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_name</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
            <span class="nb">eval</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="p">[</span><span class="n">row</span><span class="p">])):</span>
                <span class="c1"># item = self.comboBox_sito.setEditText(self.data_list[0][col]</span>
                <span class="c1"># item = QTableWidgetItem(self.data_list[row][col])</span>

                <span class="n">exec_str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.setItem(int(</span><span class="si">{}</span><span class="s1">),int(</span><span class="si">{}</span><span class="s1">),QTableWidgetItem(self.data_list[row][col]))&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_name</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                <span class="nb">eval</span><span class="p">(</span><span class="n">exec_str</span><span class="p">)</span>
        <span class="n">max_row_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_name</span><span class="o">+</span><span class="s2">&quot;.item(max_row_num,1)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.removeRow(</span><span class="si">%d</span><span class="s2">)&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_name</span><span class="p">,</span> <span class="n">max_row_num</span><span class="p">)</span>
            <span class="nb">eval</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span></div>
<div class="viewcode-block" id="pyarchinit_US.insert_new_row"><a class="viewcode-back" href="../../06_moduli.html#tabs.US_USM.pyarchinit_US.insert_new_row">[documenti]</a>    <span class="k">def</span> <span class="nf">insert_new_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;insert new row into a table based on table_name&quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">table_name</span> <span class="o">+</span> <span class="s2">&quot;.insertRow(0)&quot;</span>
        <span class="nb">eval</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span></div>
<div class="viewcode-block" id="pyarchinit_US.remove_row"><a class="viewcode-back" href="../../06_moduli.html#tabs.US_USM.pyarchinit_US.remove_row">[documenti]</a>    <span class="k">def</span> <span class="nf">remove_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;insert new row into a table based on table_name&quot;&quot;&quot;</span>
        <span class="n">table_row_count_cmd</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.rowCount()&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
        <span class="n">table_row_count</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">table_row_count_cmd</span><span class="p">)</span>
        <span class="n">rowSelected_cmd</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.selectedIndexes()&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
        <span class="n">rowSelected</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">rowSelected_cmd</span><span class="p">)</span>
        <span class="n">rowIndex</span> <span class="o">=</span> <span class="p">(</span><span class="n">rowSelected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">row</span><span class="p">())</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.removeRow(</span><span class="si">%d</span><span class="s2">)&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">rowIndex</span><span class="p">)</span>
        <span class="nb">eval</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span></div>
    <span class="k">def</span> <span class="nf">empty_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rapporti_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">rapporti_row_count2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">campioni_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_campioni</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">inclusi_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">organici_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_organici</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">inorganici_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inorganici</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">documentazione_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_documentazione</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 1 - Sito</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 2 - Area</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 3 - US</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_strat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 4 - Definizione stratigrafica</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_intepret</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 5 - Definizione intepretata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textEdit_descrizione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 6 - descrizione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textEdit_interpretazione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 7 - interpretazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 8 - periodo iniziale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_iniz</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 9 - fase iniziale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_fin</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 10 - periodo finale iniziale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_fin</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 11 - fase finale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_scavato</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 12 - scavato</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_attivita</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 13 - attivita</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">==</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_anno</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yearstrfdate</span><span class="p">())</span>  <span class="c1"># 14 - anno scavo</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_anno</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_metodo</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 15 - metodo</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">inclusi_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi&quot;</span><span class="p">)</span>  <span class="c1"># 16 - inclusi</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">campioni_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_campioni</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_campioni&quot;</span><span class="p">)</span>  <span class="c1"># 17 - campioni</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">organici_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_organici</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_organici&quot;</span><span class="p">)</span>  <span class="c1"># organici</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">inorganici_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inorganici</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inorganici&quot;</span><span class="p">)</span>  <span class="c1"># inorganici</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rapporti_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_rapporti&quot;</span><span class="p">)</span>                <span class="c1">#18 - rapporti</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">documentazione_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_documentazione</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_documentazione&quot;</span><span class="p">)</span>  <span class="c1"># 19 - documentazione</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rapporti_row_count2</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_rapporti2&quot;</span><span class="p">)</span>

        <span class="n">colore_legante_usm_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_colore_legante_usm</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colore_legante_usm_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_colore_legante_usm</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_colore_legante_usm&quot;</span><span class="p">)</span>  <span class="c1"># 19 - aggregati</span>
        <span class="n">inclusi_leganti_usm_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi_leganti_usm</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">inclusi_leganti_usm_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi_leganti_usm</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi_leganti_usm&quot;</span><span class="p">)</span>  <span class="c1"># 19 - aggregati</span>
        <span class="n">cont_text_mat_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_consistenza_texture_mat_usm</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cont_text_mat_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_consistenza_texture_mat_usm</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_consistenza_texture_mat_usm&quot;</span><span class="p">)</span>  <span class="c1"># 19 - colore legante usm</span>
        <span class="n">aggreg_inclusi_materiale_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi_materiali_usm</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">aggreg_inclusi_materiale_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi_materiali_usm</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi_materiali_usm&quot;</span><span class="p">)</span>  <span class="c1"># 19 - aggregati</span>
        <span class="n">colore_materiali_usm_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_colore_materiale_usm</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colore_materiali_usm_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_colore_materiale_usm</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_colore_materiale_usm&quot;</span><span class="p">)</span>  <span class="c1"># 19 - aggregati</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">==</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_schedatura</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datestrfdate</span><span class="p">())</span>  <span class="c1"># 20 - data schedatura</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_schedatura</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 20 - data schedatura</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_schedatore</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 21 - schedatore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_formazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 22 - formazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_conservazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 23 - conservazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 24 - colore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 25 - consistenza</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_struttura</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 26 - struttura</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_codice_periodo</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 27 - codice periodo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEditOrderLayer</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 28 - order layer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 29 us_tipo            NUOVI CAMPI NUOVI CAMPI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_settore</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 30 settore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quadrato</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 31 quadrato</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ambiente</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 32 ambiente</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_saggio</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 33 saggio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textEdit_elementi_datanti</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 34 elementi datanti</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_funz_statica_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 35 funzione statica</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 36 lavorazione usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_giunti_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 37 spessore giunti</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_letti_di_posa_giunti_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 38 letti posa giunti usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_h_modulo_c_corsi_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 39 altezza modulo corsi usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_edilizia_riassuntiva_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 40 unita edilizia riassuntiva</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_reimpiego_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 41 unita edilizia riassuntiva</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_in_opera_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 42 posa in opera</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmin_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 3 - US</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmax_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 3 - US</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_legante_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 45 consitenza legante usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_generale</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_interno</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 52 nr catalogo interno</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_internazionale</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 53 nr catalogo internazionale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_soprintendenza</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 54 nr soprintendenza</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_relativa</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 55</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_abs</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 56</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ref_tm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 57 ref tm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_ref_ra</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>   <span class="c1"># 58 ref ra</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ref_n</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 59 ref n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posizione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 60 posizione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_criteri_distinzione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 61 criteri distinzione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modo_formazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 62 modo formazione</span>
        <span class="c1">#self.comboBox_componenti_organici.setEditText(&quot;&quot;)  # 63 componenti organici</span>
        <span class="c1">#self.comboBox_componenti_inorganici.setEditText(&quot;&quot;)  # 64 componenti inorganici</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_max</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 65</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_max</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 66</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_min</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 67</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_max</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 68</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_min</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 69</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_larghezza_media</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 70</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_abs</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 71</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_rel</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 72</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_abs</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 73</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_rel</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 74</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textEdit_osservazioni</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 75 osservazioni</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_datazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 76 datazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_flottazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 77 flottazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_setacciatura</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>   <span class="c1"># 78 setacciatura</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_affidabilita</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>   <span class="c1"># 79 affidabilita</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_direttore_us</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 80 direttore us</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_responsabile_us</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 81 responsabile us</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_cod_ente_schedatore</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 82 cod ente schedatore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_rilevazione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 83 data rilevazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_rielaborazione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 84 data rielaborazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 85</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 86</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 87</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tecnica_muraria_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 88 tecnica muraria usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modulo_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 89 modulo usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_malta_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 90 campioni malta usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_mattone_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 91 campioni mattone usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_pietra_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 92 campioni pietra usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_provenienza_materiali_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 93 provenienza_materiali_usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_criteri_distinzione_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 94 criteri distinzione usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_uso_primario_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipologia_opera</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sezione_muraria</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_superficie_analizzata</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_orientamento</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiali_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_impasto_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_taglio_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_opera_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_inerti_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipo_legante_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_rifinitura_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiale_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mQgsFileWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">empty_fields_nosite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rapporti_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">rapporti_row_count2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">campioni_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_campioni</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">inclusi_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">organici_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_organici</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">inorganici_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inorganici</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">documentazione_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_documentazione</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 2 - Area</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 3 - US</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_strat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 4 - Definizione stratigrafica</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_intepret</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 5 - Definizione intepretata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textEdit_descrizione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 6 - descrizione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textEdit_interpretazione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 7 - interpretazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 8 - periodo iniziale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_iniz</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 9 - fase iniziale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_fin</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 10 - periodo finale iniziale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_fin</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 11 - fase finale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_scavato</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 12 - scavato</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_attivita</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 13 - attivita</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">==</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_anno</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yearstrfdate</span><span class="p">())</span>  <span class="c1"># 14 - anno scavo</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_anno</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_metodo</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 15 - metodo</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">inclusi_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi&quot;</span><span class="p">)</span>  <span class="c1"># 16 - inclusi</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">campioni_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_campioni</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_campioni&quot;</span><span class="p">)</span>  <span class="c1"># 17 - campioni</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">organici_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_organici</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_organici&quot;</span><span class="p">)</span>  <span class="c1"># organici</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">inorganici_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inorganici</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inorganici&quot;</span><span class="p">)</span>  <span class="c1"># inorganici</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rapporti_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_rapporti&quot;</span><span class="p">)</span>                <span class="c1">#18 - rapporti</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">documentazione_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_documentazione</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rapporti_row_count2</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_rapporti2</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_rapporti2&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_documentazione&quot;</span><span class="p">)</span>  <span class="c1"># 19 - documentazione</span>
        <span class="n">colore_legante_usm_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_colore_legante_usm</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colore_legante_usm_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_colore_legante_usm</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_colore_legante_usm&quot;</span><span class="p">)</span>  <span class="c1"># 19 - aggregati</span>
        <span class="n">inclusi_leganti_usm_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi_leganti_usm</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">inclusi_leganti_usm_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi_leganti_usm</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi_leganti_usm&quot;</span><span class="p">)</span>  <span class="c1"># 19 - aggregati</span>
        <span class="n">cont_text_mat_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_consistenza_texture_mat_usm</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cont_text_mat_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_consistenza_texture_mat_usm</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_consistenza_texture_mat_usm&quot;</span><span class="p">)</span>  <span class="c1"># 19 - colore legante usm</span>
        <span class="n">aggreg_inclusi_materiale_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi_materiali_usm</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">aggreg_inclusi_materiale_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_inclusi_materiali_usm</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi_materiali_usm&quot;</span><span class="p">)</span>  <span class="c1"># 19 - aggregati</span>
        <span class="n">colore_materiali_usm_row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_colore_materiale_usm</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colore_materiali_usm_row_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget_colore_materiale_usm</span><span class="o">.</span><span class="n">removeRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_new_row</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_colore_materiale_usm&quot;</span><span class="p">)</span>  <span class="c1"># 19 - aggregati</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BROWSE_STATUS</span> <span class="o">==</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_schedatura</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datestrfdate</span><span class="p">())</span>  <span class="c1"># 20 - data schedatura</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_schedatura</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 20 - data schedatura</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_schedatore</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 21 - schedatore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_formazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 22 - formazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_conservazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 23 - conservazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 24 - colore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 25 - consistenza</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_struttura</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 26 - struttura</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_codice_periodo</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 27 - codice periodo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEditOrderLayer</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 28 - order layer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 29 us_tipo            NUOVI CAMPI NUOVI CAMPI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_settore</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 30 settore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quadrato</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 31 quadrato</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ambiente</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 32 ambiente</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_saggio</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 33 saggio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textEdit_elementi_datanti</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 34 elementi datanti</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_funz_statica_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 35 funzione statica</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 36 lavorazione usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_giunti_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 37 spessore giunti</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_letti_di_posa_giunti_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 38 letti posa giunti usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_h_modulo_c_corsi_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 39 altezza modulo corsi usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_edilizia_riassuntiva_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 40 unita edilizia riassuntiva</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_reimpiego_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 41 unita edilizia riassuntiva</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_in_opera_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 42 posa in opera</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmin_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 3 - US</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmax_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 3 - US</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_legante_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 45 consitenza legante usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_generale</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_interno</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 52 nr catalogo interno</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_internazionale</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 53 nr catalogo internazionale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_soprintendenza</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 54 nr soprintendenza</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_relativa</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 55</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_abs</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 56</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ref_tm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 57 ref tm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_ref_ra</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>   <span class="c1"># 58 ref ra</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ref_n</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 59 ref n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posizione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 60 posizione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_criteri_distinzione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 61 criteri distinzione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modo_formazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 62 modo formazione</span>
        <span class="c1">#self.comboBox_componenti_organici.setEditText(&quot;&quot;)  # 63 componenti organici</span>
        <span class="c1">#self.comboBox_componenti_inorganici.setEditText(&quot;&quot;)  # 64 componenti inorganici</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_max</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 65</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_max</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 66</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_min</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 67</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_max</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 68</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_min</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 69</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_larghezza_media</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 70</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_abs</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 71</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_rel</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 72</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_abs</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 73</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_rel</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 74</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textEdit_osservazioni</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 75 osservazioni</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_datazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 76 datazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_flottazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>   <span class="c1"># 77 flottazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_setacciatura</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 78 setacciatura</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_affidabilita</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 79 affidabilita</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_direttore_us</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 80 direttore us</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_responsabile_us</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 81 responsabile us</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_cod_ente_schedatore</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 82 cod ente schedatore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_rilevazione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 83 data rilevazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_rielaborazione</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 84 data rielaborazione</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 85</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 86</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 87</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tecnica_muraria_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 88 tecnica muraria usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modulo_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 89 modulo usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_malta_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 90 campioni malta usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_mattone_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 91 campioni mattone usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_pietra_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 92 campioni pietra usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_provenienza_materiali_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 93 provenienza_materiali_usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_criteri_distinzione_usm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 94 criteri distinzione usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_uso_primario_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipologia_opera</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sezione_muraria</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_superficie_analizzata</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_orientamento</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiali_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_impasto_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_taglio_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_opera_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_inerti_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipo_legante_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_rifinitura_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiale_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># 95 uso primario usm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mQgsFileWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">fill_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span> <span class="o">=</span> <span class="n">n</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">sito</span><span class="p">))</span>  <span class="c1"># 1 - Sito</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">))</span>  <span class="c1"># 2 - Area</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">us</span><span class="p">))</span>  <span class="c1"># 3 - US</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_strat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">d_stratigrafica</span><span class="p">))</span>  <span class="c1"># 4 - Definizione stratigrafica</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_intepret</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">d_interpretativa</span><span class="p">))</span>  <span class="c1"># 5 - Definizione intepretata</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_descrizione</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">descrizione</span><span class="p">))</span>  <span class="c1"># 6 - descrizione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_interpretazione</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">interpretazione</span><span class="p">))</span>  <span class="c1"># 7 - interpretazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">periodo_iniziale</span><span class="p">))</span>  <span class="c1"># 8 - periodo iniziale</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_iniz</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">fase_iniziale</span><span class="p">))</span>  <span class="c1"># 9 - fase iniziale</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_fin</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">periodo_finale</span><span class="p">))</span>  <span class="c1"># 10 - periodo finale iniziale</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_fin</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">fase_finale</span><span class="p">))</span>  <span class="c1"># 11 - fase finale</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_scavato</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">scavato</span><span class="p">))</span>  <span class="c1"># 12 - scavato</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_attivita</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">attivita</span><span class="p">))</span>  <span class="c1"># 13 - attivita</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_anno</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">anno_scavo</span><span class="p">))</span>  <span class="c1"># 14 - anno scavo</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_metodo</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">metodo_di_scavo</span><span class="p">))</span>  <span class="c1"># 15 - metodo</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableInsertData</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">inclusi</span><span class="p">)</span>  <span class="c1"># 16 - inclusi</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableInsertData</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_campioni&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">campioni</span><span class="p">)</span>  <span class="c1"># 17 - campioni</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableInsertData</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_organici&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">componenti_organici</span><span class="p">)</span>  <span class="c1"># organici</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableInsertData</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inorganici&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">componenti_inorganici</span><span class="p">)</span>  <span class="c1"># inorganici</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableInsertData</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_rapporti&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">rapporti</span><span class="p">)</span>  <span class="c1"># 18 - rapporti</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_schedatura</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">data_schedatura</span><span class="p">))</span>  <span class="c1"># 19 - data schedatura</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_schedatore</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">schedatore</span><span class="p">))</span>  <span class="c1"># 20 - schedatore</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_formazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">formazione</span><span class="p">))</span>  <span class="c1"># 21 - formazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_conservazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">stato_di_conservazione</span><span class="p">))</span>  <span class="c1"># 22 - conservazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">colore</span><span class="p">))</span>  <span class="c1"># 23 - colore</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">consistenza</span><span class="p">))</span>  <span class="c1"># 24 - consistenza</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_struttura</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">struttura</span><span class="p">))</span> <span class="c1"># 25 - struttura</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">cont_per</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_codice_periodo</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_codice_periodo</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">cont_per</span><span class="p">))</span>  <span class="c1"># 26 - codice periodo</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">order_layer</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEditOrderLayer</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEditOrderLayer</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">order_layer</span><span class="p">))</span>  <span class="c1"># 27 - order layer</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableInsertData</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_documentazione&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">documentazione</span><span class="p">)</span>  <span class="c1"># 28 - documentazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">unita_tipo</span><span class="p">))</span>  <span class="c1"># 29 unita tipo</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_settore</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">settore</span><span class="p">))</span>  <span class="c1"># 30 - settore</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quadrato</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quad_par</span><span class="p">))</span>  <span class="c1"># 31 quadrato</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ambiente</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">ambient</span><span class="p">))</span>  <span class="c1"># 32 ambiente</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_saggio</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">saggio</span><span class="p">))</span>  <span class="c1"># 33 saggio</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_elementi_datanti</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">elem_datanti</span><span class="p">))</span>  <span class="c1"># 34 - elemtenti_datanti</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_funz_statica_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">funz_statica</span><span class="p">))</span>  <span class="c1"># 35 - funz statica</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">lavorazione</span><span class="p">))</span>  <span class="c1"># 36 lavorazione usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_giunti_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">spess_giunti</span><span class="p">))</span>  <span class="c1"># 37 spessore giunti usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_letti_di_posa_giunti_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">letti_posa</span><span class="p">))</span> <span class="c1">#38 letti_posa</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_h_modulo_c_corsi_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">alt_mod</span><span class="p">))</span> <span class="c1">#39 altezza modulo corsi</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_edilizia_riassuntiva_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">un_ed_riass</span><span class="p">))</span> <span class="c1">#40 unita edilizia riassuntiva</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_reimpiego_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">reimp</span><span class="p">))</span>  <span class="c1">#41 reimpiego</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_in_opera_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">posa_opera</span><span class="p">))</span> <span class="c1">#42 posa opera</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_min_usm</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmin_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmin_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_min_usm</span><span class="p">))</span>  <span class="c1"># 43 - qmin usm</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_max_usm</span><span class="p">:</span>
               <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmax_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmax_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_max_usm</span><span class="p">))</span>  <span class="c1"># 44 - qmax usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_legante_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">cons_legante</span><span class="p">))</span>  <span class="c1"># 45 - cons legante</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableInsertData</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_colore_legante_usm&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">col_legante</span><span class="p">)</span> <span class="c1">## 46 - col legante usm</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableInsertData</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi_leganti_usm&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">aggreg_legante</span><span class="p">)</span> <span class="c1"># 47 aggregati legante usm</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableInsertData</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_consistenza_texture_mat_usm&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">con_text_mat</span><span class="p">)</span> <span class="c1"># 48 - con text mat</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableInsertData</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_colore_materiale_usm&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">col_materiale</span><span class="p">)</span> <span class="c1"># 49 - col mat</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableInsertData</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi_materiali_usm&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">inclusi_materiali_usm</span><span class="p">)</span>  <span class="c1"># 50  inclusi materiali usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_generale</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">n_catalogo_generale</span><span class="p">))</span>  <span class="c1"># 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_interno</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">n_catalogo_interno</span><span class="p">))</span>  <span class="c1"># 52 nr catalogo interno</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_internazionale</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">n_catalogo_internazionale</span><span class="p">))</span>  <span class="c1"># 53 nr catalogo internazionale</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_soprintendenza</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">soprintendenza</span><span class="p">))</span>  <span class="c1"># 54 nr soprintendenza</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_relativa</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_relativa</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>                   <span class="c1"># 55</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_relativa</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_relativa</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_abs</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_abs</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>                   <span class="c1"># 56</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_abs</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_abs</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ref_tm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">ref_tm</span><span class="p">))</span>  <span class="c1"># 57 ref tm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_ref_ra</span><span class="o">.</span><span class="n">setDefaultText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">ref_ra</span><span class="p">))</span>  <span class="c1"># 58 ref ra</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ref_n</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">ref_n</span><span class="p">))</span>  <span class="c1"># 59 ref n</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posizione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">posizione</span><span class="p">))</span>  <span class="c1"># 60 posizione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_criteri_distinzione</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">criteri_distinzione</span><span class="p">))</span>  <span class="c1"># 61 criteri distinzione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modo_formazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">modo_formazione</span><span class="p">))</span>  <span class="c1"># 62 modo formazione</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">lunghezza_max</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_max</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_max</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">lunghezza_max</span><span class="p">))</span>  <span class="c1"># 65 lunghezza max</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">altezza_max</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_max</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_max</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">altezza_max</span><span class="p">))</span>  <span class="c1"># 66 altezza max</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">altezza_min</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_min</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_min</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">altezza_min</span><span class="p">))</span>  <span class="c1"># 67 altezza min</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">profondita_max</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_max</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_max</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">profondita_max</span><span class="p">))</span>  <span class="c1"># 68 profondita_max</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">profondita_min</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_min</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_min</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">profondita_min</span><span class="p">))</span>  <span class="c1"># 69 profondita min</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">larghezza_media</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_larghezza_media</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_larghezza_media</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">larghezza_media</span><span class="p">))</span>  <span class="c1"># 70 larghezza media</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_max_abs</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_abs</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_abs</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_max_abs</span><span class="p">))</span>  <span class="c1"># 71 quota_max_abs</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_max_rel</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_rel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_rel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_max_rel</span><span class="p">))</span>  <span class="c1"># 72 quota_max_rel</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_min_abs</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_abs</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_abs</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_min_abs</span><span class="p">))</span>  <span class="c1"># 73 quota_min_abs</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_min_rel</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_rel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_rel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">quota_min_rel</span><span class="p">))</span>  <span class="c1"># 74 quota_min_rel</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_osservazioni</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">osservazioni</span><span class="p">))</span>  <span class="c1"># 75 osservazioni</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_datazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">datazione</span><span class="p">))</span>  <span class="c1"># 76 datazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_flottazione</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">flottazione</span><span class="p">))</span>  <span class="c1"># 77 flottazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_setacciatura</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">setacciatura</span><span class="p">))</span>  <span class="c1"># 78 setacciatura</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_affidabilita</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">affidabilita</span><span class="p">))</span>        <span class="c1"># 79 affidabilita</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_direttore_us</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">direttore_us</span><span class="p">))</span>  <span class="c1"># 80 direttore us</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_responsabile_us</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">responsabile_us</span><span class="p">))</span>  <span class="c1"># 81 responsabile us</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_cod_ente_schedatore</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">cod_ente_schedatore</span><span class="p">))</span>  <span class="c1"># 82 cod ente schedatore</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_rilevazione</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">data_rilevazione</span><span class="p">))</span>  <span class="c1"># 83 data rilevazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_rielaborazione</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">data_rielaborazione</span><span class="p">))</span>  <span class="c1"># 84 data rielaborazione</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">lunghezza_usm</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">lunghezza_usm</span><span class="p">))</span>  <span class="c1"># 85 lunghezza usm</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">altezza_usm</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">altezza_usm</span><span class="p">))</span>  <span class="c1"># 86 altezza usm</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">spessore_usm</span><span class="p">:</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">spessore_usm</span><span class="p">))</span>  <span class="c1"># 87 spessore usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tecnica_muraria_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">tecnica_muraria_usm</span><span class="p">))</span>  <span class="c1"># 88 tecnica muraria usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modulo_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">modulo_usm</span><span class="p">))</span>  <span class="c1"># 89 modulo usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_malta_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">campioni_malta_usm</span><span class="p">))</span>  <span class="c1"># 90 campioni malta usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_mattone_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">campioni_mattone_usm</span><span class="p">))</span>  <span class="c1"># 91 campioni mattone usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_pietra_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">campioni_pietra_usm</span><span class="p">))</span>  <span class="c1"># 92 campioni pietra usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_provenienza_materiali_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">provenienza_materiali_usm</span><span class="p">))</span>  <span class="c1"># 93 provenienza_materiali_usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_criteri_distinzione_usm</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">criteri_distinzione_usm</span><span class="p">))</span>  <span class="c1"># 94 criteri distinzione usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_uso_primario_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">uso_primario_usm</span><span class="p">))</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipologia_opera</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">tipologia_opera</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sezione_muraria</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">sezione_muraria</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_superficie_analizzata</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">superficie_analizzata</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_orientamento</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">orientamento</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiali_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">materiali_lat</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">lavorazione_lat</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">consistenza_lat</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">forma_lat</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">colore_lat</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_impasto_lat</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">impasto_lat</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">forma_p</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">colore_p</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_taglio_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">taglio_p</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_opera_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">posa_opera_p</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_inerti_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">inerti_usm</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipo_legante_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">tipo_legante_usm</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_rifinitura_usm</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">rifinitura_usm</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiale_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">materiale_p</span><span class="p">))</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_p</span><span class="o">.</span><span class="n">setEditText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">consistenza_p</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableInsertData</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_rapporti2&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">rapporti2</span><span class="p">)</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mQgsFileWidget</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_num</span><span class="p">]</span><span class="o">.</span><span class="n">doc_usv</span><span class="p">))</span> <span class="c1"># 18 - rapporti</span>
            <span class="c1"># gestione tool</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonPreview</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadMapPreview</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolButtonPreviewMedia</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadMediaPreview</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">set_rec_counter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rec_tot</span> <span class="o">=</span> <span class="n">t</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rec_corr</span> <span class="o">=</span> <span class="n">c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_rec_tot</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_tot</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_rec_corrente</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_corr</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">set_LIST_REC_TEMP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># QMessageBox.warning(self, &quot;Errore&quot;, str(self.comboBox_per_fin.currentText()),  QMessageBox.Ok)</span>
        <span class="c1"># TableWidget</span>
        <span class="c1">##Rapporti</span>
        <span class="n">rapporti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_rapporti&quot;</span><span class="p">)</span>
        <span class="n">rapporti2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_rapporti2&quot;</span><span class="p">)</span>
        <span class="c1">##Inclusi</span>
        <span class="n">inclusi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi&quot;</span><span class="p">)</span>
        <span class="c1">##Campioni</span>
        <span class="n">campioni</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_campioni&quot;</span><span class="p">)</span>
        <span class="c1">##Organici</span>
        <span class="n">organici</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_organici&quot;</span><span class="p">)</span>
        <span class="c1">##Inorganici</span>
        <span class="n">inorganici</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inorganici&quot;</span><span class="p">)</span>
        <span class="c1">##Documentazione</span>
        <span class="n">documentazione</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_documentazione&quot;</span><span class="p">)</span>
        <span class="c1">##Inclusi materiali aggregati</span>
        <span class="n">inclusi_mat_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi_materiali_usm&quot;</span><span class="p">)</span>
        <span class="c1">##Inclusi leganti usm</span>
        <span class="n">inclusi_leganti_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_inclusi_leganti_usm&quot;</span><span class="p">)</span>
        <span class="n">colore_legante_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_colore_legante_usm&quot;</span><span class="p">)</span>
        <span class="n">con_text_materiale_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_consistenza_texture_mat_usm&quot;</span><span class="p">)</span>
        <span class="n">col_materiale_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table2dict</span><span class="p">(</span><span class="s2">&quot;self.tableWidget_colore_materiale_usm&quot;</span><span class="p">)</span>
        <span class="c1">#list_foto = self.table2dict(&quot;self.tableWidget_foto&quot;)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEditOrderLayer</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">order_layer</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">order_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEditOrderLayer</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmin_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">qmin_usm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">qmin_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmin_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmax_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">qmax_usm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">qmax_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_qmax_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##quota relativa</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_relativa</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">quota_relativa</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quota_relativa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_relativa</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##quota abs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">quota_abs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quota_abs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="c1">##lunghezza max</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">lunghezza_max</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lunghezza_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##altezza max</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">altezza_max</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">altezza_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##altezza min</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_min</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">altezza_min</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">altezza_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_min</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##profondita max</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">profondita_max</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">profondita_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_max</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##profondita min</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_min</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">profondita_min</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">profondita_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_profondita_min</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##larghezza media</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_larghezza_media</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">larghezza_media</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">larghezza_media</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_larghezza_media</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##quota max abs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">quota_max_abs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quota_max_abs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##quota max relativa</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_rel</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">quota_max_rel</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quota_max_rel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_max_rel</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##quota min abs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">quota_min_abs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quota_min_abs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_abs</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##quota min relativa</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_rel</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">quota_min_rel</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quota_min_rel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quota_min_rel</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##lunghezza usm</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">lunghezza_usm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lunghezza_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_lunghezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##altezza usm</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">altezza_usm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">altezza_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_altezza_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="c1">##spessore usm</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">spessore_usm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">spessore_usm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="c1"># data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sito</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 1 - Sito</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_area</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 2 - Area</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_us</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 3 - US</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_strat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 4 - Definizione stratigrafica</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_def_intepret</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 5 - Definizione intepretata</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_descrizione</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()),</span>  <span class="c1"># 6 - descrizione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_interpretazione</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()),</span>  <span class="c1"># 7 - interpretazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_iniz</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 8 - periodo iniziale</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_iniz</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 9 - fase iniziale</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_per_fin</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 10 - periodo finale iniziale</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_fas_fin</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 11 - fase finale</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_scavato</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 12 - scavato</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_attivita</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 13 - attivita</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_anno</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 14 - anno scavo</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_metodo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 15 - metodo</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">inclusi</span><span class="p">),</span>  <span class="c1"># 16 - inclusi</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">campioni</span><span class="p">),</span>  <span class="c1"># 17 - campioni</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">rapporti</span><span class="p">),</span>  <span class="c1"># 18 - rapporti</span>
            <span class="c1">#str(organici),</span>
            <span class="c1">#str(inorganici),</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_schedatura</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 19 - data schedatura</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_schedatore</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 20 - schedatore</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_formazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 21 - formazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_conservazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 22 - conservazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 23 - colore</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 24 - consistenza</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_struttura</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 25 - struttura</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_codice_periodo</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 26 - codice periodo</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">order_layer</span><span class="p">),</span>  <span class="c1"># 27 - order layer era str(order_layer)</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">documentazione</span><span class="p">),</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_tipo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 29 us_tipo            NUOVI CAMPI NUOVI CAMPI</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_settore</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 30 settore</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_quadrato</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 31 quadrato</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ambiente</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 32 ambiente</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_saggio</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 33 saggio</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_elementi_datanti</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()),</span>  <span class="c1"># 34 elementi datanti</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_funz_statica_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 35 funzione statica</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 36 lavorazione usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_spessore_giunti_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 37 spessore giunti</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_letti_di_posa_giunti_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 38 letti posa giunti usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_h_modulo_c_corsi_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 39 altezza modulo corsi usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_unita_edilizia_riassuntiva_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 40 unita edilizia riassuntiva</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_reimpiego_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 41 unita edilizia riassuntiva</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_in_opera_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 42 posa in opera</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">qmin_usm</span><span class="p">),</span>  <span class="c1"># 43 quota minima</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">qmax_usm</span><span class="p">),</span>  <span class="c1"># 44 quota massima</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_legante_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 45 consitenza legante usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">colore_legante_usm</span><span class="p">),</span>  <span class="c1"># 46 colore legante usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">inclusi_leganti_usm</span><span class="p">),</span>  <span class="c1"># 47 aggregati leganti usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">con_text_materiale_usm</span><span class="p">),</span>  <span class="c1"># 48 consistenza text mat</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">col_materiale_usm</span><span class="p">),</span>  <span class="c1"># 49 colore materiale usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">inclusi_mat_usm</span><span class="p">),</span> <span class="c1"># 50 inclusi_mat_usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_generale</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 51 nr catalogo generale campi aggiunti per archeo 3.0 e allineamento ICCD</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_interno</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 52 nr catalogo interno</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_n_catalogo_internazionale</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 53 nr catalogo internazionale</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_soprintendenza</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span> <span class="c1"># 54 nr soprintendenza</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">quota_relativa</span><span class="p">),</span>  <span class="c1"># 55 quota relativa</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">quota_abs</span><span class="p">),</span>  <span class="c1"># 56 quota abs</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ref_tm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 57 ref tm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_ref_ra</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 58 ref ra</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_ref_n</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 59 ref n</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posizione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 60 posizione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_criteri_distinzione</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 61 criteri distinzione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modo_formazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span> <span class="c1"># 62 modo formazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">organici</span><span class="p">),</span> <span class="c1"># 63 componenti organici</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">inorganici</span><span class="p">),</span> <span class="c1"># 64 componenti inorganici</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">lunghezza_max</span><span class="p">),</span>  <span class="c1"># 65</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">altezza_max</span><span class="p">),</span>  <span class="c1"># 66</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">altezza_min</span><span class="p">),</span>  <span class="c1"># 67</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">profondita_max</span><span class="p">),</span>  <span class="c1"># 68</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">profondita_min</span><span class="p">),</span>  <span class="c1"># 69</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">larghezza_media</span><span class="p">),</span>  <span class="c1"># 70</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">quota_max_abs</span><span class="p">),</span>  <span class="c1"># 71</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">quota_max_rel</span><span class="p">),</span>  <span class="c1"># 72</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">quota_min_abs</span><span class="p">),</span>  <span class="c1"># 73</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">quota_min_rel</span><span class="p">),</span>  <span class="c1"># 74</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textEdit_osservazioni</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()),</span>  <span class="c1"># 75 osservazioni</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_datazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 76 datazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_flottazione</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 77 flottazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_setacciatura</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 78 setacciatura</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_affidabilita</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 79 affidabilita</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_direttore_us</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 80 direttore us</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_responsabile_us</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span> <span class="c1"># 81 responsabile us</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_cod_ente_schedatore</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 82 cod ente schedatore</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_rilevazione</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>  <span class="c1"># 83 data rilevazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_data_rielaborazione</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 84 data rielaborazione</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">lunghezza_usm</span><span class="p">),</span>  <span class="c1"># 85</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">altezza_usm</span><span class="p">),</span>  <span class="c1"># 86</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">spessore_usm</span><span class="p">),</span>  <span class="c1"># 87</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tecnica_muraria_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span> <span class="c1"># 88 tecnica muraria usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_modulo_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 89 modulo usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_malta_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 90 campioni malta usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_mattone_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 91 campioni mattone usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_campioni_pietra_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 92 campioni pietra usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_provenienza_materiali_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 93 provenienza_materiali_usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_criteri_distinzione_usm</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="c1"># 94 criteri distinzione usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_uso_primario_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipologia_opera</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_sezione_muraria</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_superficie_analizzata</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_orientamento</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiali_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_lavorazione_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_impasto_lat</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_forma_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_colore_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_taglio_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_posa_opera_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="c1">#str(list_foto)</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_inerti_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_tipo_legante_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_rifinitura_usm</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_materiale_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_consistenza_p</span><span class="o">.</span><span class="n">currentText</span><span class="p">()),</span>  <span class="c1"># 95 uso primario usm</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">rapporti2</span><span class="p">),</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mQgsFileWidget</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span><span class="c1"># 18 - rapporti</span>
        <span class="p">]</span>
    <span class="k">def</span> <span class="nf">set_LIST_REC_CORR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">TABLE_FIELDS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;unicode(self.DATA_LIST[self.REC_CORR].&quot;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">records_equal_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.set_sito()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_LIST_REC_TEMP</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_LIST_REC_CORR</span><span class="p">()</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        area TEST</span>
<span class="sd">        tes = str(self.DATA_LIST_REC_CORR) + str(self.DATA_LIST_REC_TEMP)</span>
<span class="sd">        self.testing(&quot;C:\\Users\\Luca\\pyarchinit_Test_folder\\tes_equal.txt&quot;, tes)</span>
<span class="sd">        #QMessageBox.warning(self, &quot;Errore&quot;, str(self.DATA_LIST_REC_CORR) + str(self.DATA_LIST_REC_TEMP),  QMessageBox.Ok)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_CORR</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">DATA_LIST_REC_TEMP</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">setComboBoxEditable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">field_names</span> <span class="o">=</span> <span class="n">f</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">n</span>
        <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">field_names</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s1">&#39;.setEditable(&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
            <span class="nb">eval</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setComboBoxEnable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">field_names</span> <span class="o">=</span> <span class="n">f</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">field_names</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s1">&#39;.setEnabled(&#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
            <span class="nb">eval</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">setTableEnable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">tab_names</span> <span class="o">=</span> <span class="n">t</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">for</span> <span class="n">tn</span> <span class="ow">in</span> <span class="n">tab_names</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tn</span><span class="p">,</span> <span class="s1">&#39;.setEnabled(&#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
            <span class="nb">eval</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">testing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_file</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name_file</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">on_pushButton_open_dir_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">HOME</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYARCHINIT_HOME&#39;</span><span class="p">]</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">HOME</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;pyarchinit_PDF_folder&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;xdg-open&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">on_pushButton_open_dir_matrix_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">HOME</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYARCHINIT_HOME&#39;</span><span class="p">]</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">HOME</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;pyarchinit_Matrix_folder&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;xdg-open&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">on_pushButton_open_dir_tavole_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">HOME</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYARCHINIT_HOME&#39;</span><span class="p">]</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">HOME</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;pyarchinit_MAPS_folder&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;xdg-open&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">])</span>         </div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, AdArte srl.</p>
  </div>

  Realizzato con <a href="https://www.sphinx-doc.org/">Sphinx</a> e il tema
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    fornito da <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>